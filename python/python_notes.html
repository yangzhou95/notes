<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-02-01 Tue 10:50 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>&lrm;</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="zhou yang" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgc70cb69">1. numpy learning</a>
<ul>
<li><a href="#org6d58c1a">1.1. axis=i</a>
<ul>
<li><a href="#org519bf32">1.1.1. apply operations on each elements of i-th index (element in the (i+1)-th square bracket) of the shape</a></li>
<li><a href="#org0e5cc25">1.1.2. example: 2d:</a></li>
<li><a href="#orge015ebf">1.1.3. axis=0, vertical, axis = 1, horizontally, axis=3, can be viewed as operate horizontally on the element of a[0,&#x2026;]</a></li>
</ul>
</li>
<li><a href="#orgecbfcec">1.2. basics</a>
<ul>
<li><a href="#orge062b2e">1.2.1. ndarray: with an alias array, and axis means dim</a></li>
<li><a href="#org8fcb419">1.2.2. Attributes</a></li>
<li><a href="#org8849bdd">1.2.3. example</a></li>
<li><a href="#org666faf0">1.2.4. method</a></li>
<li><a href="#orgecca27e">1.2.5. how to create ndarray</a></li>
<li><a href="#org63c931f">1.2.6. create bool array</a></li>
<li><a href="#org121dfcb">1.2.7. print the whole array</a></li>
</ul>
</li>
<li><a href="#orgbf32f33">1.3. index</a>
<ul>
<li><a href="#org1e36129">1.3.1. index of an array can be any list, array or tuple</a></li>
</ul>
</li>
<li><a href="#org76cae52">1.4. basic operations</a>
<ul>
<li><a href="#orgf60cea5">1.4.1. the math operations on an array will be applied on each element</a></li>
<li><a href="#org4b09a62">1.4.2. '\*': element-wised multiplication</a></li>
<li><a href="#org215c10c">1.4.3. matrix multiplication: @ or 'dot' function (python&gt;=3.5) A*B, A.dot(B)</a></li>
<li><a href="#org9348c6b">1.4.4. some operations can modify array in place: such as '+=', `*=`</a></li>
<li><a href="#org09478c9">1.4.5. unary-operation: one element</a></li>
<li><a href="#org73d1af2">1.4.6. ufunc: universal function</a></li>
<li><a href="#org3009652">1.4.7. slicing</a></li>
<li><a href="#org4ffd0fd">1.4.8. operation on the shape</a></li>
<li><a href="#org0d28f26">1.4.9. array stacking and concatenating</a></li>
<li><a href="#org466b0e6">1.4.10. np.r_ and np.c_</a></li>
<li><a href="#org176bdef">1.4.11. splitting an array</a></li>
<li><a href="#orgecaaa6e">1.4.12. copy and view</a></li>
</ul>
</li>
<li><a href="#orge8cf263">1.5. Method</a>
<ul>
<li><a href="#orgfd223c2">1.5.1. frequently used method</a></li>
<li><a href="#orgf619c12">1.5.2. broadcasting</a></li>
</ul>
</li>
<li><a href="#org199d33e">1.6. more slicingnp.vstack()np.hstack()</a></li>
<li><a href="#org06f9b17">1.7. bool slicing</a>
<ul>
<li><a href="#org2ebaff5">1.7.1. I.use a bool array that has the same shape with the original array</a></li>
<li><a href="#orgb62a219">1.7.2. Slicing on the first dim</a></li>
<li><a href="#org9c133d1">1.7.3. For each dim, we can have a boolean filter, but the length of the filter must match the length of the targeted dim</a></li>
</ul>
</li>
<li><a href="#org4d19642">1.8. ix<sub>()</sub> function</a>
<ul>
<li><a href="#org6ea2bfa">1.8.1. ix<sub>()</sub> can be used to combine different vectors in a way to generate n-tuple</a></li>
</ul>
</li>
<li><a href="#org07b2155">1.9. reshape</a>
<ul>
<li><a href="#orgeef0216">1.9.1. np.vstack(): stack two 1d array to have a 2d array</a></li>
<li><a href="#orgb04067e">1.9.2. np.hstack()</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org61ed82e">2. Numpy sort</a>
<ul>
<li><a href="#org1fd0d29">2.1. numpy.sort(a, axis, kind, order)</a>
<ul>
<li><a href="#orge0e4cf0">2.1.1. kind: {'quicksort', 'mergesort', 'heapsort', 'stable'}</a></li>
</ul>
</li>
<li><a href="#org014dc82">2.2. np.argsort(): return the index in the original array with ascending order</a></li>
<li><a href="#orgb8def3b">2.3. numpy.lexsort(): sort by multiple keys</a></li>
<li><a href="#org70fc691">2.4. </a></li>
<li><a href="#org837b831">2.5. arr.sort(axis):Sort an array in-place</a></li>
<li><a href="#orgccccfdd">2.6. a[::-1]: reverse a</a></li>
<li><a href="#org3cf8423">2.7. adding/removing</a>
<ul>
<li><a href="#org67c56f2">2.7.1. np.append(arr,values): Append values to the end of an array. A copy of `arr` with `values` appended to `axis`</a></li>
<li><a href="#org004dfc2">2.7.2. np.insert(arr, position, value)</a></li>
<li><a href="#org7d8b66a">2.7.3. np.delete(arr, obj):Return a new array with sub-arrays along an axis deleted. For a one dimensional array, this returns those entries not returned by `arr[obj]`.</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orge5c9577">3. API</a>
<ul>
<li><a href="#orga396980">3.1. numpy.array(object, dtype = None, copy = True, order = None, subok = False, ndmin = 0)</a>
<ul>
<li><a href="#org4b66c86">3.1.1. object:any object exposing the array interface, or any (nested) sequence.</a></li>
<li><a href="#orgdeca95c">3.1.2. order: C-&gt;rows, F-&gt;column, K:default</a></li>
<li><a href="#org8914b5c">3.1.3. ndmin: specified the dim of the returned array</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org5731716">4. Numpy IO</a>
<ul>
<li><a href="#org0fd5693">4.1. np.load(), np.save(file, arr): save to binary</a></li>
<li><a href="#orgd1594d3">4.2. np.savez(file, arr<sub>1</sub>, arr<sub>2</sub>): write multiple arrays with compression</a></li>
<li><a href="#org7e6e513">4.3. np.loadtxt(), np.savetxt(): load and save to text</a></li>
</ul>
</li>
<li><a href="#orgba8004f">5. June 13, 2021</a>
<ul>
<li><a href="#org7acf3f1">5.1. decorator:</a>
<ul>
<li><a href="#org8458a9e">5.1.1. Rule-of-thumb: the decorator must be callable, or any object that has `_<sub>call</sub>_<sub>()</sub>` method</a></li>
<li><a href="#org4b9a202">5.1.2. For example: decorator can be a function, partial function or a class with `_<sub>call</sub>_<sub>()</sub>` method</a></li>
<li><a href="#org43e2b42">5.1.3. It is used add extract functionality to an existing function before or after the function</a></li>
</ul>
</li>
<li><a href="#orgf4a7ed1">5.2. Decorate a function with parameters</a>
<ul>
<li><a href="#org19c5c78">5.2.1. parameters are passed into the inner wrapper() function</a></li>
</ul>
</li>
<li><a href="#orga043be0">5.3. Decorator with function</a>
<ul>
<li><a href="#orgc803f63">5.3.1. The decorator is allowed to have arguments</a></li>
<li><a href="#org6d6861b">5.3.2. Keep the metadata of the wrappee function</a></li>
</ul>
</li>
<li><a href="#org4de9167">5.4. A class decorator for functions</a>
<ul>
<li><a href="#org78cdd1e">5.4.1. class decorator without arguments</a></li>
<li><a href="#org9a7df8e">5.4.2. class decorator with arguments</a></li>
<li><a href="#org0e3deff">5.4.3. decorator for a class</a></li>
<li><a href="#org3ae4e41">5.4.4. Nested decorator</a></li>
</ul>
</li>
<li><a href="#org8a11705">5.5. use cases</a>
<ul>
<li><a href="#org622502c">5.5.1. ID authentication</a></li>
<li><a href="#orgced5a77">5.5.2. timing execution</a></li>
<li><a href="#orgdb982c3">5.5.3. Check the validity of input or attrs</a></li>
<li><a href="#orgad61da4">5.5.4. logging</a></li>
</ul>
</li>
<li><a href="#org535470f">5.6. Decorator with parameters</a>
<ul>
<li><a href="#orgeae5d00">5.6.1. If the decorator has input parameters</a></li>
</ul>
</li>
<li><a href="#org25778b2">5.7. functools.wraps for decorator</a></li>
<li><a href="#org0a548c0">5.8. property</a></li>
</ul>
</li>
<li><a href="#orge168b4f">6. June 15, 2021</a>
<ul>
<li><a href="#org0374647">6.1. How to replace a instance method</a>
<ul>
<li><a href="#orge7dd08e">6.1.1. idea 1: replace the byte code&#x2013;dangerous</a></li>
<li><a href="#org4d2fd7b">6.1.2. idea 2: use the types method - safe</a></li>
<li><a href="#orgbaa6944">6.1.3. How to invoke a function</a></li>
</ul>
</li>
<li><a href="#org3497a92">6.2. convert multiple for loop into one</a></li>
<li><a href="#org3d184a2">6.3. use print function for logging</a></li>
</ul>
</li>
<li><a href="#orgfe74527">7. Meta class</a>
<ul>
<li><a href="#org3cde7fc">7.1. we can use type to create a class</a>
<ul>
<li><a href="#org77f8b40">7.1.1. type(): type(name, bases, dict) -&gt; a new type</a></li>
<li><a href="#orga5a18f5">7.1.2. a class is the instance of a metaclass, when creating a class, it invokes the `_<sub>new</sub>_<sub>()</sub>` of the metaclass</a></li>
<li><a href="#orga94f7e8">7.1.3. In sum, we invoking User(), python will call the `_<sub>call</sub>_<sub>()</sub>` of the type class</a></li>
<li><a href="#org4e1995a">7.1.4. ` _<sub>new</sub>__` work like a constructor, thus it returns the object it builds</a></li>
<li><a href="#org33c4255">7.1.5. `_<sub>init</sub>__` is for initialization, and has no return</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgde97a83">8. What is a metaclass: the one that creates class (template for a class)</a>
<ul>
<li><a href="#orge3b72fa">8.1. it inherits from the `type`</a></li>
<li><a href="#org9cfcc74">8.2. how to create class form a meta class</a>
<ul>
<li><a href="#org908923a">8.2.1. class TestMetaClass(type):pass</a></li>
<li><a href="#orgf893740">8.2.2. class TestClass():_<sub>metaclass</sub>__ = TestMetaClass (can be a function of how to defining the behavior)</a></li>
<li><a href="#orgc6fce64">8.2.3. class TestClass(metaclass=TestMetaClass): pass</a></li>
</ul>
</li>
<li><a href="#orgc5694cf">8.3. C._<sub>class</sub>__: return the class that create instance C (can be a instance or a class)</a></li>
<li><a href="#org1445d66">8.4. C._<sub>bases</sub>__: (C._<sub>bases</sub>__ return only one) return the parent class of class C.</a></li>
</ul>
</li>
<li><a href="#org9b0a231">9. Important: when calling a instance, we invoke the `_<sub>call</sub>_<sub>()</sub>` of its class</a></li>
<li><a href="#orgbd6a082">10. When calling a class, we invoke the `_<sub>call</sub>_<sub>()</sub>` of the metaclass that creates this class</a></li>
<li><a href="#org5b31326">11. 在Python当中，_<sub>call</sub>__,_<sub>new</sub>__,_<sub>init</sub>_<sub>三者之间的关系</sub></a></li>
<li><a href="#org3a59ee4">12. June 17, 2021</a>
<ul>
<li><a href="#orgf05cd36">12.1. class object</a></li>
<li><a href="#orgf0f1ff8">12.2. None and None type</a></li>
</ul>
</li>
<li><a href="#org1fc4eec">13. @classmethod 和@staticmethod</a></li>
<li><a href="#orga3e1c15">14. 内置函数locals()、globals()返回一个字典。区别：前者只读、后者可写。</a></li>
<li><a href="#org17e7a21">15. Python if/else</a></li>
<li><a href="#org5e3cfab">16. June 22, 2021</a>
<ul>
<li><a href="#org5fef00f">16.1. generator</a></li>
<li><a href="#org243e19e">16.2. 包导入</a>
<ul>
<li><a href="#org2670e65">16.2.1. 模块内置属性</a></li>
<li><a href="#orgda5495d">16.2.2. 绝对导入：所有的模块import都从“根节点”开始。根节点的位置由sys.path中的路径决定，项目的根目录一般自动在sys.path中。如果希望程序能处处执行，需手动修改sys.</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org5309f93">17. python learning material url</a>
<ul>
<li><a href="#org7e37166">17.1. <span class="todo TODO">TODO</span> https://www.zlovezl.cn/articles/write-solid-python-codes-part-1/</a></li>
<li><a href="#org794cdde">17.2. <span class="todo TODO">TODO</span> https://blog.csdn.net/liuchunming033/category_1348374.html</a></li>
<li><a href="#org2b82804">17.3. <span class="todo TODO">TODO</span> https://develop.spacemacs.org/</a></li>
</ul>
</li>
<li><a href="#org5f0ae26">18. Descriptor</a>
<ul>
<li><a href="#org44ac86e">18.1. `_<sub>getattribute</sub>__、_<sub>getattr</sub>__、_<sub>setattr</sub>__、_<sub>delattr</sub>__</a>
<ul>
<li><a href="#org099f14d">18.1.1. _<sub>getsttribute</sub>_<sub>方法</sub>：当一个属性被访问的时候发生的行为，称之为“属性拦截器”</a></li>
<li><a href="#orgaa4598a">18.1.2. Python中只要定义了继承object的类，就默认存在属性拦截器，只不过是拦截后没有进行任何操作，而是直接返回。_<sub>getattribute</sub>_<sub>允许我们在访问对象属性时自定义访问行为</sub>，但是使用它特别要小心无限递归的问题。</a></li>
<li><a href="#org522afe5">18.1.3. 重写_<sub>getattribute</sub>__。需要注意的是重写的方法中不能, 使用对象的点运算符访问属性，会再次调用_<sub>getattribute</sub>__。可以使用super()方法避免这个问题。return super(Dog, self)._<sub>getattribute</sub>_<sub>(key)</sub></a></li>
<li><a href="#org548ded8">18.1.4. 一定要在每一个需要访问的属性里面设置返回值，否则会返回None，一般有两种做法，即返回父类的_<sub>getattribute</sub>_<sub>方法</sub>。</a></li>
</ul>
</li>
<li><a href="#orgbda9ad1">18.2. 不要再在_<sub>getattribute</sub>_<sub>方法的定义内部显示使用self.成员</sub>, 否则引发死循环</a></li>
<li><a href="#orgd9b34e9">18.3. `_<sub>getattr</sub>__, `_<sub>setattr</sub>___, `_<sub>delattr</sub>__</a>
<ul>
<li><a href="#orgc091720">18.3.1. _<sub>getattr</sub>_<sub>可以用来在当用户试图访问一个根本不存在</sub>（或者暂时不存在）的属性时，来定义类的行为. Automatically return None if not defined</a></li>
<li><a href="#org6cec782">18.3.2. 而_<sub>getattr</sub>_<sub>仅仅针对的是属性</sub>，不针对方法，即访问未存在的方法的时候依然还是会报错。</a></li>
<li><a href="#org975c62b">18.3.3. _<sub>getattribute</sub>_<sub>针对的是访问已经存在的</sub>（属性和方法）；_<sub>getattr</sub>_<sub>针对的是访问未存在的</sub>（属性）。</a></li>
<li><a href="#orgb875af5">18.3.4. _<sub>getattribute</sub>_<sub>和</sub>_<sub>getattr</sub>_<sub>虽然针对每一个访问的key</sub>，一定要有对应的返回值（参见前文），但是返回的东西却不是一样的，即_<sub>getattribute</sub>_<sub>返回父类的</sub>_<sub>getattribute</sub>_<sub>函数</sub>，而_<sub>getattr</sub>_<sub>返回我希望为未知属性设置的那个值或者是异常信息</sub>。</a></li>
</ul>
</li>
<li><a href="#org9fc6648">18.4. _<sub>setattr</sub>_<sub>(self, name, value)</sub></a>
<ul>
<li><a href="#org71ef234">18.4.1. _<sub>setattr</sub>_<sub>方法允许定义为某个属性赋值的时候所发生行为</sub>，不管这个属性存在与否，都可以对任意属性的任何变化都定义自己的规则。</a></li>
<li><a href="#org68ed80d">18.4.2. 即使在_<sub>init</sub>_<sub>()</sub>内的属性赋值也会调用_<sub>setattr</sub>_<sub>方法</sub></a></li>
<li><a href="#orgf33721e">18.4.3. 只要是属性被修改或者是赋值，不管这个属性是实例属性、类属性、父类的类属性；亦或者是已经存在的属性、不存在的属性，只要是修改和赋值，都会调用到_<sub>steattr</sub>_<sub>方法</sub>。</a></li>
<li><a href="#org6d4294b">18.4.4. 关于_<sub>setattr</sub>_<sub>有一点需要说明</sub>，不能写成类似self.name = “张三”这样的形式，这样的赋值语句会调用_<sub>setattr</sub>_<sub>方法</sub>，这样会让其陷入无限递归，参见前文的_<sub>getattribute</sub>_<sub>方法出现无限递归</sub></a></li>
</ul>
</li>
<li><a href="#org3c32032">18.5. _<sub>delattr</sub>_<sub>(self, name)</sub></a>
<ul>
<li><a href="#org88d6047">18.5.1. _<sub>delattr</sub>_<sub>用于处理删除属性时的行为</sub>。和_<sub>setattr</sub>_<sub>方法要注意无限递归的问题</sub>，重写该方法时不要有类似del self.name的写法。</a></li>
<li><a href="#orgbc0d7a3">18.5.2. _<sub>delattr</sub>_<sub>只能够删除</sub> 已经存在的、实例属性，对于不存在的属性和类属性(因为它是属于类的)是不能够删除的。</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orge515ed8">19. Descriptor</a>
<ul>
<li><a href="#orgfac91e8">19.1. 描述符：某个类，只要是内部定义了方法 `_<sub>get</sub>_<sub>,并定义了</sub> <span class="underline">`_<sub>set</sub>__</span>, <span class="underline">`_<sub>delete</sub>__</span> 中的一个或多个</a></li>
<li><a href="#org32431a5">19.2. 非数据描述器: 仅定义了 _<sub>get</sub>_<sub>()</sub> 的描述器称为非数据描述器</a>
<ul>
<li><a href="#orgd3e728f">19.2.1. 非描述器常用于类的方法，如常见的 staticmethod 和 classmethod，都是其应用</a></li>
<li><a href="#org39fa1b8">19.2.2. 函数定义了`_<sub>get</sub>__'方法，所以也是非数据描述符</a></li>
</ul>
</li>
<li><a href="#orge7bb229">19.3. 数据描述器: 如果一个对象定义了 _<sub>set</sub>_<sub>()</sub> 或 _<sub>delete</sub>_<sub>()</sub>，则它会被视为数据描述器</a></li>
<li><a href="#orga755243">19.4. 描述符对象：描述符（即一个类，因为描述符的本质是类）的一个对象，一般是作为其他类对象的属性而存在</a>
<ul>
<li><a href="#orge3f0604">19.4.1. 绑定行为：所谓的绑定行为，是指在属性的访问、赋值、删除时还绑定发生了其他的事情，正如前面属性控制三剑客所完成的事情一样；</a></li>
<li><a href="#orgbbe4986">19.4.2. 托管属性：python描述符是一种创建“托管属性”的方法，即通过描述符（类）去托管另一个类的相关属性，也可以说是类的属性的一个代理。所谓的描述符（描述类）就是专门再创建一个类，让这个类去描述本身那个类的相关属性.</a></li>
</ul>
</li>
<li><a href="#orgb393b2b">19.5. 描述符三个函数的定义形式：</a></li>
<li><a href="#orgffff9c2">19.6. 描述符是一个类属性，必须定义在类的层次上, 而不能单纯的定义为对象属性。</a></li>
<li><a href="#org0bfddff">19.7. 属性的优先访问级别总结:</a>
<ul>
<li><a href="#org332bd7b">19.7.1. (1) _<sub>getattribute</sub>_<sub>()</sub>， 无条件调用，任何时候都先调用</a></li>
<li><a href="#org3b35035">19.7.2. (2) 实例属性</a></li>
<li><a href="#org66264d7">19.7.3. (3) 类属性</a></li>
<li><a href="#org0b38881">19.7.4. (4) 父类属性</a></li>
<li><a href="#org91599d2">19.7.5. (5) _<sub>getattr</sub>_<sub>()</sub> 方法  #如果所有的属性都没有搜索到，则才会调用该函数</a></li>
</ul>
</li>
<li><a href="#org603b3d2">19.8. 实例属性查询优先级：</a>
<ul>
<li><a href="#org22845ab">19.8.1. (1).obj._<sub>getattribute</sub>_<sub>()</sub></a></li>
<li><a href="#org63e9a83">19.8.2. (2).数据描述符</a></li>
<li><a href="#org8484e22">19.8.3. (3).实例的字典</a></li>
<li><a href="#org0c8c75f">19.8.4. (4).类的字典（4，5排序并不准确，当两者同名且同为类属性时，后声明赋的值，会覆盖前面的赋值，譬如a=4;a=5;执行完成是5，因为程序是从上往下按顺序执行的）</a></li>
<li><a href="#org19372d6">19.8.5. (5).非数据描述符</a></li>
<li><a href="#orgf168276">19.8.6. (6).父类的字典</a></li>
<li><a href="#org3a8f8c0">19.8.7. (7).`_<sub>getattr</sub>__'</a></li>
<li><a href="#orgaa34cef">19.8.8. Assuming Class is the class and instance is an instance of Class, evaluating instance.foobar roughly equates to this:</a></li>
<li><a href="#orgb22c60f">19.8.9. (1).Call the type slot for Class._<sub>getattribute</sub>__ (tp<sub>getattro</sub>). The default does this: [10]</a></li>
<li><a href="#orgdaa7814">19.8.10. (2).Does Class._<sub>dict</sub>__ have a foobar item that has a <span class="underline"><span class="underline">get</span></span> method and is a data descriptor [8]?</a></li>
<li><a href="#org4b0a25f">19.8.11. (3).If yes, return the result of Class._<sub>dict</sub>__['foobar']._<sub>get</sub>_<sub>(instance, Class)</sub>. [6]</a></li>
<li><a href="#org61d3d1f">19.8.12. (4).Does instance._<sub>dict</sub>__ have a foobar item in it?</a></li>
<li><a href="#orga258094">19.8.13. (5).If yes, return instance._<sub>dict</sub>__['foobar'].</a></li>
<li><a href="#orga8b0adb">19.8.14. (6).Does Class._<sub>dict</sub>__ have a foobar item that has a <span class="underline"><span class="underline">get</span></span> method and is not a data descriptor [9]?</a></li>
<li><a href="#orgb9af527">19.8.15. (7).If yes, return the result of Class._<sub>dict</sub>__['foobar']._<sub>get</sub>_<sub>(instance, Class)</sub>. [6]</a></li>
<li><a href="#org4e39b5a">19.8.16. (8).Does Class._<sub>dict</sub>__ have a foobar item?</a></li>
<li><a href="#org05121fc">19.8.17. (9).If yes, return the result of Class._<sub>dict</sub>__['foobar'].</a></li>
<li><a href="#org0bef149">19.8.18. (10).If the attribute still wasn't found, and there's a Class._<sub>getattr</sub>__, call Class._<sub>getattr</sub>_<sub>('foobar')</sub>.</a></li>
</ul>
</li>
<li><a href="#orga258efb">19.9. Class attribute lookup:</a>
<ul>
<li><a href="#org6d09a93">19.9.1. </a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgcafc7de">20. 实现底层@classmethod</a></li>
<li><a href="#orgc6b7689">21. 实现底层 @staticmethod</a></li>
<li><a href="#orgecd347f">22. 实现底层 @property</a></li>
<li><a href="#org5b79be7">23. 描述器和装饰器的区别</a>
<ul>
<li><a href="#org60a03f4">23.1. 同：描述器类和不带参数的装饰器类一样，都传入函数对象作为参数，并返回一个类实例</a></li>
<li><a href="#orgb87eb6b">23.2. 异：装饰器类返回 callable 的实例，描述器则返回描述器实例</a></li>
</ul>
</li>
<li><a href="#orgc8af110">24. 属性调用</a>
<ul>
<li><a href="#org85ef8ea">24.1. 整个描述符的核心是`_<sub>getattribute</sub>__`, 因为对每个属性实例的调用都会用到这个函数。这个方法被用来查找类属性，同时也是属性代理，调用该方法可以进行属性访问</a>
<ul>
<li><a href="#orgc125fbc">24.1.1. 给定类X和实例x, x.foo由`_<sub>getattribute</sub>__`转化为：type(x)._<sub>dict</sub>['foo']._<sub>get</sub>_<sub>(x, type(x))</sub>,描述符是类属性，要用类调用</a></li>
<li><a href="#org2025324">24.1.2. 如果是类调用了`_<sub>get</sub>__`方法，那么将None作为对象传入：X._<sub>dict</sub>['foo']._<sub>get</sub>_<sub>(None, X)</sub></a></li>
<li><a href="#orgc017057">24.1.3. 非数据描述符的目的只是当实例属性值不存在时，提供一个值。当一个实例的`_<sub>dict</sub>__`中找不到某个属性时，才去调用`_<sub>getattr</sub>__`,如果没有找到非数据描述符，那么`_<sub>getattribute</sub>__`会抛出异常，然后调用`_<sub>getattr</sub>__`</a></li>
</ul>
</li>
<li><a href="#org1e337ff">24.2. `_<sub>getattribute</sub>__`调用顺序</a>
<ul>
<li><a href="#org1c4c1e9">24.2.1. 类属性 &gt; 数据描述符 &gt; 实例属性(`_<sub>dict</sub>__['foo']`) &gt; 非数据描述符 &gt; `_<sub>getattr</sub>__`</a></li>
<li><a href="#org3757182">24.2.2. 获取属性的三种方法：(a).instance.attr, (2).instance._<sub>dict</sub>__['attr'], (3).getattr(instance, 'attr')</a></li>
<li><a href="#orgb123357">24.2.3. 点操作符的查找逻辑位于 object._<sub>getattribute</sub>_<sub>()</sub> 方法中</a></li>
<li><a href="#orgd3022b4">24.2.4. 一般情况下， 当调用instance.attr(点属性符）访问属性时，实际是使用instance._<sub>dict</sub>__['attr']</a></li>
<li><a href="#org5316fa5">24.2.5. `_<sub>setitem</sub>_<sub>()</sub>、`_<sub>getitem</sub>_<sub>()</sub>、`_<sub>delitem</sub>_<sub>()</sub>:`_<sub>xxxitem</sub>__:使用 [''] 的方式操作属性时被调用</a></li>
</ul>
</li>
<li><a href="#org3286f88">24.3. 类的方法实际就是一个仅实现了 _<sub>get</sub>_<sub>()</sub> 的非资料描述器，所以如果实例 c 中同时定义了名为 foo 的方法和属性，那么 c.foo 访问的是属性而非方法。</a></li>
<li><a href="#org97d49cb">24.4. 有几点需要牢记的：</a>
<ul>
<li><a href="#org595a269">24.4.1. 描述器被 _<sub>getattribute</sub>_<sub>()</sub> 方法调用,因而，重载 _<sub>getattribute</sub>_<sub>()</sub> 可能会妨碍描述器被自动调用</a></li>
<li><a href="#orga99d4ea">24.4.2. _<sub>getattribute</sub>_<sub>()</sub> 仅存在于继承自 object 的新式类之中</a></li>
<li><a href="#orgf23eaeb">24.4.3. object._<sub>getattribute</sub>_<sub>()</sub> 和 type._<sub>getattribute</sub>_<sub>()</sub> 对 _<sub>get</sub>_<sub>()</sub> 的调用不一样</a></li>
<li><a href="#org20f0271">24.4.4. 资料描述器总会覆盖实例字典，即资料描述器具有最高优先级</a></li>
<li><a href="#orgde39caf">24.4.5. 非资料描述器可能会被实例字典覆盖，即非资料描述器具有最低优先级</a></li>
</ul>
</li>
<li><a href="#org32705bc">24.5. property()是在它所在的类被创建时被调用的，所以传入property的参数是非绑定的函数（不是方法，因为实例没有创建）</a></li>
</ul>
</li>
<li><a href="#org0d10396">25. yield from</a>
<ul>
<li><a href="#org1ccf105">25.1. yield from 后面可以跟的可以是“ 生成器 、元组、 列表、range（）函数产生的序列等可迭代对象”</a></li>
<li><a href="#org0f1a72f">25.2. yield from  generator, 实际上就是返回另外一个生成器. 而yield只是返回一个元素</a></li>
<li><a href="#org6942070">25.3. yield from iterable本质上等于 for item in iterable: yield item</a></li>
<li><a href="#org9512ce9">25.4. yield from 替代内层for循环</a>
<ul>
<li><a href="#org2df6c74">25.4.1. 如果生成器函数需要产出另一个生成器生成的值，传统的解决方法是使用嵌套的for循环</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org1236638">26. magic method</a></li>
<li><a href="#orge0c4822">27. exceptional flow control</a></li>
<li><a href="#org5d2ea6e">28. July 13, 2021</a>
<ul>
<li><a href="#orgbb22438">28.1. jupyter-lab cannot find my env</a></li>
<li><a href="#orge3ba4ab">28.2. solutions</a></li>
<li><a href="#org85f4228">28.3. Machine learning course links</a>
<ul>
<li><a href="#orgb09009d">28.3.1. <span class="todo TODO">TODO</span> https://speech.ee.ntu.edu.tw/~hylee/mlds/2018-spring.html</a></li>
<li><a href="#orgcb09fef">28.3.2. <span class="todo TODO">TODO</span> statistics review: https://zhuanlan.zhihu.com/p/70034585</a></li>
<li><a href="#org15ef9b6">28.3.3. python tutorials</a></li>
<li><a href="#org1017584">28.3.4. pytorch tutorials:</a></li>
<li><a href="#org44063a1">28.3.5. Design patterns tutorials:</a></li>
<li><a href="#orgd968dc8">28.3.6. tensorflow tutorials</a></li>
<li><a href="#org959f6ce">28.3.7. XAI vis</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org14cfac4">29. python attribute lookup order</a>
<ul>
<li><a href="#org8c2c0db">29.1. https://blog.ionelmc.ro/2015/02/09/understanding-python-metaclasses/#object-attribute-lookup</a></li>
<li><a href="#orga91aae0">29.2. </a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-orgc70cb69" class="outline-2">
<h2 id="orgc70cb69"><span class="section-number-2">1</span> numpy learning</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org6d58c1a" class="outline-3">
<h3 id="org6d58c1a"><span class="section-number-3">1.1</span> axis=i</h3>
<div class="outline-text-3" id="text-1-1">
</div>
<div id="outline-container-org519bf32" class="outline-4">
<h4 id="org519bf32"><span class="section-number-4">1.1.1</span> apply operations on each elements of i-th index (element in the (i+1)-th square bracket) of the shape</h4>
</div>
<div id="outline-container-org0e5cc25" class="outline-4">
<h4 id="org0e5cc25"><span class="section-number-4">1.1.2</span> example: 2d:</h4>
</div>
<div id="outline-container-orge015ebf" class="outline-4">
<h4 id="orge015ebf"><span class="section-number-4">1.1.3</span> axis=0, vertical, axis = 1, horizontally, axis=3, can be viewed as operate horizontally on the element of a[0,&#x2026;]</h4>
</div>
</div>
<div id="outline-container-orgecbfcec" class="outline-3">
<h3 id="orgecbfcec"><span class="section-number-3">1.2</span> basics</h3>
<div class="outline-text-3" id="text-1-2">
</div>
<div id="outline-container-orge062b2e" class="outline-4">
<h4 id="orge062b2e"><span class="section-number-4">1.2.1</span> ndarray: with an alias array, and axis means dim</h4>
</div>
<div id="outline-container-org8fcb419" class="outline-4">
<h4 id="org8fcb419"><span class="section-number-4">1.2.2</span> Attributes</h4>
<div class="outline-text-4" id="text-1-2-2">
</div>
<ol class="org-ol">
<li><a id="org9e8873c"></a>ndarray.ndim:=len(ndarray.shape) =rank, which no. of dims (axis)<br /></li>
<li><a id="org87ba810"></a>ndarray.shape: (n, m): a tuple of integer, with each element denoting the no. of element in the corresponding dim<br /></li>
<li><a id="orgcc6809a"></a>ndarray.size: = total no. of elements = ndarray.shape[0]* ndarray.shape[1]<br /></li>
<li><a id="org98eff5e"></a>ndarray.dtype: the type of elements in the ndarray<br /></li>
<li><a id="org5bd7768"></a>ndarray.itemsize: the byte size for each element= bits/8<br /></li>
<li><a id="org027f13d"></a>ndarray.data: the data in cache (memory) of the array<br /></li>
</ol>
</div>
<div id="outline-container-org8849bdd" class="outline-4">
<h4 id="org8849bdd"><span class="section-number-4">1.2.3</span> example</h4>
</div>
<div id="outline-container-org666faf0" class="outline-4">
<h4 id="org666faf0"><span class="section-number-4">1.2.4</span> method</h4>
<div class="outline-text-4" id="text-1-2-4">
</div>
<ol class="org-ol">
<li><a id="org790fc6e"></a>reshape(): won't change the original ndarray<br /></li>
<li><a id="org30d7355"></a>flatten(): return a new flatten to 1-d array<br /></li>
<li><a id="org71f1ea8"></a>astype(): return a new array with the specified data type<br /></li>
<li><a id="orgb3405fd"></a>sum(): sum up along axis<br /></li>
<li><a id="org8124d08"></a>cumsum():<br /></li>
<li><a id="org6d39ea7"></a>max():<br /></li>
<li><a id="org67f7e0e"></a>min():<br /></li>
<li><a id="org3aa9207"></a>mean():<br /></li>
</ol>
</div>
<div id="outline-container-orgecca27e" class="outline-4">
<h4 id="orgecca27e"><span class="section-number-4">1.2.5</span> how to create ndarray</h4>
<div class="outline-text-4" id="text-1-2-5">
</div>
<ol class="org-ol">
<li><a id="org4141a53"></a>np.array( a python list, or tuple, or list of tuple): the dtype is inferred from data<br />
<ol class="org-ol">
<li><a id="orged6cf62"></a>np.array([&#x2026;], dtype=complex): the dtype can be specified<br /></li>
</ol>
</li>
<li><a id="orgcfeef74"></a>np.asarray(arr<sub>like</sub>, dtype=None, order=None):<br /></li>
<li><a id="org903f754"></a>np.fromiter(iterable, dtype, count=-1):build array from iterable<br />
<ol class="org-ol">
<li><a id="org6df27c0"></a>The number of items to read from <b>iterable</b>.  The default is -1,which means all data is read.<br /></li>
</ol>
</li>
<li><a id="orgf2a4898"></a>np.logspace(start, stop, num=50, base=10.0, dtype=None):<br />
<ol class="org-ol">
<li><a id="org0756857"></a>In linear space, the sequence starts at ``base <b>* start``(`base` to the power of `start`) and ends with ``base *</b> stop``<br /></li>
<li><a id="org1843c8f"></a><br /></li>
</ol>
</li>
<li><a id="orgfc1d354"></a>np.full(shape, fill<sub>value</sub>): return an array with the specified shape and value<br /></li>
<li><a id="org4d16966"></a>np.random.random(shape)<br /></li>
<li><a id="org50ce0ae"></a>np.eye(n<sub>dims</sub>)<br /></li>
<li><a id="org118b5cf"></a>np.diag(list<sub>of</sub><sub>values</sub>): return a diagonal array with the specified diagonal values<br /></li>
<li><a id="org6a1614e"></a>np.zeros(shape: a tuple or an int for 1d array): the default dtype is 'float64'<br />
<ol class="org-ol">
<li><a id="org1e2cf39"></a>np.zeros<sub>like</sub>()<br /></li>
</ol>
</li>
<li><a id="orgda38130"></a>np.empty(shape: a 2d tuple): its values are randomly init, with default dtype is float64<br />
<ol class="org-ol">
<li><a id="org4148c4c"></a>np.empty<sub>like</sub>()<br /></li>
</ol>
</li>
<li><a id="orgce89374"></a>np.arange(start, end, step): return an array. When used with float parameters, cannot control the no. of elements created, solution: linspace<br /></li>
<li><a id="org3edab46"></a>np.linspace(start, end, no of elements):<br /></li>
<li><a id="orgce0fc5a"></a>np.ones()<br />
<ol class="org-ol">
<li><a id="org11ec577"></a>np.ones<sub>like</sub>()<br /></li>
</ol>
</li>
<li><a id="orgdd82b37"></a>np.fromfunction(function, shape, dtype):<br />
<ol class="org-ol">
<li><a id="org54896ec"></a>(N,) tuple of ints Shape of the output array, which also determines the shape of the coordinate arrays passed to `function`.<br /></li>
<li><a id="orgc93ef02"></a>function(index<sub>1</sub>): for 1d or function(index<sub>1</sub>, index<sub>2</sub>) for 2d, where index<sub>i</sub> in np.arange(shape[i])<br /></li>
</ol>
</li>
</ol>
</div>
<div id="outline-container-org63c931f" class="outline-4">
<h4 id="org63c931f"><span class="section-number-4">1.2.6</span> create bool array</h4>
<div class="outline-text-4" id="text-1-2-6">
</div>
<ol class="org-ol">
<li><a id="org0f802ba"></a>b = np.array([1,0, 3,0], dtype=bool)<br /></li>
</ol>
</div>
<div id="outline-container-org121dfcb" class="outline-4">
<h4 id="org121dfcb"><span class="section-number-4">1.2.7</span> print the whole array</h4>
<div class="outline-text-4" id="text-1-2-7">
</div>
<ol class="org-ol">
<li><a id="org5433b7e"></a>np.set<sub>printoptions</sub>(threshold=sys.maxsize)       # sys module should be imported<br /></li>
</ol>
</div>
</div>
<div id="outline-container-orgbf32f33" class="outline-3">
<h3 id="orgbf32f33"><span class="section-number-3">1.3</span> index</h3>
<div class="outline-text-3" id="text-1-3">
</div>
<div id="outline-container-org1e36129" class="outline-4">
<h4 id="org1e36129"><span class="section-number-4">1.3.1</span> index of an array can be any list, array or tuple</h4>
<div class="outline-text-4" id="text-1-3-1">
</div>
<ol class="org-ol">
<li><a id="org1e425c1"></a>a[1:4] == a[ [0,1,2,3] ]<br /></li>
<li><a id="org00407f1"></a>a[array([1,2])] is legal<br /></li>
</ol>
</div>
</div>
<div id="outline-container-org76cae52" class="outline-3">
<h3 id="org76cae52"><span class="section-number-3">1.4</span> basic operations</h3>
<div class="outline-text-3" id="text-1-4">
</div>
<div id="outline-container-orgf60cea5" class="outline-4">
<h4 id="orgf60cea5"><span class="section-number-4">1.4.1</span> the math operations on an array will be applied on each element</h4>
<div class="outline-text-4" id="text-1-4-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #7590db;">a</span> = np.array<span style="color: #4f97d7;">(</span> <span style="color: #bc6ec5;">[</span><span style="color: #a45bad;">20</span>,<span style="color: #a45bad;">30</span>,<span style="color: #a45bad;">40</span>,<span style="color: #a45bad;">50</span><span style="color: #bc6ec5;">]</span> <span style="color: #4f97d7;">)</span>
<span style="color: #7590db;">b</span> = np.arange<span style="color: #4f97d7;">(</span> <span style="color: #a45bad;">4</span> <span style="color: #4f97d7;">)</span>
<span style="color: #7590db;">c</span> = a-b <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">array([20, 29, 38, 47])</span>
b**<span style="color: #a45bad;">2</span> <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">array([0, 1, 4, 9])</span>
a&lt;<span style="color: #a45bad;">35</span> <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">array([ True, True, False, False])</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org4b09a62" class="outline-4">
<h4 id="org4b09a62"><span class="section-number-4">1.4.2</span> '\*': element-wised multiplication</h4>
</div>
<div id="outline-container-org215c10c" class="outline-4">
<h4 id="org215c10c"><span class="section-number-4">1.4.3</span> matrix multiplication: @ or 'dot' function (python&gt;=3.5) A*B, A.dot(B)</h4>
</div>
<div id="outline-container-org9348c6b" class="outline-4">
<h4 id="org9348c6b"><span class="section-number-4">1.4.4</span> some operations can modify array in place: such as '+=', `*=`</h4>
<div class="outline-text-4" id="text-1-4-4">
</div>
<ol class="org-ol">
<li><a id="orgbbd5501"></a>a += b: it requires that b can be automatically converted to the type of a, o.w., error<br /></li>
<li><a id="org3bcabf5"></a>a(int) += b(float): error<br /></li>
<li><a id="org66d1cb6"></a>the result of operations involving different types of array:<br />
<ol class="org-ol">
<li><a id="org63bc68b"></a>cast to the higher precision representation<br /></li>
</ol>
</li>
</ol>
</div>
<div id="outline-container-org09478c9" class="outline-4">
<h4 id="org09478c9"><span class="section-number-4">1.4.5</span> unary-operation: one element</h4>
<div class="outline-text-4" id="text-1-4-5">
</div>
<ol class="org-ol">
<li><a id="org9c4e097"></a>a.sum():<br /></li>
<li><a id="org28bff41"></a>a.min():<br /></li>
<li><a id="org2bcb4db"></a>a.max():<br /></li>
<li><a id="org17c5154"></a>can be applied on given axis<br />
<ol class="org-ol">
<li><a id="orgdacaae9"></a>b.sum(axis=None) # sum of each column, axis default is None, denoting sum all<br /></li>
<li><a id="org21f27df"></a>b.min(axis=0) # min of each row, default is None, axis default is None<br /></li>
<li><a id="orgcfc28c8"></a>b.cumsum(axis=1) # cumulative sum along each row, axis default is None<br /></li>
</ol>
</li>
</ol>
</div>
<div id="outline-container-org73d1af2" class="outline-4">
<h4 id="org73d1af2"><span class="section-number-4">1.4.6</span> ufunc: universal function</h4>
<div class="outline-text-4" id="text-1-4-6">
</div>
<ol class="org-ol">
<li><a id="org41b0515"></a>operates in an element-by-element fashion, supporting array broadcasting, type casting, and several other standard features.<br /></li>
<li><a id="org6757e49"></a>example, sin, cos, exp, sqrt, add<br /></li>
</ol>
</div>
<div id="outline-container-org3009652" class="outline-4">
<h4 id="org3009652"><span class="section-number-4">1.4.7</span> slicing</h4>
<div class="outline-text-4" id="text-1-4-7">
</div>
<ol class="org-ol">
<li><a id="org5ba6c1f"></a>a[ : :-1]: revert the array<br /></li>
<li><a id="orgcd7f949"></a>the slicing can be performed on each axis: a[1:3, 2:3]<br /></li>
<li><a id="orgb75d0ec"></a>when slicing is performed on a no axis that less than rank, the slicing on the missing axis is set to be all along the axis, that is ':'<br />
<ol class="org-ol">
<li><a id="orgfe18697"></a>b.shape-&gt; (2, 3), b[-1]-&gt; =b[-1, :] # the last row<br /></li>
<li><a id="org3a460c0"></a>b[i] = b[i,:] = b[i,&#x2026;]<br /></li>
<li><a id="org7c55306"></a>'&#x2026;': denote the rest of the index, take for example x, x has rank five, len(x.shape) -&gt;5<br /></li>
<li><a id="org4f88d3e"></a>x[1,2,&#x2026;] = x[1,2,:,:,:]，<br /></li>
<li><a id="orgf4357e3"></a>x[&#x2026;,3] = x[:,:,:,:,3]<br /></li>
<li><a id="org30ea4ef"></a>x[4,&#x2026;,5,:] = x[4,:,:,5,:]<br /></li>
</ol>
</li>
<li><a id="org3734019"></a>when iterate over a ndarray, it is on the first dim<br />
<ol class="org-ol">
<li><a id="org68a05e2"></a>for row in b: print(row)<br /></li>
</ol>
</li>
<li><a id="org561a686"></a>to iterate over every item, we can use the 'flat' attribute, which is the generator of all the elements<br />
<ol class="org-ol">
<li><a id="org985f9f0"></a>a.flat: attribute, return a flat iterator over an array, return type: &lt;class 'numpy.flatiter'&gt;<br /></li>
<li><a id="org2f239e4"></a>a.flatten():Returns a flattened copy of an array.<br /></li>
<li><a id="org3d8e7eb"></a>for element in b.flat: print(element)<br /></li>
</ol>
</li>
</ol>
</div>
<div id="outline-container-org4ffd0fd" class="outline-4">
<h4 id="org4ffd0fd"><span class="section-number-4">1.4.8</span> operation on the shape</h4>
<div class="outline-text-4" id="text-1-4-8">
</div>
<ol class="org-ol">
<li><a id="orge05d9fb"></a>the following operations can change the shape of an array, and return the modified array, but the original one is unchanged<br /></li>
<li><a id="org0e2af27"></a>a.shape = x,y # can also<br /></li>
<li><a id="orgcce357b"></a>a.ravel()  # returns the array, flattened<br /></li>
<li><a id="org947a001"></a>a.reshape(6,2) # return the array with a modified shape<br />
<ol class="org-ol">
<li><a id="org0525f39"></a>a.reshanp.vstack()np.hstack()pe(shape=ints or a tuple of int)<br /></li>
<li><a id="org866dd3f"></a>if the snp.vstack()np.hstack()ize =-1, the dimension will be inferred automatically<br /></li>
</ol>
</li>
<li><a id="orgeeffbe7"></a>a.resize(new<sub>shape</sub>): change shape and size of array in-place<br /></li>
<li><a id="org51f1d11"></a>a.T # return the transposed array<br /></li>
<li><a id="org95509b9"></a>ndarray.resize(): will change the original array<br /></li>
</ol>
</div>
<div id="outline-container-org0d28f26" class="outline-4">
<h4 id="org0d28f26"><span class="section-number-4">1.4.9</span> array stacking and concatenating</h4>
<div class="outline-text-4" id="text-1-4-9">
</div>
<ol class="org-ol">
<li><a id="org1c96f22"></a>np.vstack(): stack vertically<br /></li>
<li><a id="org58e9c21"></a>np.hstack(): stack horizontally<br />
<ol class="org-ol">
<li><a id="org1a54242"></a>np.floor(): return the floor value element-wised<br /></li>
</ol>
</li>
<li><a id="org63e7dcf"></a>np.column<sub>stack</sub>():<br />
<ol class="org-ol">
<li><a id="org5799423"></a>Stack 1-D arrays as columns into a 2-D array.<br /></li>
<li><a id="org841ae66"></a>2-D arrays are stacked as-is, just like with `np.hstack()`<br /></li>
<li><a id="org6d0e554"></a>a = np.array([4.,2.]), b = np.array([3.,8.]), np.column<sub>stack</sub>((a,b)) -&gt; array([[ 4., 3.], [ 2., 8.]])<br /></li>
<li><a id="orgfa8c1fd"></a>np.hstack((a,b)) -&gt; array([ 4., 2., 3., 8.])<br /></li>
<li><a id="org264b11a"></a>a[:,newaxis] # this allows to have a 2D columns vector -&gt; array([[ 4.], [ 2.]])<br /></li>
<li><a id="orged0fa5b"></a>np.column<sub>stack</sub>((a[:,newaxis],b[:,newaxis])) = np.hstack((a[:,newaxis],b[:,newaxis]))<br /></li>
</ol>
</li>
<li><a id="orgeb8b81f"></a>np.row<sub>stack</sub>() = np.vstack() for any shape of input.<br /></li>
</ol>
</div>
<div id="outline-container-org466b0e6" class="outline-4">
<h4 id="org466b0e6"><span class="section-number-4">1.4.10</span> np.r_ and np.c_</h4>
<div class="outline-text-4" id="text-1-4-10">
</div>
<ol class="org-ol">
<li><a id="orga611afb"></a>np.r_[1:4, 0, 4]-&gt;array([1, 2, 3, 0, 4]): create array along an axis<br /></li>
<li><a id="org3c90a9b"></a>when used with array parameters, the r_ = vstack, c_ = hstack, and allows to specify the axis to concatenate<br /></li>
</ol>
</div>
<div id="outline-container-org176bdef" class="outline-4">
<h4 id="org176bdef"><span class="section-number-4">1.4.11</span> splitting an array</h4>
<div class="outline-text-4" id="text-1-4-11">
</div>
<ol class="org-ol">
<li><a id="orgdb66f61"></a>np.hsplit(a, 3) # split a into 3 array<br /></li>
<li><a id="org70940e7"></a>np.hsplit(a (3, 4)) # split a after the third and the fourth column<br /></li>
<li><a id="org54742ba"></a>np.vsplit(): split vertically<br /></li>
<li><a id="org9590f02"></a>np.array<sub>split</sub>(): split along the specified axis<br /></li>
</ol>
</div>
<div id="outline-container-orgecaaa6e" class="outline-4">
<h4 id="orgecaaa6e"><span class="section-number-4">1.4.12</span> copy and view</h4>
<div class="outline-text-4" id="text-1-4-12">
</div>
<ol class="org-ol">
<li><a id="org3cb2dd3"></a>making alias of a array won't copy the array<br />
<ol class="org-ol">
<li><a id="org6b7ad2e"></a>a = np.arange(10), b = a, #b is an alias of a<br /></li>
</ol>
</li>
<li><a id="org1784bae"></a>passing an changeable object to a function won't copy the object<br />
<ol class="org-ol">
<li><a id="orgdedf2df"></a>def (x):print(id(x)), f(a):  a and x point to the same array<br /></li>
</ol>
</li>
<li><a id="org635d5e7"></a>view and shallow copy<br />
<ol class="org-ol">
<li><a id="orgab2deb2"></a>different array can share the same data.<br /></li>
<li><a id="org9db8f61"></a>view(): New view of array with the same data.<br />
<ol class="org-ol">
<li><a id="orgeb4d810"></a>c = a.view(), # c is a view of the data owned by a<br /></li>
<li><a id="org44ef02b"></a>c.flags.owndata -&gt; false<br /></li>
<li><a id="org94b7506"></a>change the shape of c won't affect the the shape of a<br /></li>
<li><a id="org1f9514d"></a>but change the value of c will change the value of a<br /></li>
</ol>
</li>
<li><a id="org3408ca5"></a>slicing will return a view of the original data, which is an alias instead of a copy.<br />
<ol class="org-ol">
<li><a id="org8ad7bc0"></a>s = a[:, 1:3], # return a view of the data owned by a<br /></li>
<li><a id="org8cf1777"></a>s[:] = 10, vs s=10, there are different, the former change the data of a<br /></li>
</ol>
</li>
</ol>
</li>
<li><a id="orgfcd392b"></a>deep copy: copy data and create new array<br />
<ol class="org-ol">
<li><a id="orgd390223"></a>if the original array is not needed, should use the copy() after slicing<br /></li>
<li><a id="org417000a"></a>b = a[:100].copy, del a, # assume a is a large intermediary result<br /></li>
<li><a id="org2590b74"></a>if b = a[:100], when deleting a, the a will persist in the memory<br /></li>
</ol>
</li>
</ol>
</div>
</div>
<div id="outline-container-orge8cf263" class="outline-3">
<h3 id="orge8cf263"><span class="section-number-3">1.5</span> Method</h3>
<div class="outline-text-3" id="text-1-5">
</div>
<div id="outline-container-orgfd223c2" class="outline-4">
<h4 id="orgfd223c2"><span class="section-number-4">1.5.1</span> frequently used method</h4>
<div class="outline-text-4" id="text-1-5-1">
</div>
<ol class="org-ol">
<li><a id="orgb7bab19"></a>Array Creation - arange, array, copy, empty, empty<sub>like</sub>, eye, fromfile, fromfunction, identity, linspace, logspace, mgrid, ogrid, ones, ones<sub>like</sub>, zeros, zeros<sub>like</sub><br /></li>
<li><a id="org52b9e4a"></a>Conversions - ndarray.astype, atleast<sub>1d</sub>, atleast<sub>2d</sub>, atleast<sub>3d</sub>, mat<br /></li>
<li><a id="org1abcdbd"></a>Manipulations - array<sub>split</sub>, column<sub>stack</sub>, concatenate, diagonal, dsplit, dstack, hsplit, hstack, ndarray.item, newaxis, ravel, repeat, reshape, resize, squeeze, swapaxes, take, transpose, vsplit, vstack<br /></li>
<li><a id="org9b3b035"></a>Questions - all, any, nonzero, where,np.vstack()np.hstack()<br /></li>
<li><a id="org3e3bedc"></a>Ordering - argmax, argmin, argsort, max, min, ptp, searchsorted, sort<br /></li>
<li><a id="orgf198fa0"></a>Operations - choose, compress, cumprod, cumsum, inner, ndarray.fill, imag, prod, put, putmask, real, sum<br /></li>
<li><a id="orga4ddf94"></a>Basic Statistics - cov, mean, std, var<br /></li>
<li><a id="org4e5f668"></a>Basic Linear Algebra - cross, dot, outer, linalg.svd, vdot<br /></li>
</ol>
</div>
<div id="outline-container-orgf619c12" class="outline-4">
<h4 id="orgf619c12"><span class="section-number-4">1.5.2</span> broadcasting</h4>
<div class="outline-text-4" id="text-1-5-2">
</div>
<ol class="org-ol">
<li><a id="org7ef9ea4"></a>ruels: When operating on two arrays, NumPy compares their shapes element-wise. It starts with the trailing (i.e. rightmost) dimensions and works its way left. Two dimensions are compatible when they are equal, or one of them is 1<br />
<ol class="org-ol">
<li><a id="org887a9b2"></a>I.if all the input arrays have different shape, then "1" is used to fill the smallest array such that they have the same shape<br /></li>
</ol>
</li>
<li><a id="org34880a7"></a>example: x = np.arange(4), xx = x.reshape(4,1), y = np.ones(5), z = np.ones((3,4)), x and xx can be broadcast, but x and y are not<br /></li>
</ol>
</div>
</div>
<div id="outline-container-org199d33e" class="outline-3">
<h3 id="org199d33e"><span class="section-number-3">1.6</span> more slicingnp.vstack()np.hstack()</h3>
<div class="outline-text-3" id="text-1-6">
<div class="org-src-container">
<pre class="src src-python">&gt;&gt;&gt; <span style="color: #7590db;">a</span> = np.arange<span style="color: #4f97d7;">(</span><span style="color: #a45bad;">12</span><span style="color: #4f97d7;">)</span>**<span style="color: #a45bad;">2</span>                       <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">the first 12 square numbers</span>
&gt;&gt;&gt; <span style="color: #7590db;">i</span> = np.array<span style="color: #4f97d7;">(</span> <span style="color: #bc6ec5;">[</span> <span style="color: #a45bad;">1</span>,<span style="color: #a45bad;">1</span>,<span style="color: #a45bad;">3</span>,<span style="color: #a45bad;">8</span>,<span style="color: #a45bad;">5</span> <span style="color: #bc6ec5;">]</span> <span style="color: #4f97d7;">)</span>              <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">an array of indices</span>
&gt;&gt;&gt; a<span style="color: #4f97d7;">[</span>i<span style="color: #4f97d7;">]</span>                                       <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">the elements of a at the positions i</span>
array<span style="color: #4f97d7;">(</span><span style="color: #bc6ec5;">[</span> <span style="color: #a45bad;">1</span>,  <span style="color: #a45bad;">1</span>,  <span style="color: #a45bad;">9</span>, <span style="color: #a45bad;">64</span>, <span style="color: #a45bad;">25</span><span style="color: #bc6ec5;">]</span><span style="color: #4f97d7;">)</span>
&gt;&gt;&gt;
&gt;&gt;&gt; <span style="color: #7590db;">j</span> = np.array<span style="color: #4f97d7;">(</span> <span style="color: #bc6ec5;">[</span> <span style="color: #2d9574;">[</span> <span style="color: #a45bad;">3</span>, <span style="color: #a45bad;">4</span><span style="color: #2d9574;">]</span>, <span style="color: #2d9574;">[</span> <span style="color: #a45bad;">9</span>, <span style="color: #a45bad;">7</span> <span style="color: #2d9574;">]</span> <span style="color: #bc6ec5;">]</span> <span style="color: #4f97d7;">)</span>      <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">a bidimensional array of indices</span>
&gt;&gt;&gt; a<span style="color: #4f97d7;">[</span>j<span style="color: #4f97d7;">]</span>                                       <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">the same shape as j</span>
array<span style="color: #4f97d7;">(</span><span style="color: #bc6ec5;">[</span><span style="color: #2d9574;">[</span> <span style="color: #a45bad;">9</span>, <span style="color: #a45bad;">16</span><span style="color: #2d9574;">]</span>,
       <span style="color: #2d9574;">[</span><span style="color: #a45bad;">81</span>, <span style="color: #a45bad;">49</span><span style="color: #2d9574;">]</span><span style="color: #bc6ec5;">]</span><span style="color: #4f97d7;">)</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">when the rank(a)&gt;1, a single index of array indicates the first dim of a.</span>
&gt;&gt;&gt; <span style="color: #7590db;">palette</span> = np.array<span style="color: #4f97d7;">(</span> <span style="color: #bc6ec5;">[</span> <span style="color: #2d9574;">[</span><span style="color: #a45bad;">0</span>,<span style="color: #a45bad;">0</span>,<span style="color: #a45bad;">0</span><span style="color: #2d9574;">]</span>,                <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">black</span>
...                       <span style="color: #2d9574;">[</span><span style="color: #a45bad;">255</span>,<span style="color: #a45bad;">0</span>,<span style="color: #a45bad;">0</span><span style="color: #2d9574;">]</span>,              <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">red</span>
...                       <span style="color: #2d9574;">[</span><span style="color: #a45bad;">0</span>,<span style="color: #a45bad;">255</span>,<span style="color: #a45bad;">0</span><span style="color: #2d9574;">]</span>,              <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">green</span>
...                       <span style="color: #2d9574;">[</span><span style="color: #a45bad;">0</span>,<span style="color: #a45bad;">0</span>,<span style="color: #a45bad;">255</span><span style="color: #2d9574;">]</span>,              <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">blue</span>
...                       <span style="color: #2d9574;">[</span><span style="color: #a45bad;">255</span>,<span style="color: #a45bad;">255</span>,<span style="color: #a45bad;">255</span><span style="color: #2d9574;">]</span> <span style="color: #bc6ec5;">]</span> <span style="color: #4f97d7;">)</span>       <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">white</span>
&gt;&gt;&gt; <span style="color: #7590db;">image</span> = np.array<span style="color: #4f97d7;">(</span> <span style="color: #bc6ec5;">[</span> <span style="color: #2d9574;">[</span> <span style="color: #a45bad;">0</span>, <span style="color: #a45bad;">1</span>, <span style="color: #a45bad;">2</span>, <span style="color: #a45bad;">0</span> <span style="color: #2d9574;">]</span>,           <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">each value corresponds to a color in the palette</span>
...                     <span style="color: #2d9574;">[</span> <span style="color: #a45bad;">0</span>, <span style="color: #a45bad;">3</span>, <span style="color: #a45bad;">4</span>, <span style="color: #a45bad;">0</span> <span style="color: #2d9574;">]</span>  <span style="color: #bc6ec5;">]</span> <span style="color: #4f97d7;">)</span>
&gt;&gt;&gt; palette<span style="color: #4f97d7;">[</span>image<span style="color: #4f97d7;">]</span>                            <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">the (2,4,3) color image</span>
array<span style="color: #4f97d7;">(</span><span style="color: #bc6ec5;">[</span><span style="color: #2d9574;">[</span><span style="color: #67b11d;">[</span>  <span style="color: #a45bad;">0</span>,   <span style="color: #a45bad;">0</span>,   <span style="color: #a45bad;">0</span><span style="color: #67b11d;">]</span>,
        <span style="color: #67b11d;">[</span><span style="color: #a45bad;">255</span>,   <span style="color: #a45bad;">0</span>,   <span style="color: #a45bad;">0</span><span style="color: #67b11d;">]</span>,
        <span style="color: #67b11d;">[</span>  <span style="color: #a45bad;">0</span>, <span style="color: #a45bad;">255</span>,   <span style="color: #a45bad;">0</span><span style="color: #67b11d;">]</span>,
        <span style="color: #67b11d;">[</span>  <span style="color: #a45bad;">0</span>,   <span style="color: #a45bad;">0</span>,   <span style="color: #a45bad;">0</span><span style="color: #67b11d;">]</span><span style="color: #2d9574;">]</span>,
       <span style="color: #2d9574;">[</span><span style="color: #67b11d;">[</span>  <span style="color: #a45bad;">0</span>,   <span style="color: #a45bad;">0</span>,   <span style="color: #a45bad;">0</span><span style="color: #67b11d;">]</span>,
        <span style="color: #67b11d;">[</span>  <span style="color: #a45bad;">0</span>,   <span style="color: #a45bad;">0</span>, <span style="color: #a45bad;">255</span><span style="color: #67b11d;">]</span>,
        <span style="color: #67b11d;">[</span><span style="color: #a45bad;">255</span>, <span style="color: #a45bad;">255</span>, <span style="color: #a45bad;">255</span><span style="color: #67b11d;">]</span>,
        <span style="color: #67b11d;">[</span>  <span style="color: #a45bad;">0</span>,   <span style="color: #a45bad;">0</span>,   <span style="color: #a45bad;">0</span><span style="color: #67b11d;">]</span><span style="color: #2d9574;">]</span><span style="color: #bc6ec5;">]</span><span style="color: #4f97d7;">)</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">we can provide multiple index arrays, and every array should have the same shape</span>
&gt;&gt;&gt; <span style="color: #7590db;">a</span> = np.arange<span style="color: #4f97d7;">(</span><span style="color: #a45bad;">12</span><span style="color: #4f97d7;">)</span>.reshape<span style="color: #4f97d7;">(</span><span style="color: #a45bad;">3</span>,<span style="color: #a45bad;">4</span><span style="color: #4f97d7;">)</span>
&gt;&gt;&gt; anp.vstack<span style="color: #4f97d7;">()</span>np.hstack<span style="color: #4f97d7;">()</span>
array<span style="color: #4f97d7;">(</span><span style="color: #bc6ec5;">[</span><span style="color: #2d9574;">[</span> <span style="color: #a45bad;">0</span>,  <span style="color: #a45bad;">1</span>,  <span style="color: #a45bad;">2</span>,  <span style="color: #a45bad;">3</span><span style="color: #2d9574;">]</span>,
       <span style="color: #2d9574;">[</span> <span style="color: #a45bad;">4</span>,  <span style="color: #a45bad;">5</span>,  <span style="color: #a45bad;">6</span>,  <span style="color: #a45bad;">7</span><span style="color: #2d9574;">]</span>,
       <span style="color: #2d9574;">[</span> <span style="color: #a45bad;">8</span>,  <span style="color: #a45bad;">9</span>, <span style="color: #a45bad;">10</span>, <span style="color: #a45bad;">11</span><span style="color: #2d9574;">]</span><span style="color: #bc6ec5;">]</span><span style="color: #4f97d7;">)</span>
&gt;&gt;&gt; <span style="color: #7590db;">i</span> = np.array<span style="color: #4f97d7;">(</span> <span style="color: #bc6ec5;">[</span> <span style="color: #2d9574;">[</span><span style="color: #a45bad;">0</span>,<span style="color: #a45bad;">1</span><span style="color: #2d9574;">]</span>,                        <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">indices for the first dim of a</span>
...                 <span style="color: #2d9574;">[</span><span style="color: #a45bad;">1</span>,<span style="color: #a45bad;">2</span><span style="color: #2d9574;">]</span> <span style="color: #bc6ec5;">]</span> <span style="color: #4f97d7;">)</span>
&gt;&gt;&gt; <span style="color: #7590db;">j</span> = np.array<span style="color: #4f97d7;">(</span> <span style="color: #bc6ec5;">[</span> <span style="color: #2d9574;">[</span><span style="color: #a45bad;">2</span>,<span style="color: #a45bad;">1</span><span style="color: #2d9574;">]</span>,                        <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">indices for the second dim</span>
...                 <span style="color: #2d9574;">[</span><span style="color: #a45bad;">3</span>,<span style="color: #a45bad;">3</span><span style="color: #2d9574;">]</span> <span style="color: #bc6ec5;">]</span> <span style="color: #4f97d7;">)</span>
&gt;&gt;&gt;
&gt;&gt;&gt; a<span style="color: #4f97d7;">[</span>i,j<span style="color: #4f97d7;">]</span>                                     <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">i and j must have equal shape</span>
array<span style="color: #4f97d7;">(</span><span style="color: #bc6ec5;">[</span><span style="color: #2d9574;">[</span> <span style="color: #a45bad;">2</span>,  <span style="color: #a45bad;">5</span><span style="color: #2d9574;">]</span>,
       <span style="color: #2d9574;">[</span> <span style="color: #a45bad;">7</span>, <span style="color: #a45bad;">11</span><span style="color: #2d9574;">]</span><span style="color: #bc6ec5;">]</span><span style="color: #4f97d7;">)</span>
&gt;&gt;&gt;
&gt;&gt;&gt; a<span style="color: #4f97d7;">[</span>i,<span style="color: #a45bad;">2</span><span style="color: #4f97d7;">]</span>
array<span style="color: #4f97d7;">(</span><span style="color: #bc6ec5;">[</span><span style="color: #2d9574;">[</span> <span style="color: #a45bad;">2</span>,  <span style="color: #a45bad;">6</span><span style="color: #2d9574;">]</span>,
       <span style="color: #2d9574;">[</span> <span style="color: #a45bad;">6</span>, <span style="color: #a45bad;">10</span><span style="color: #2d9574;">]</span><span style="color: #bc6ec5;">]</span><span style="color: #4f97d7;">)</span>
&gt;&gt;&gt;
&gt;&gt;&gt; a<span style="color: #4f97d7;">[</span>:,j<span style="color: #4f97d7;">]</span>                                     <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">i.e., a[ : , j]</span>
array<span style="color: #4f97d7;">(</span><span style="color: #bc6ec5;">[</span><span style="color: #2d9574;">[</span><span style="color: #67b11d;">[</span> <span style="color: #a45bad;">2</span>,  <span style="color: #a45bad;">1</span><span style="color: #67b11d;">]</span>,
        <span style="color: #67b11d;">[</span> <span style="color: #a45bad;">3</span>,  <span style="color: #a45bad;">3</span><span style="color: #67b11d;">]</span><span style="color: #2d9574;">]</span>,
       <span style="color: #2d9574;">[</span><span style="color: #67b11d;">[</span> <span style="color: #a45bad;">6</span>,  <span style="color: #a45bad;">5</span><span style="color: #67b11d;">]</span>,
        <span style="color: #67b11d;">[</span> <span style="color: #a45bad;">7</span>,  <span style="color: #a45bad;">7</span><span style="color: #67b11d;">]</span><span style="color: #2d9574;">]</span>,
       <span style="color: #2d9574;">[</span><span style="color: #67b11d;">[</span><span style="color: #a45bad;">10</span>,  <span style="color: #a45bad;">9</span><span style="color: #67b11d;">]</span>,
        <span style="color: #67b11d;">[</span><span style="color: #a45bad;">11</span>, <span style="color: #a45bad;">11</span><span style="color: #67b11d;">]</span><span style="color: #2d9574;">]</span><span style="color: #bc6ec5;">]</span><span style="color: #4f97d7;">)</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">equivalently we can have</span>
&gt;&gt;&gt; <span style="color: #7590db;">l</span> = <span style="color: #4f97d7;">[</span>i,j<span style="color: #4f97d7;">]</span>
&gt;&gt;&gt; a<span style="color: #4f97d7;">[</span>l<span style="color: #4f97d7;">]</span>                                       <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">equivalent to a[i,j]</span>
array<span style="color: #4f97d7;">(</span><span style="color: #bc6ec5;">[</span><span style="color: #2d9574;">[</span> <span style="color: #a45bad;">2</span>,  <span style="color: #a45bad;">5</span><span style="color: #2d9574;">]</span>,
       <span style="color: #2d9574;">[</span> <span style="color: #a45bad;">7</span>, <span style="color: #a45bad;">11</span><span style="color: #2d9574;">]</span><span style="color: #bc6ec5;">]</span><span style="color: #4f97d7;">)</span>


<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">index can be used to assign new value</span>
&gt;&gt;&gt; <span style="color: #7590db;">a</span> = np.arange<span style="color: #4f97d7;">(</span><span style="color: #a45bad;">5</span><span style="color: #4f97d7;">)</span>
&gt;&gt;&gt; a
array<span style="color: #4f97d7;">(</span><span style="color: #bc6ec5;">[</span><span style="color: #a45bad;">0</span>, <span style="color: #a45bad;">1</span>, <span style="color: #a45bad;">2</span>, <span style="color: #a45bad;">3</span>, <span style="color: #a45bad;">4</span><span style="color: #bc6ec5;">]</span><span style="color: #4f97d7;">)</span>
&gt;&gt;&gt; a<span style="color: #4f97d7;">[</span><span style="color: #bc6ec5;">[</span><span style="color: #a45bad;">1</span>,<span style="color: #a45bad;">3</span>,<span style="color: #a45bad;">4</span><span style="color: #bc6ec5;">]</span><span style="color: #4f97d7;">]</span> = <span style="color: #a45bad;">0</span>
&gt;&gt;&gt; a
array<span style="color: #4f97d7;">(</span><span style="color: #bc6ec5;">[</span><span style="color: #a45bad;">0</span>, <span style="color: #a45bad;">0</span>, <span style="color: #a45bad;">2</span>, <span style="color: #a45bad;">0</span>, <span style="color: #a45bad;">0</span><span style="color: #bc6ec5;">]</span><span style="color: #4f97d7;">)</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">when a index is used to assign value multiple times, it keeps the last oen</span>
&gt;&gt;&gt; <span style="color: #7590db;">a</span> = np.arange<span style="color: #4f97d7;">(</span><span style="color: #a45bad;">5</span><span style="color: #4f97d7;">)</span>
&gt;&gt;&gt; a<span style="color: #4f97d7;">[</span><span style="color: #bc6ec5;">[</span><span style="color: #a45bad;">0</span>,<span style="color: #a45bad;">0</span>,<span style="color: #a45bad;">2</span><span style="color: #bc6ec5;">]</span><span style="color: #4f97d7;">]</span>=<span style="color: #4f97d7;">[</span><span style="color: #a45bad;">1</span>,<span style="color: #a45bad;">2</span>,<span style="color: #a45bad;">3</span><span style="color: #4f97d7;">]</span>
&gt;&gt;&gt; a
array<span style="color: #4f97d7;">(</span><span style="color: #bc6ec5;">[</span><span style="color: #a45bad;">2</span>, <span style="color: #a45bad;">1</span>, <span style="color: #a45bad;">3</span>, <span style="color: #a45bad;">3</span>, <span style="color: #a45bad;">4</span><span style="color: #bc6ec5;">]</span><span style="color: #4f97d7;">)</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">when using with '+=', the result may be unexpected</span>
&gt;&gt;&gt; <span style="color: #7590db;">a</span> = np.arange<span style="color: #4f97d7;">(</span><span style="color: #a45bad;">5</span><span style="color: #4f97d7;">)</span>
&gt;&gt;&gt; a<span style="color: #4f97d7;">[</span><span style="color: #bc6ec5;">[</span><span style="color: #a45bad;">0</span>,<span style="color: #a45bad;">0</span>,<span style="color: #a45bad;">2</span><span style="color: #bc6ec5;">]</span><span style="color: #4f97d7;">]</span>+=<span style="color: #a45bad;">1</span>
&gt;&gt;&gt; a
array<span style="color: #4f97d7;">(</span><span style="color: #bc6ec5;">[</span><span style="color: #a45bad;">1</span>, <span style="color: #a45bad;">1</span>, <span style="color: #a45bad;">3</span>, <span style="color: #a45bad;">3</span>, <span style="color: #a45bad;">4</span><span style="color: #bc6ec5;">]</span><span style="color: #4f97d7;">)</span> <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">though 0 appears twice, but it increases by 1</span>

</pre>
</div>
</div>
</div>
<div id="outline-container-org06f9b17" class="outline-3">
<h3 id="org06f9b17"><span class="section-number-3">1.7</span> bool slicing</h3>
<div class="outline-text-3" id="text-1-7">
</div>
<div id="outline-container-org2ebaff5" class="outline-4">
<h4 id="org2ebaff5"><span class="section-number-4">1.7.1</span> I.use a bool array that has the same shape with the original array</h4>
</div>
<div id="outline-container-orgb62a219" class="outline-4">
<h4 id="orgb62a219"><span class="section-number-4">1.7.2</span> Slicing on the first dim</h4>
<div class="outline-text-4" id="text-1-7-2">
<div class="org-src-container">
<pre class="src src-python">&gt;&gt;&gt; <span style="color: #7590db;">a</span> = np.arange<span style="color: #4f97d7;">(</span><span style="color: #a45bad;">12</span><span style="color: #4f97d7;">)</span>.reshape<span style="color: #4f97d7;">(</span><span style="color: #a45bad;">3</span>,<span style="color: #a45bad;">4</span><span style="color: #4f97d7;">)</span>
&gt;&gt;&gt; <span style="color: #7590db;">b</span> = a &gt; <span style="color: #a45bad;">4np</span>.vstack<span style="color: #4f97d7;">()</span>np.hstack<span style="color: #4f97d7;">()</span>
&gt;&gt;&gt; b                                          <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">b is a boolean with a's shape</span>
array<span style="color: #4f97d7;">(</span><span style="color: #bc6ec5;">[</span><span style="color: #2d9574;">[</span><span style="color: #a45bad;">False</span>, <span style="color: #a45bad;">False</span>, <span style="color: #a45bad;">False</span>, <span style="color: #a45bad;">False</span><span style="color: #2d9574;">]</span>,
       <span style="color: #2d9574;">[</span><span style="color: #a45bad;">False</span>,  <span style="color: #a45bad;">True</span>,  <span style="color: #a45bad;">True</span>,  <span style="color: #a45bad;">True</span><span style="color: #2d9574;">]</span>,
       <span style="color: #2d9574;">[</span> <span style="color: #a45bad;">True</span>,  <span style="color: #a45bad;">True</span>,  <span style="color: #a45bad;">True</span>,  <span style="color: #a45bad;">True</span><span style="color: #2d9574;">]</span><span style="color: #bc6ec5;">]</span><span style="color: #4f97d7;">)</span>
&gt;&gt;&gt; a<span style="color: #4f97d7;">[</span>b<span style="color: #4f97d7;">]</span>                                       <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">1d array with the selected elements</span>
array<span style="color: #4f97d7;">(</span><span style="color: #bc6ec5;">[</span> <span style="color: #a45bad;">5</span>,  <span style="color: #a45bad;">6</span>,  <span style="color: #a45bad;">7</span>,  <span style="color: #a45bad;">8</span>,  <span style="color: #a45bad;">9</span>, <span style="color: #a45bad;">10</span>, <span style="color: #a45bad;">11</span><span style="color: #bc6ec5;">]</span><span style="color: #4f97d7;">)</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">this one is frequently used in assigning values</span>
&gt;&gt;&gt; <span style="color: #7590db;">a</span><span style="color: #4f97d7;">[</span>b<span style="color: #4f97d7;">]</span> = <span style="color: #a45bad;">0</span>                                   <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">All elements of 'a' higher than 4 become 0</span>
&gt;&gt;&gt; a
array<span style="color: #4f97d7;">(</span><span style="color: #bc6ec5;">[</span><span style="color: #2d9574;">[</span><span style="color: #a45bad;">0</span>, <span style="color: #a45bad;">1</span>, <span style="color: #a45bad;">2</span>, <span style="color: #a45bad;">3</span><span style="color: #2d9574;">]</span>,
       <span style="color: #2d9574;">[</span><span style="color: #a45bad;">4</span>, <span style="color: #a45bad;">0</span>, <span style="color: #a45bad;">0</span>, <span style="color: #a45bad;">0</span><span style="color: #2d9574;">]</span>,
       <span style="color: #2d9574;">[</span><span style="color: #a45bad;">0</span>, <span style="color: #a45bad;">0</span>, <span style="color: #a45bad;">0</span>, <span style="color: #a45bad;">0</span><span style="color: #2d9574;">]</span><span style="color: #bc6ec5;">]</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org9c133d1" class="outline-4">
<h4 id="org9c133d1"><span class="section-number-4">1.7.3</span> For each dim, we can have a boolean filter, but the length of the filter must match the length of the targeted dim</h4>
<div class="outline-text-4" id="text-1-7-3">
<p>
#+begin<sub>src</sub> python
&gt;&gt;&gt; a = np.arange(12).reshape(3,4)
&gt;&gt;&gt; b1 = np.array([False,Trunp.vstack()np.hstack()e,True])             # first dim selection
&gt;&gt;&gt; b2 = np.array([True,False,True,False])       # second dim selection
a[b1,:]                                   # selecting rows
array([[ 4,  5,  6,  7],
       [ 8,  9, 10, 11]])
a[b1,b2]                                  # a weird thing to do
array([ 4, 10]) 
</p>
<pre class="example">
stack two 1d array to have a 2d array: stack two 1d array to have a 2d array: stack two 1d array to have a 2d array: stack two 1d array to have a 2d array: stack two 1d array to have a 2d array: stack two 1d array to have a 2d array: stack two 1d array to have a 2d array#+end_src
</pre>
</div>
</div>
</div>
<div id="outline-container-org4d19642" class="outline-3">
<h3 id="org4d19642"><span class="section-number-3">1.8</span> ix<sub>()</sub> function</h3>
<div class="outline-text-3" id="text-1-8">
</div>
<div id="outline-container-org6ea2bfa" class="outline-4">
<h4 id="org6ea2bfa"><span class="section-number-4">1.8.1</span> ix<sub>()</sub> can be used to combine different vectors in a way to generate n-tuple</h4>
<div class="outline-text-4" id="text-1-8-1">
</div>
<ol class="org-ol">
<li><a id="org84b24dd"></a>example: for vector a, b and c, we show all the combinations of them in a+b*c<br />
<div class="outline-text-5" id="text-1-8-1-1">
<div class="org-src-container">
<pre class="src src-python">&gt;&gt;&gt; <span style="color: #7590db;">a</span> = np.array<span style="color: #4f97d7;">(</span><span style="color: #bc6ec5;">[</span><span style="color: #a45bad;">2</span>,<span style="color: #a45bad;">3</span>,<span style="color: #a45bad;">4</span>,<span style="color: #a45bad;">5</span><span style="color: #bc6ec5;">]</span><span style="color: #4f97d7;">)</span>
&gt;&gt;&gt; <span style="color: #7590db;">b</span> = np.array<span style="color: #4f97d7;">(</span><span style="color: #bc6ec5;">[</span><span style="color: #a45bad;">8</span>,<span style="color: #a45bad;">5</span>,<span style="color: #a45bad;">4</span><span style="color: #bc6ec5;">]</span><span style="color: #4f97d7;">)</span>
&gt;&gt;&gt; <span style="color: #7590db;">c</span> = np.array<span style="color: #4f97d7;">(</span><span style="color: #bc6ec5;">[</span><span style="color: #a45bad;">5</span>,<span style="color: #a45bad;">4</span>,<span style="color: #a45bad;">6</span>,<span style="color: #a45bad;">8</span>,<span style="color: #a45bad;">3</span><span style="color: #bc6ec5;">]</span><span style="color: #4f97d7;">)</span>
&gt;&gt;&gt; <span style="color: #7590db;">ax</span>,<span style="color: #7590db;">bx</span>,<span style="color: #7590db;">cx</span> = np.ix_<span style="color: #4f97d7;">(</span>a,b,c<span style="color: #4f97d7;">)</span> <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">ax.shape= (4, 1, 1), bx.shape= (1, 3, 1), cx.shape= (1, 1, 5)</span>
&gt;&gt;&gt; <span style="color: #7590db;">result</span> = ax+bx*cx
&gt;&gt;&gt; result
array<span style="color: #4f97d7;">(</span><span style="color: #bc6ec5;">[</span><span style="color: #2d9574;">[</span><span style="color: #67b11d;">[</span><span style="color: #a45bad;">42</span>, <span style="color: #a45bad;">34</span>, <span style="color: #a45bad;">50</span>, <span style="color: #a45bad;">66</span>, <span style="color: #a45bad;">26</span><span style="color: #67b11d;">]</span>,
        <span style="color: #67b11d;">[</span><span style="color: #a45bad;">27</span>, <span style="color: #a45bad;">22</span>, <span style="color: #a45bad;">32</span>, <span style="color: #a45bad;">42</span>, <span style="color: #a45bad;">17</span><span style="color: #67b11d;">]</span>,
        <span style="color: #67b11d;">[</span><span style="color: #a45bad;">22</span>, <span style="color: #a45bad;">18</span>, <span style="color: #a45bad;">26</span>, <span style="color: #a45bad;">34</span>, <span style="color: #a45bad;">14</span><span style="color: #67b11d;">]</span><span style="color: #2d9574;">]</span>,
       <span style="color: #2d9574;">[</span><span style="color: #67b11d;">[</span><span style="color: #a45bad;">43</span>, <span style="color: #a45bad;">35</span>, <span style="color: #a45bad;">51</span>, <span style="color: #a45bad;">67</span>, <span style="color: #a45bad;">27</span><span style="color: #67b11d;">]</span>,
        <span style="color: #67b11d;">[</span><span style="color: #a45bad;">28</span>, <span style="color: #a45bad;">23</span>, <span style="color: #a45bad;">33</span>, <span style="color: #a45bad;">43</span>, <span style="color: #a45bad;">18</span><span style="color: #67b11d;">]</span>,
        <span style="color: #67b11d;">[</span><span style="color: #a45bad;">23</span>, <span style="color: #a45bad;">19</span>, <span style="color: #a45bad;">27</span>, <span style="color: #a45bad;">35</span>, <span style="color: #a45bad;">15</span><span style="color: #67b11d;">]</span><span style="color: #2d9574;">]</span>,
       <span style="color: #2d9574;">[</span><span style="color: #67b11d;">[</span><span style="color: #a45bad;">44</span>, <span style="color: #a45bad;">36</span>, <span style="color: #a45bad;">52</span>, <span style="color: #a45bad;">68</span>, <span style="color: #a45bad;">28</span><span style="color: #67b11d;">]</span>,
        <span style="color: #67b11d;">[</span><span style="color: #a45bad;">29</span>, <span style="color: #a45bad;">24</span>, <span style="color: #a45bad;">34</span>, <span style="color: #a45bad;">44</span>, <span style="color: #a45bad;">19</span><span style="color: #67b11d;">]</span>,
        <span style="color: #67b11d;">[</span><span style="color: #a45bad;">24</span>, <span style="color: #a45bad;">20</span>, <span style="color: #a45bad;">28</span>, <span style="color: #a45bad;">36</span>, <span style="color: #a45bad;">16</span><span style="color: #67b11d;">]</span><span style="color: #2d9574;">]</span>,
       <span style="color: #2d9574;">[</span><span style="color: #67b11d;">[</span><span style="color: #a45bad;">45</span>, <span style="color: #a45bad;">37</span>, <span style="color: #a45bad;">53</span>, <span style="color: #a45bad;">69</span>, <span style="color: #a45bad;">29</span><span style="color: #67b11d;">]</span>,
        <span style="color: #67b11d;">[</span><span style="color: #a45bad;">30</span>, <span style="color: #a45bad;">25</span>, <span style="color: #a45bad;">35</span>, <span style="color: #a45bad;">45</span>, <span style="color: #a45bad;">20</span><span style="color: #67b11d;">]</span>,
        <span style="color: #67b11d;">[</span><span style="color: #a45bad;">25</span>, <span style="color: #a45bad;">21</span>, <span style="color: #a45bad;">29</span>, <span style="color: #a45bad;">37</span>, <span style="color: #a45bad;">17</span><span style="color: #67b11d;">]</span><span style="color: #2d9574;">]</span><span style="color: #bc6ec5;">]</span><span style="color: #4f97d7;">)</span>
&gt;&gt;&gt; result<span style="color: #4f97d7;">[</span><span style="color: #a45bad;">3</span>,<span style="color: #a45bad;">2</span>,<span style="color: #a45bad;">4</span><span style="color: #4f97d7;">]</span> <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">third element in a, second element in b, and fourth element in c</span>
<span style="color: #a45bad;">17</span>
&gt;&gt;&gt; a<span style="color: #4f97d7;">[</span><span style="color: #a45bad;">3</span><span style="color: #4f97d7;">]</span>+b<span style="color: #4f97d7;">[</span><span style="color: #a45bad;">2</span><span style="color: #4f97d7;">]</span>*c<span style="color: #4f97d7;">[</span><span style="color: #a45bad;">4</span><span style="color: #4f97d7;">]</span>
<span style="color: #a45bad;">17</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">similar implementation to the previous one</span>
&gt;&gt;&gt; <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">ufunc_reduce</span><span style="color: #4f97d7;">(</span>ufct, *vectors<span style="color: #4f97d7;">)</span>:
...    <span style="color: #7590db;">vs</span> = np.ix_<span style="color: #4f97d7;">(</span>*vectors<span style="color: #4f97d7;">)</span>
...    <span style="color: #7590db;">r</span> = ufct.identity <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">np.add.identity =0, np.multiply.identity=1,...</span>
...    <span style="color: #4f97d7; font-weight: bold;">for</span> v <span style="color: #4f97d7; font-weight: bold;">in</span> vs:
...        <span style="color: #7590db;">r</span> = ufct<span style="color: #4f97d7;">(</span>r,v<span style="color: #4f97d7;">)</span>
...    <span style="color: #4f97d7; font-weight: bold;">return</span> r
ufunc_reduce<span style="color: #4f97d7;">(</span>np.add,a,b,c<span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div id="outline-container-org07b2155" class="outline-3">
<h3 id="org07b2155"><span class="section-number-3">1.9</span> reshape</h3>
<div class="outline-text-3" id="text-1-9">
</div>
<div id="outline-container-orgeef0216" class="outline-4">
<h4 id="orgeef0216"><span class="section-number-4">1.9.1</span> np.vstack(): stack two 1d array to have a 2d array</h4>
</div>
<div id="outline-container-orgb04067e" class="outline-4">
<h4 id="orgb04067e"><span class="section-number-4">1.9.2</span> np.hstack()</h4>
</div>
</div>
</div>
<div id="outline-container-org61ed82e" class="outline-2">
<h2 id="org61ed82e"><span class="section-number-2">2</span> Numpy sort</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org1fd0d29" class="outline-3">
<h3 id="org1fd0d29"><span class="section-number-3">2.1</span> numpy.sort(a, axis, kind, order)</h3>
<div class="outline-text-3" id="text-2-1">
</div>
<div id="outline-container-orge0e4cf0" class="outline-4">
<h4 id="orge0e4cf0"><span class="section-number-4">2.1.1</span> kind: {'quicksort', 'mergesort', 'heapsort', 'stable'}</h4>
</div>
</div>
<div id="outline-container-org014dc82" class="outline-3">
<h3 id="org014dc82"><span class="section-number-3">2.2</span> np.argsort(): return the index in the original array with ascending order</h3>
</div>
<div id="outline-container-orgb8def3b" class="outline-3">
<h3 id="orgb8def3b"><span class="section-number-3">2.3</span> numpy.lexsort(): sort by multiple keys</h3>
</div>
<div id="outline-container-org70fc691" class="outline-3">
<h3 id="org70fc691"><span class="section-number-3">2.4</span> </h3>
</div>
<div id="outline-container-org837b831" class="outline-3">
<h3 id="org837b831"><span class="section-number-3">2.5</span> arr.sort(axis):Sort an array in-place</h3>
</div>
<div id="outline-container-orgccccfdd" class="outline-3">
<h3 id="orgccccfdd"><span class="section-number-3">2.6</span> a[::-1]: reverse a</h3>
</div>
<div id="outline-container-org3cf8423" class="outline-3">
<h3 id="org3cf8423"><span class="section-number-3">2.7</span> adding/removing</h3>
<div class="outline-text-3" id="text-2-7">
</div>
<div id="outline-container-org67c56f2" class="outline-4">
<h4 id="org67c56f2"><span class="section-number-4">2.7.1</span> np.append(arr,values): Append values to the end of an array. A copy of `arr` with `values` appended to `axis`</h4>
</div>
<div id="outline-container-org004dfc2" class="outline-4">
<h4 id="org004dfc2"><span class="section-number-4">2.7.2</span> np.insert(arr, position, value)</h4>
</div>
<div id="outline-container-org7d8b66a" class="outline-4">
<h4 id="org7d8b66a"><span class="section-number-4">2.7.3</span> np.delete(arr, obj):Return a new array with sub-arrays along an axis deleted. For a one dimensional array, this returns those entries not returned by `arr[obj]`.</h4>
</div>
</div>
</div>


<div id="outline-container-orge5c9577" class="outline-2">
<h2 id="orge5c9577"><span class="section-number-2">3</span> API</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-orga396980" class="outline-3">
<h3 id="orga396980"><span class="section-number-3">3.1</span> numpy.array(object, dtype = None, copy = True, order = None, subok = False, ndmin = 0)</h3>
<div class="outline-text-3" id="text-3-1">
</div>
<div id="outline-container-org4b66c86" class="outline-4">
<h4 id="org4b66c86"><span class="section-number-4">3.1.1</span> object:any object exposing the array interface, or any (nested) sequence.</h4>
</div>
<div id="outline-container-orgdeca95c" class="outline-4">
<h4 id="orgdeca95c"><span class="section-number-4">3.1.2</span> order: C-&gt;rows, F-&gt;column, K:default</h4>
</div>
<div id="outline-container-org8914b5c" class="outline-4">
<h4 id="org8914b5c"><span class="section-number-4">3.1.3</span> ndmin: specified the dim of the returned array</h4>
</div>
</div>
</div>







<div id="outline-container-org5731716" class="outline-2">
<h2 id="org5731716"><span class="section-number-2">4</span> Numpy IO</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org0fd5693" class="outline-3">
<h3 id="org0fd5693"><span class="section-number-3">4.1</span> np.load(), np.save(file, arr): save to binary</h3>
</div>

<div id="outline-container-orgd1594d3" class="outline-3">
<h3 id="orgd1594d3"><span class="section-number-3">4.2</span> np.savez(file, arr<sub>1</sub>, arr<sub>2</sub>): write multiple arrays with compression</h3>
</div>

<div id="outline-container-org7e6e513" class="outline-3">
<h3 id="org7e6e513"><span class="section-number-3">4.3</span> np.loadtxt(), np.savetxt(): load and save to text</h3>
</div>
</div>





<div id="outline-container-orgba8004f" class="outline-2">
<h2 id="orgba8004f"><span class="section-number-2">5</span> June 13, 2021</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-org7acf3f1" class="outline-3">
<h3 id="org7acf3f1"><span class="section-number-3">5.1</span> decorator:</h3>
<div class="outline-text-3" id="text-5-1">
</div>
<div id="outline-container-org8458a9e" class="outline-4">
<h4 id="org8458a9e"><span class="section-number-4">5.1.1</span> Rule-of-thumb: the decorator must be callable, or any object that has `_<sub>call</sub>_<sub>()</sub>` method</h4>
</div>
<div id="outline-container-org4b9a202" class="outline-4">
<h4 id="org4b9a202"><span class="section-number-4">5.1.2</span> For example: decorator can be a function, partial function or a class with `_<sub>call</sub>_<sub>()</sub>` method</h4>
</div>
<div id="outline-container-org43e2b42" class="outline-4">
<h4 id="org43e2b42"><span class="section-number-4">5.1.3</span> It is used add extract functionality to an existing function before or after the function</h4>
<div class="outline-text-4" id="text-5-1-3">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">my_decorator</span><span style="color: #4f97d7;">(</span>func<span style="color: #4f97d7;">)</span>:  
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">wrapper</span><span style="color: #4f97d7;">()</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'wrapper of decorator'</span><span style="color: #4f97d7;">)</span>  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#9312;&#36825;&#37324;&#20570;&#19968;&#36890;&#25805;&#20316;</span>
        func<span style="color: #4f97d7;">()</span>  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#9313;&#35843;&#29992;&#21407;&#20989;&#25968;</span>
    <span style="color: #4f97d7; font-weight: bold;">return</span> wrapper  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#9314;&#36820;&#22238;&#20869;&#37096;&#20989;&#25968;&#23545;&#35937;</span>

<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">greet</span><span style="color: #4f97d7;">()</span>:
    <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'hello world'</span><span style="color: #4f97d7;">)</span>

<span style="color: #7590db;">greet</span> = my_decorator<span style="color: #4f97d7;">(</span>greet<span style="color: #4f97d7;">)</span>  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#21464;&#37327; greet &#25351;&#21521;&#20102;&#20869;&#37096;&#20989;&#25968; wrapper()</span>
greet<span style="color: #4f97d7;">()</span>  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#35843;&#29992; greet() &#30456;&#24403;&#20110;&#25191;&#34892;&#20869;&#37096;&#20989;&#25968;wrapper</span>

<span style="color: #ce537a; font-weight: bold;">@my_decorator</span>  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">@&#35821;&#27861;&#31958;&#65292;&#30456;&#24403;&#20110;greet1 = my_decorator(greet1)</span>
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">greet1</span><span style="color: #4f97d7;">()</span>:    
    <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'hello world'</span><span style="color: #4f97d7;">)</span> 
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">timer</span><span style="color: #4f97d7;">(</span>func<span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">wrapper</span><span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span>:
        <span style="color: #7590db;">start</span> = time.time<span style="color: #4f97d7;">()</span>
        func<span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span> <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#27492;&#22788;&#25343;&#21040;&#20102;&#34987;&#35013;&#39280;&#30340;&#20989;&#25968;func</span>
        time.sleep<span style="color: #4f97d7;">(</span><span style="color: #a45bad;">2</span><span style="color: #4f97d7;">)</span><span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#27169;&#25311;&#32791;&#26102;&#25805;&#20316;</span>
        <span style="color: #4f97d7;">long</span> = time.time<span style="color: #4f97d7;">()</span> - start
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>f<span style="color: #2d9574;">'&#20849;&#32791;&#26102;{long}&#31186;&#12290;'</span><span style="color: #4f97d7;">)</span>
    <span style="color: #4f97d7; font-weight: bold;">return</span> wrapper <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#36820;&#22238;&#20869;&#23618;&#20989;&#25968;&#30340;&#24341;&#29992;</span>

<span style="color: #ce537a; font-weight: bold;">@timer</span>
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">add</span><span style="color: #4f97d7;">(</span>a, b<span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>a+b<span style="color: #4f97d7;">)</span>

add<span style="color: #4f97d7;">(</span><span style="color: #a45bad;">1</span>, <span style="color: #a45bad;">2</span><span style="color: #4f97d7;">)</span> <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#27491;&#24120;&#35843;&#29992;add</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#27169;&#22359;&#21152;&#36733; -&gt;&gt; &#36935;&#21040;@&#65292;&#25191;&#34892;timer&#20989;&#25968;&#65292;&#20256;&#20837;add&#20989;&#25968; -&gt;&gt; &#29983;&#25104;timer.&lt;locals&gt;.wrapper</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#20989;&#25968;&#24182;&#21629;&#21517;&#20026;add&#65292;&#20854;&#23454;&#26159;&#35206;&#30422;&#20102;&#21407;&#21516;&#21517;&#20989;&#25968; -&gt;&gt; &#35843;&#29992;add(1, 2) -&gt;&gt; &#21435;&#25191;&#34892;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">timer.&lt;locals&gt;.wrapper(1, 2) -&gt;&gt; wrapper&#20869;&#37096;&#25345;&#26377;&#21407;add&#20989;&#25968;&#24341;&#29992;(func)&#65292;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#35843;&#29992;func(1, 2) -&gt;&gt;&#32487;&#32493;&#25191;&#34892;&#23436;wrapper&#20989;&#25968;</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">test1</span><span style="color: #4f97d7;">(</span>func<span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"enter test1"</span><span style="color: #4f97d7;">)</span>

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">wrapper1</span><span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'wrapper, before test1 ...'</span><span style="color: #4f97d7;">)</span>
        func<span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'wrapper, after test1 ...'</span><span style="color: #4f97d7;">)</span>
    <span style="color: #4f97d7; font-weight: bold;">return</span> wrapper1 <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#36820;&#22238;&#20869;&#23618;&#20989;&#25968;&#30340;&#24341;&#29992;</span>

<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">test2</span><span style="color: #4f97d7;">(</span>func<span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"%s"</span> %<span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"enter test2"</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">wrapper2</span><span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'wrapper2, before test2 ...'</span><span style="color: #4f97d7;">)</span>
        func<span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'wrapper, after test2 ...'</span><span style="color: #4f97d7;">)</span>
    <span style="color: #4f97d7; font-weight: bold;">return</span> wrapper2 <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#36820;&#22238;&#20869;&#23618;&#20989;&#25968;&#30340;&#24341;&#29992;</span>

<span style="color: #ce537a; font-weight: bold;">@test2</span>
<span style="color: #ce537a; font-weight: bold;">@test1</span>
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">add</span><span style="color: #4f97d7;">(</span>a, b<span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'execute original function'</span>, a+b<span style="color: #4f97d7;">)</span>

add<span style="color: #4f97d7;">(</span><span style="color: #a45bad;">1</span>, <span style="color: #a45bad;">2</span><span style="color: #4f97d7;">)</span> <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#27491;&#24120;&#35843;&#29992;add</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">enter test1</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">enter test2</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">wrapper2, before test2 ...</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">wrapper1, before test1 ...</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">execute original function 3</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">wrapper1, after test1 ...</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">wrapper2, after test2 ...</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">1.&#20195;&#30721;&#30340;&#25191;&#34892;&#39034;&#24207;&#26159;&#20174;&#19978;&#24448;&#19979;&#65292;&#24403;&#36935;&#21040;@test2&#26102;&#65292;&#23427;&#30340;&#19979;&#26041;(@test1(add(a,b)))&#24182;&#38750;&#19968;&#20010;&#20989;&#25968;&#65292;&#26080;&#27861;&#36827;&#34892;&#35013;&#39280;&#65307;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">2.&#25509;&#30528; @test1 &#20250;&#23545;add()&#36827;&#34892;&#35013;&#39280;&#65292;&#36820;&#22238;&#30340;&#26159; add = test1(add) = wrapper1;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">3.&#31532;&#19968;&#27425;&#35013;&#39280;&#32467;&#26463;&#65292;&#27492;&#26102;@test2&#19979;&#26041;&#26159;&#19968;&#20010;&#20989;&#25968;&#20102;&#65292;&#21363;&#24050;&#26159;wrapper1&#30340;&#24341;&#29992;&#65292;&#21516;&#29702;add = test2(wrapper1) = wrapper2&#65307;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">4.&#27492;&#26102;&#65292;&#20004;&#20010;&#35013;&#39280;&#22120;&#37117;&#24050;&#32463;&#35013;&#39280;&#23436;&#25104;&#12290;add()&#36827;&#34892;&#35843;&#29992;&#26102;&#30340;&#39034;&#24207;&#26159; &#35843;&#29992;@test2&#20013;&#30340;wrapper2&#65292;&#36816;&#34892;&#20854;&#20013;&#30340;func()&#65292;&#22312;func()&#20013;&#35843;&#29992;wrapper1&#65292;&#36816;&#34892;&#20854;&#20013;&#30340;func()(&#21363;&#36816;&#34892;wrapper1&#65289;&#25351;&#21521;&#21407;&#20808;&#30340;add()&#12290;</span>


<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">explain: &#22810;&#20010;&#35013;&#39280;&#22120;&#25191;&#34892;&#39034;&#24207;&#26159;&#65306;&#20174;&#26368;&#22806;&#23618;&#19968;&#20010;&#35013;&#39280;&#22120;&#24320;&#22987;&#65292;&#25191;&#34892;&#21040;&#31532;&#19968;&#20010;&#35013;&#39280;&#22120;&#65292;&#20877;&#25191;&#34892;&#20989;&#25968;&#26412;&#36523;&#65292;&#20877;&#25191;&#34892;&#20869;&#23618;&#35013;&#39280;&#22120;&#65292;&#20877;&#25191;&#34892;&#22806;&#23618;&#35013;&#39280;&#22120;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">0.add = test2(test1(add)), since test1(add) is not a function now, so decorate the inner one first</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">1.add = test1(add)=wrapper1=test1.&lt;locals&gt;.wrapper1</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">2.add = test2(wrapper1)=wrapper2 = test2.&lt;locals&gt;.wrapper2</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">3.run add, execute test2(wrapper1), namely, run wrapper2, print('before test2'), execute wrapper1</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">4.execute wrapper1, print('before test1'), execute func = add, add(*args, **kwargs)</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">5.print('after test1'), finish wrapper1, print('after test1'), finish</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgf4a7ed1" class="outline-3">
<h3 id="orgf4a7ed1"><span class="section-number-3">5.2</span> Decorate a function with parameters</h3>
<div class="outline-text-3" id="text-5-2">
</div>
<div id="outline-container-org19c5c78" class="outline-4">
<h4 id="org19c5c78"><span class="section-number-4">5.2.1</span> parameters are passed into the inner wrapper() function</h4>
<div class="outline-text-4" id="text-5-2-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">my_decorator</span><span style="color: #4f97d7;">(</span>func<span style="color: #4f97d7;">)</span>: <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">the wrappee is passed into func</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">wrapper</span><span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span>:
        pritn<span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'wrapper of decorator'</span><span style="color: #4f97d7;">)</span> <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">common operation before the func</span>
        func<span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span> <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">arguments are passed into the func here</span>
    <span style="color: #4f97d7; font-weight: bold;">return</span> wrapper <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">return the inner function</span>

<span style="color: #ce537a; font-weight: bold;">@my_decorator</span>
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">greet</span><span style="color: #4f97d7;">(</span>message<span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>message<span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orga043be0" class="outline-3">
<h3 id="orga043be0"><span class="section-number-3">5.3</span> Decorator with function</h3>
<div class="outline-text-3" id="text-5-3">
</div>
<div id="outline-container-orgc803f63" class="outline-4">
<h4 id="orgc803f63"><span class="section-number-4">5.3.1</span> The decorator is allowed to have arguments</h4>
<div class="outline-text-4" id="text-5-3-1">
<div class="org-src-container">
<pre class="src src-python">    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">repeat</span><span style="color: #4f97d7;">(</span>num<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">my_decorator</span><span style="color: #4f97d7;">(</span>func<span style="color: #4f97d7;">)</span>:
            <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">wrapper</span><span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span>:
                <span style="color: #4f97d7; font-weight: bold;">for</span> i <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">range</span><span style="color: #4f97d7;">(</span>num<span style="color: #4f97d7;">)</span>:
                    <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'wrapper of decorator)</span>
<span style="color: #2d9574;">                    func(*args, **kwargs)</span>
<span style="color: #2d9574;">            return wrapper</span>
<span style="color: #2d9574;">        return my_decorator</span>

<span style="color: #2d9574;">    @repeat</span>
<span style="color: #2d9574;">    def greet(message):</span>
<span style="color: #2d9574;">        print(message)</span>


<span style="color: #2d9574;">    def type_decorator(**kwargs):</span>
<span style="color: #2d9574;">        """ check the attr of an instance"""</span>
<span style="color: #2d9574;">        def decorator(cls):</span>
<span style="color: #2d9574;">            for key, value in kwargs.item():</span>
<span style="color: #2d9574;">                setattr(cls, key, TypeAssertion(key, value))</span>
<span style="color: #2d9574;">            return cls</span>
<span style="color: #2d9574;">        return decorator</span>

<span style="color: #2d9574;">    @type_decorator(brand=str, shares=int, price=float)</span>
<span style="color: #2d9574;">    class Stock:</span>
<span style="color: #2d9574;">        def __init__(self, brand, shares, price):</span>
<span style="color: #2d9574;">            self.brand = brand</span>
<span style="color: #2d9574;">            self.shares = shares</span>
<span style="color: #2d9574;">            self.price = price</span>

<span style="color: #2d9574;">   # it is equal to type_decorator(brand=str, shares=int, price=float)(Stock)</span>

<span style="color: #2d9574;"> @decorator_1(param_1)</span>
<span style="color: #2d9574;"> @decorator_2(param_2)</span>
<span style="color: #2d9574;">def func(*args, **kwargs):</span>
<span style="color: #2d9574;">  pass</span>
<span style="color: #2d9574;"># which is equal to @decorator_1(param_1)(decorator_2(param_2)(func)                    </span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org6d6861b" class="outline-4">
<h4 id="org6d6861b"><span class="section-number-4">5.3.2</span> Keep the metadata of the wrappee function</h4>
<div class="outline-text-4" id="text-5-3-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> functools

<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">my_decorator</span><span style="color: #4f97d7;">(</span>func<span style="color: #4f97d7;">)</span>:
    <span style="color: #ce537a; font-weight: bold;">@functools.wraps</span><span style="color: #4f97d7;">(</span>func<span style="color: #4f97d7;">)</span> <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">for copying the metadata of func to the wrapper function</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">wrapper</span><span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"wrapper of decorator"</span><span style="color: #4f97d7;">)</span>
        func<span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span>
    <span style="color: #4f97d7; font-weight: bold;">return</span> wrapper

<span style="color: #ce537a; font-weight: bold;">@my_decorator</span>
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">greet</span><span style="color: #4f97d7;">(</span>message<span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>message<span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-org4de9167" class="outline-3">
<h3 id="org4de9167"><span class="section-number-3">5.4</span> A class decorator for functions</h3>
<div class="outline-text-3" id="text-5-4">
</div>
<ol class="org-ol">
<li><a id="orgf999047"></a>it depends on the `_<sub>cal</sub>_<sub>()</sub>`, whenever invoke the class to create a instance, the `_<sub>call</sub>__` will be executed<br /></li>
<li><a id="org325367a"></a>the class decorator must implement the `_<sub>call</sub>__` and `_<sub>init</sub>__` method<br />
<ol class="org-ol">
<li><a id="orgdfa4313"></a>`_<sub>init</sub>__`: is for receiving the wrappee functions<br /></li>
<li><a id="org480551b"></a>`_<sub>call</sub>__`: is for the decoration code and func invoking, the same as the `wrapper function<br /></li>
</ol>
</li>
</ol>
<div id="outline-container-org78cdd1e" class="outline-4">
<h4 id="org78cdd1e"><span class="section-number-4">5.4.1</span> class decorator without arguments</h4>
<div class="outline-text-4" id="text-5-4-1">
<div class="org-src-container">
<pre class="src src-python"> <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Count</span>:
     <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, func<span style="color: #4f97d7;">)</span>:
         <span style="color: #4f97d7; font-weight: bold;">self</span>.func=func
         <span style="color: #4f97d7; font-weight: bold;">self</span>.num_calls=<span style="color: #a45bad;">0</span>
     <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__call__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, *args, **kwargs<span style="color: #4f97d7;">)</span>:
         <span style="color: #4f97d7; font-weight: bold;">self</span>.num_calls +=<span style="color: #a45bad;">1</span>
         <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">self</span>.func<span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span>

 <span style="color: #ce537a; font-weight: bold;">@Count</span>
 <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">example</span><span style="color: #4f97d7;">()</span>:
     <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'hello'</span><span style="color: #4f97d7;">)</span>
<span style="color: #2aa1ae; background-color: #292e34;">#### </span><span style="color: #2aa1ae; background-color: #292e34;">another example</span>
<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">logger</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">object</span><span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>,func<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">self</span>.func = func
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__call__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, *args, **kwargs<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'This is the decoration code'</span><span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7; font-weight: bold;">return</span>  <span style="color: #4f97d7; font-weight: bold;">self</span>.func<span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span>

<span style="color: #ce537a; font-weight: bold;">@logger</span>
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">say</span><span style="color: #4f97d7;">(</span>message<span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>message<span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org9a7df8e" class="outline-4">
<h4 id="org9a7df8e"><span class="section-number-4">5.4.2</span> class decorator with arguments</h4>
<div class="outline-text-4" id="text-5-4-2">
</div>
<ol class="org-ol">
<li><a id="orgb649238"></a>`_<sub>init</sub>__`: is for receiving args for the class decorator<br /></li>
<li><a id="orgd83f402"></a>`_<sub>call</sub>__`: is for the wrappee function, and implement the decoration code<br />
<div class="outline-text-6" id="text-5-4-2-0-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">logger</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">object</span><span style="color: #4f97d7;">)</span>: <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">a class decorator with arguments</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, level=<span style="color: #2d9574;">'INFO'</span><span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">self</span>.level = level
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__call__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, func<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">wrapper</span><span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span>:
            <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'decoration is here'</span><span style="color: #4f97d7;">)</span>
            func<span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7; font-weight: bold;">return</span> wrapper
<span style="color: #ce537a; font-weight: bold;">@logger</span><span style="color: #4f97d7;">(</span>level=<span style="color: #2d9574;">'WARNING'</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">say</span><span style="color: #4f97d7;">(</span>message<span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>message<span style="color: #4f97d7;">)</span>


<span style="color: #2aa1ae; background-color: #292e34;">### </span><span style="color: #2aa1ae; background-color: #292e34;">another example</span>
<span style="color: #4f97d7; font-weight: bold;">import</span> time
<span style="color: #4f97d7; font-weight: bold;">import</span> functools

<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">DelayFunc</span>:
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, duration, func<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">self</span>.duration = duration
        <span style="color: #4f97d7; font-weight: bold;">self</span>.func = func
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__call__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, *args, **kwargs<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>f<span style="color: #2d9574;">'waiting for {self.duration} seconds'</span><span style="color: #4f97d7;">)</span>
        time.sleep
        <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">self</span>.func<span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">eager_call</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, *args, **kwargs<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">self</span>.func<span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span>

<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">delay</span><span style="color: #4f97d7;">(</span>duration<span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">return</span> functools.partial<span style="color: #4f97d7;">(</span>DelayFunc, duration<span style="color: #4f97d7;">)</span>

<span style="color: #ce537a; font-weight: bold;">@delay</span><span style="color: #4f97d7;">(</span>duration=<span style="color: #a45bad;">2</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">add</span><span style="color: #4f97d7;">(</span>a,b<span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">return</span> a+b
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">delay(duration=2) returns a a partial function</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">call this partial function with add(a, b)</span>
</pre>
</div>
</div>
</li>
</ol>
</div>
<div id="outline-container-org0e3deff" class="outline-4">
<h4 id="org0e3deff"><span class="section-number-4">5.4.3</span> decorator for a class</h4>
<div class="outline-text-4" id="text-5-4-3">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">use a decorator for singleton pattern</span>

<span style="color: #7590db;">instance</span> =<span style="color: #4f97d7;">{}</span>
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">singleton</span><span style="color: #4f97d7;">(</span>cls<span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">get_instance</span><span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span>:
        <span style="color: #7590db;">cls_name</span> = cls.<span style="color: #4f97d7;">__name__</span>
        <span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7; font-weight: bold;">not</span> cls_name <span style="color: #4f97d7; font-weight: bold;">in</span> instance:
            <span style="color: #7590db;">instance</span> = cls<span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span>
            <span style="color: #7590db;">instance</span><span style="color: #4f97d7;">[</span>cls_name<span style="color: #4f97d7;">]</span> = instance
        <span style="color: #4f97d7; font-weight: bold;">return</span> instance<span style="color: #4f97d7;">[</span>cls_name<span style="color: #4f97d7;">]</span>
    <span style="color: #4f97d7; font-weight: bold;">return</span> get_instance

<span style="color: #ce537a; font-weight: bold;">@singleton</span>
<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">User</span>:
    <span style="color: #7590db;">_instance</span> = <span style="color: #a45bad;">None</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, name<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">self</span>.name = name

</pre>
</div>
</div>
</div>

<div id="outline-container-org3ae4e41" class="outline-4">
<h4 id="org3ae4e41"><span class="section-number-4">5.4.4</span> Nested decorator</h4>
<div class="outline-text-4" id="text-5-4-4">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #ce537a; font-weight: bold;">@decorator_1</span>
<span style="color: #ce537a; font-weight: bold;">@decorator_2</span>
<span style="color: #ce537a; font-weight: bold;">@decorator_3</span>
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">func</span><span style="color: #4f97d7;">()</span>:
    <span style="color: #4f97d7; font-weight: bold;">pass</span> 
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org8a11705" class="outline-3">
<h3 id="org8a11705"><span class="section-number-3">5.5</span> use cases</h3>
<div class="outline-text-3" id="text-5-5">
</div>
<div id="outline-container-org622502c" class="outline-4">
<h4 id="org622502c"><span class="section-number-4">5.5.1</span> ID authentication</h4>
<div class="outline-text-4" id="text-5-5-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> functools
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">authentication</span><span style="color: #4f97d7;">(</span>func<span style="color: #4f97d7;">)</span>
    <span style="color: #ce537a; font-weight: bold;">@functools.wraps</span><span style="color: #4f97d7;">(</span>func<span style="color: #4f97d7;">)</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">wrapper</span><span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span>:
        <span style="color: #7590db;">request</span> = args<span style="color: #4f97d7;">[</span><span style="color: #a45bad;">0</span><span style="color: #4f97d7;">]</span>
        <span style="color: #4f97d7; font-weight: bold;">if</span> check_user_logged_in<span style="color: #4f97d7;">(</span>request<span style="color: #4f97d7;">)</span>:
            <span style="color: #4f97d7; font-weight: bold;">return</span> func<span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span>
    <span style="color: #4f97d7; font-weight: bold;">return</span> wrapper

<span style="color: #ce537a; font-weight: bold;">@authentication</span>
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">post_comment</span><span style="color: #4f97d7;">(</span>request,...<span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">pass</span> 
</pre>
</div>
</div>
</div>

<div id="outline-container-orgced5a77" class="outline-4">
<h4 id="orgced5a77"><span class="section-number-4">5.5.2</span> timing execution</h4>
<div class="outline-text-4" id="text-5-5-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> time
<span style="color: #4f97d7; font-weight: bold;">import</span> functools
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">log_execution_time</span><span style="color: #4f97d7;">(</span>func<span style="color: #4f97d7;">)</span>:
    <span style="color: #ce537a; font-weight: bold;">@functools.wraps</span><span style="color: #4f97d7;">(</span>func<span style="color: #4f97d7;">)</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">wrapper</span><span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span>:
        <span style="color: #7590db;">start</span> = time.perf_count<span style="color: #4f97d7;">()</span>
        <span style="color: #7590db;">res</span> = func<span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span>
    <span style="color: #4f97d7; font-weight: bold;">return</span> wrapper

<span style="color: #ce537a; font-weight: bold;">@log_execution_time</span>
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">calculate_similarity</span><span style="color: #4f97d7;">(</span>times<span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">pass</span> 
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdb982c3" class="outline-4">
<h4 id="orgdb982c3"><span class="section-number-4">5.5.3</span> Check the validity of input or attrs</h4>
<div class="outline-text-4" id="text-5-5-3">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> functools
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">validation_check</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">input</span><span style="color: #4f97d7;">)</span>:
    <span style="color: #ce537a; font-weight: bold;">@functools.wraps</span><span style="color: #4f97d7;">(</span>func<span style="color: #4f97d7;">)</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">wrapper</span><span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">pass</span>

<span style="color: #ce537a; font-weight: bold;">@validation_check</span>
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">neural_network_training</span><span style="color: #4f97d7;">(</span>param1, param2,...<span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">pass</span> 
</pre>
</div>
</div>
</div>

<div id="outline-container-orgad61da4" class="outline-4">
<h4 id="orgad61da4"><span class="section-number-4">5.5.4</span> logging</h4>
<div class="outline-text-4" id="text-5-5-4">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> functools
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">logit</span><span style="color: #4f97d7;">(</span>func<span style="color: #4f97d7;">)</span>:
    <span style="color: #ce537a; font-weight: bold;">@functools.wraps</span><span style="color: #4f97d7;">(</span>func<span style="color: #4f97d7;">)</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">wrapper</span><span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">pass</span>
    <span style="color: #4f97d7; font-weight: bold;">return</span> wrapper

<span style="color: #ce537a; font-weight: bold;">@logit</span>
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">addition_func</span><span style="color: #4f97d7;">(</span>x<span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">pass</span> 
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org535470f" class="outline-3">
<h3 id="org535470f"><span class="section-number-3">5.6</span> Decorator with parameters</h3>
<div class="outline-text-3" id="text-5-6">
</div>
<div id="outline-container-orgeae5d00" class="outline-4">
<h4 id="orgeae5d00"><span class="section-number-4">5.6.1</span> If the decorator has input parameters</h4>
<div class="outline-text-4" id="text-5-6-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> functools

<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">fixture2</span><span style="color: #4f97d7;">(</span>args<span style="color: #4f97d7;">)</span>: <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">args are for the decorator fixture2</span>
     <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">decorator</span><span style="color: #4f97d7;">(</span>func<span style="color: #4f97d7;">)</span>:
         <span style="color: #ce537a; font-weight: bold;">@functools.wraps</span><span style="color: #4f97d7;">(</span>func<span style="color: #4f97d7;">)</span>:
         <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">wrapper</span><span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span>:
             func<span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span>
         <span style="color: #4f97d7; font-weight: bold;">return</span> wrapper
    <span style="color: #4f97d7; font-weight: bold;">return</span> decorator

<span style="color: #ce537a; font-weight: bold;">@fixture2</span>
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">now</span><span style="color: #4f97d7;">()</span>:
    <span style="color: #4f97d7; font-weight: bold;">pass</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">euqal to: now = fixture2('parameter')(now)</span>
<span style="color: #ce537a; font-weight: bold;">@fixture2</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'parameter'</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">now</span><span style="color: #4f97d7;">()</span>:
    <span style="color: #4f97d7; font-weight: bold;">pass</span> 

</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org25778b2" class="outline-3">
<h3 id="org25778b2"><span class="section-number-3">5.7</span> functools.wraps for decorator</h3>
<div class="outline-text-3" id="text-5-7">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">wraps</span><span style="color: #4f97d7;">(</span>wrapped, assigned = WRAPPER_ASSIGNMENTS, updated = WRAPPER_UPDATES<span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">return</span> partial<span style="color: #4f97d7;">(</span>update_wrapper, wrapped=wrapped, assigned=assigned, updated=updated<span style="color: #4f97d7;">)</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">WRAPPER_ASSIGNMENTS is the properties that copied to the inneer function </span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org0a548c0" class="outline-3">
<h3 id="org0a548c0"><span class="section-number-3">5.8</span> property</h3>
<div class="outline-text-3" id="text-5-8">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Student</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">object</span><span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>,name<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">self</span>.name = name
        <span style="color: #4f97d7; font-weight: bold;">self</span>._age = <span style="color: #a45bad;">None</span> <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">do not set name here</span>
    @ <span style="color: #4f97d7;">property</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">age</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span><span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">self</span>._age
    <span style="color: #ce537a; font-weight: bold;">@age.setter</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">age</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, value<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7; font-weight: bold;">not</span> <span style="color: #4f97d7;">isinstance</span><span style="color: #4f97d7;">(</span>value, <span style="color: #4f97d7;">int</span><span style="color: #4f97d7;">)</span>:
            <span style="color: #4f97d7; font-weight: bold;">raise</span> <span style="color: #ce537a; font-weight: bold;">ValueError</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'invalid input, age must be int'</span><span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7; font-weight: bold;">self</span>._age = value
    <span style="color: #ce537a; font-weight: bold;">@age.deleter</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">age</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span><span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">del</span> <span style="color: #4f97d7; font-weight: bold;">self</span>._age

</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orge168b4f" class="outline-2">
<h2 id="orge168b4f"><span class="section-number-2">6</span> June 15, 2021</h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-org0374647" class="outline-3">
<h3 id="org0374647"><span class="section-number-3">6.1</span> How to replace a instance method</h3>
<div class="outline-text-3" id="text-6-1">
</div>
<div id="outline-container-orge7dd08e" class="outline-4">
<h4 id="orge7dd08e"><span class="section-number-4">6.1.1</span> idea 1: replace the byte code&#x2013;dangerous</h4>
<div class="outline-text-4" id="text-6-1-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">People</span>:
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">speak</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span><span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'hello'</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">speak</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span><span style="color: #4f97d7;">)</span>: <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">this is a function</span>

<span style="color: #7590db;">p</span> = People<span style="color: #4f97d7;">()</span>
<span style="color: #7590db;">p.speak.im_func.func_code</span> = speak.func_code
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">This idea will change all instance method</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-org4d2fd7b" class="outline-4">
<h4 id="org4d2fd7b"><span class="section-number-4">6.1.2</span> idea 2: use the types method - safe</h4>
<div class="outline-text-4" id="text-6-1-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> types
<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">People</span>:
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">speak</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span><span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'hello'</span><span style="color: #4f97d7;">)</span>
<span style="color: #7590db;">p</span> = People<span style="color: #4f97d7;">()</span>
<span style="color: #7590db;">p.speak</span> = types.MethodTyps<span style="color: #4f97d7;">(</span>speak, p<span style="color: #4f97d7;">)</span>
p.speak<span style="color: #4f97d7;">()</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-orgbaa6944" class="outline-4">
<h4 id="orgbaa6944"><span class="section-number-4">6.1.3</span> How to invoke a function</h4>
<div class="outline-text-4" id="text-6-1-3">
</div>
<ol class="org-ol">
<li><a id="org561c64c"></a>method 1: put the method in a class, and make it a static method<br />
<div class="outline-text-5" id="text-6-1-3-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> sys
<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Task</span>:
    <span style="color: #ce537a; font-weight: bold;">@staicmethod</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">pre_task</span><span style="color: #4f97d7;">()</span>:
<span style="color: #7590db;">argvs</span> = sys.argv<span style="color: #4f97d7;">[</span><span style="color: #a45bad;">1</span>:<span style="color: #4f97d7;">]</span>
<span style="color: #7590db;">task</span> = Task<span style="color: #4f97d7;">()</span>
<span style="color: #4f97d7; font-weight: bold;">for</span> action <span style="color: #4f97d7; font-weight: bold;">in</span> argvs:
    <span style="color: #7590db;">func</span> = <span style="color: #4f97d7;">getattr</span><span style="color: #4f97d7;">(</span>task, action<span style="color: #4f97d7;">)</span> <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">work for static method. or getattr(Task, action)</span>
    <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">func_alternative = Task.__dict__.get(action) # the method belongs to the Task instead of task instance</span>
    func<span style="color: #4f97d7;">()</span>
</pre>
</div>
</div>
</li>

<li><a id="org732cf4f"></a>use the global() to retrieve the function<br />
<div class="outline-text-5" id="text-6-1-3-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> sys
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">pre_task</span><span style="color: #4f97d7;">()</span>:
    <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'hello'</span><span style="color: #4f97d7;">)</span>
<span style="color: #7590db;">action</span> = <span style="color: #2d9574;">'pre_task'</span>
<span style="color: #7590db;">action</span> = <span style="color: #4f97d7;">globals</span><span style="color: #4f97d7;">()</span>.get<span style="color: #4f97d7;">(</span>action<span style="color: #4f97d7;">)()</span>
</pre>
</div>
</div>
</li>

<li><a id="org8524777"></a>use the operator.attrgetter()<br />
<div class="outline-text-5" id="text-6-1-3-3">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> operator
<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">People</span><span style="color: #4f97d7;">()</span>:
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">speak</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, dest<span style="color: #4f97d7;">)</span>:
        pritn<span style="color: #4f97d7;">(</span>dest<span style="color: #4f97d7;">)</span>
<span style="color: #7590db;">p</span> = People<span style="color: #4f97d7;">()</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Return a callable object that fetches the given attribute(s) from its operand</span>
<span style="color: #7590db;">caller</span> = operator.attrgetter<span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'speak'</span><span style="color: #4f97d7;">)</span>
caller<span style="color: #4f97d7;">(</span>p<span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</li>


<li><a id="orga780769"></a>use the operator.methodcaller<br />
<div class="outline-text-5" id="text-6-1-3-4">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">from</span> operator <span style="color: #4f97d7; font-weight: bold;">import</span> methodcaller
<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">People</span>:
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">speak</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, message<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>message<span style="color: #4f97d7;">)</span>
<span style="color: #7590db;">caller</span> = methodcaller<span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"speak"</span>, <span style="color: #2d9574;">"hello"</span><span style="color: #4f97d7;">)</span>
<span style="color: #7590db;">p</span>  =People<span style="color: #4f97d7;">()</span>
caller<span style="color: #4f97d7;">(</span>p<span style="color: #4f97d7;">)</span>

</pre>
</div>
</div>
</li>
</ol>
</div>
</div>


<div id="outline-container-org3497a92" class="outline-3">
<h3 id="org3497a92"><span class="section-number-3">6.2</span> convert multiple for loop into one</h3>
<div class="outline-text-3" id="text-6-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #7590db;">list1</span> = <span style="color: #4f97d7;">range</span><span style="color: #4f97d7;">(</span><span style="color: #a45bad;">1</span>, <span style="color: #a45bad;">3</span><span style="color: #4f97d7;">)</span>
<span style="color: #7590db;">list2</span> = <span style="color: #4f97d7;">range</span><span style="color: #4f97d7;">(</span><span style="color: #a45bad;">4</span>,<span style="color: #a45bad;">6</span><span style="color: #4f97d7;">)</span>
<span style="color: #7590db;">list3</span> = <span style="color: #4f97d7;">range</span><span style="color: #4f97d7;">(</span><span style="color: #a45bad;">2</span>,<span style="color: #a45bad;">5</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7; font-weight: bold;">for</span> item1 <span style="color: #4f97d7; font-weight: bold;">in</span> list1:
    <span style="color: #4f97d7; font-weight: bold;">for</span> item2 <span style="color: #4f97d7; font-weight: bold;">in</span> list2:
        <span style="color: #4f97d7; font-weight: bold;">for</span> item3 <span style="color: #4f97d7; font-weight: bold;">in</span> list3:
            <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>item1 + item2 + item3<span style="color: #4f97d7;">)</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">alternatively, we can rewrite the foregoing code as:</span>
<span style="color: #4f97d7; font-weight: bold;">from</span> itertools <span style="color: #4f97d7; font-weight: bold;">import</span> product
<span style="color: #7590db;">list1</span> = <span style="color: #4f97d7;">range</span><span style="color: #4f97d7;">(</span>...<span style="color: #4f97d7;">)</span>
<span style="color: #7590db;">list2</span> = <span style="color: #4f97d7;">range</span><span style="color: #4f97d7;">(</span>...<span style="color: #4f97d7;">)</span>
...
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Cartesian product of input iterables.  Equivalent to nested for-loops.</span>
<span style="color: #4f97d7; font-weight: bold;">for</span> item1, item2, item3 <span style="color: #4f97d7; font-weight: bold;">in</span> product<span style="color: #4f97d7;">(</span>list1, list2, list3<span style="color: #4f97d7;">)</span>
    <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>item3+ item2 + item1<span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org3d184a2" class="outline-3">
<h3 id="org3d184a2"><span class="section-number-3">6.3</span> use print function for logging</h3>
<div class="outline-text-3" id="text-6-3">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">with</span> <span style="color: #4f97d7;">open</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'test.log'</span>, mode=<span style="color: #2d9574;">'w'</span><span style="color: #4f97d7;">)</span> s f:
    <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'hello'</span>, <span style="color: #4f97d7;">file</span>=f, flush=<span style="color: #a45bad;">True</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-orgfe74527" class="outline-2">
<h2 id="orgfe74527"><span class="section-number-2">7</span> Meta class</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-org3cde7fc" class="outline-3">
<h3 id="org3cde7fc"><span class="section-number-3">7.1</span> we can use type to create a class</h3>
<div class="outline-text-3" id="text-7-1">
</div>
<div id="outline-container-org77f8b40" class="outline-4">
<h4 id="org77f8b40"><span class="section-number-4">7.1.1</span> type(): type(name, bases, dict) -&gt; a new type</h4>
<div class="outline-text-4" id="text-7-1-1">
</div>
<ol class="org-ol">
<li><a id="orgcaf2e72"></a>parameters:<br />
<ol class="org-ol">
<li><a id="orgbd0faaa"></a>class name, if not given, should pass in ""<br /></li>
<li><a id="org11c6afb"></a>parent class in tuple, if no parent, pass in empty tuple (), the default is 'object'<br /></li>
<li><a id="orga892d26"></a>methods to bound, in a<br />
<div class="outline-text-6" id="text-7-1-1-1-3">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">BaseClass</span>:
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">talk</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span><span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'hello'</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">say</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span><span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'hi, there'</span><span style="color: #4f97d7;">)</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">use type to create User class</span>
<span style="color: #7590db;">User</span> = <span style="color: #4f97d7;">type</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'User'</span>, <span style="color: #bc6ec5;">(</span>Baseclass, <span style="color: #bc6ec5;">)</span>, <span style="color: #bc6ec5;">{</span><span style="color: #2d9574;">'name'</span>:<span style="color: #2d9574;">'user'</span>, <span style="color: #2d9574;">'say'</span>:say<span style="color: #bc6ec5;">}</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-python">&gt;&gt;&gt; <span style="color: #4f97d7;">type</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">type</span><span style="color: #4f97d7;">)</span>
&lt;<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #2d9574;">'type'</span>&gt;

&gt;&gt;&gt; <span style="color: #4f97d7;">type</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">object</span><span style="color: #4f97d7;">)</span>
&lt;<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #2d9574;">'type'</span>&gt;

&gt;&gt;&gt; <span style="color: #4f97d7;">type</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">int</span><span style="color: #4f97d7;">)</span>
&lt;<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #2d9574;">'type'</span>&gt;

&gt;&gt;&gt; <span style="color: #4f97d7;">type</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">str</span><span style="color: #4f97d7;">)</span>
&lt;<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #2d9574;">'type'</span>&gt;

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#19968;&#20010;&#23454;&#20363;&#30340;&#31867;&#22411;&#65292;&#26159;&#31867;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#19968;&#20010;&#31867;&#30340;&#31867;&#22411;&#65292;&#26159;&#20803;&#31867;(type)</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#19968;&#20010;&#20803;&#31867;&#30340;&#31867;&#22411;&#65292;&#26159;type</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">BaseClass</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">type</span><span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__new__</span><span style="color: #4f97d7;">(</span>cls, *args, **kwargs<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'in BaseClass'</span><span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7;">super</span><span style="color: #4f97d7;">()</span>.__new__<span style="color: #4f97d7;">(</span>cls, *args, **kwargs<span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">User</span><span style="color: #4f97d7;">(</span>metaclass=BaseClass<span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, name<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">self</span>.name= name

<span style="color: #7590db;">user</span> = User<span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"Tom"</span><span style="color: #4f97d7;">)</span>        
</pre>
</div>
</div>
</li>
</ol>
</li>
</ol>
</div>
<div id="outline-container-orga5a18f5" class="outline-4">
<h4 id="orga5a18f5"><span class="section-number-4">7.1.2</span> a class is the instance of a metaclass, when creating a class, it invokes the `_<sub>new</sub>_<sub>()</sub>` of the metaclass</h4>
<div class="outline-text-4" id="text-7-1-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">MetaSingleton</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">type</span><span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__call__</span><span style="color: #4f97d7;">(</span>cls, *args, **kwargs<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"cls:{}"</span>.<span style="color: #4f97d7;">format</span><span style="color: #bc6ec5;">(</span>cls.<span style="color: #4f97d7;">__name__</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"====1===="</span><span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7; font-weight: bold;">not</span> <span style="color: #4f97d7;">hasattr</span><span style="color: #4f97d7;">(</span>cls, <span style="color: #2d9574;">"_instance"</span><span style="color: #4f97d7;">)</span>:
            <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"====2===="</span><span style="color: #4f97d7;">)</span>
            <span style="color: #7590db;">cls._instance</span> = <span style="color: #4f97d7;">type</span>.__call__<span style="color: #4f97d7;">(</span>cls, *args, **kwargs<span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7; font-weight: bold;">return</span> cls._instance

<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">User</span><span style="color: #4f97d7;">(</span>metaclass=MetaSingleton<span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, *args, **kw<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"====3===="</span><span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7; font-weight: bold;">for</span> k,v <span style="color: #4f97d7; font-weight: bold;">in</span> kw:
            <span style="color: #4f97d7;">setattr</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, k, v<span style="color: #4f97d7;">)</span>

&gt;&gt;&gt; <span style="color: #7590db;">u1</span> = User<span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'wangbm1'</span><span style="color: #4f97d7;">)</span>
cls:User
====<span style="color: #a45bad;">1</span>====
====<span style="color: #a45bad;">2</span>====
====<span style="color: #a45bad;">3</span>====
&gt;&gt;&gt; <span style="color: #7590db;">u1.age</span> = <span style="color: #a45bad;">20</span>
&gt;&gt;&gt; <span style="color: #7590db;">u2</span> = User<span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'wangbm2'</span><span style="color: #4f97d7;">)</span>
cls:User
====<span style="color: #a45bad;">1</span>====
&gt;&gt;&gt; u2.age
<span style="color: #a45bad;">20</span>
&gt;&gt;&gt; u1 <span style="color: #4f97d7; font-weight: bold;">is</span> u2
<span style="color: #a45bad;">True</span>            
</pre>
</div>
</div>
</div>
<div id="outline-container-orga94f7e8" class="outline-4">
<h4 id="orga94f7e8"><span class="section-number-4">7.1.3</span> In sum, we invoking User(), python will call the `_<sub>call</sub>_<sub>()</sub>` of the type class</h4>
</div>
<div id="outline-container-org4e1995a" class="outline-4">
<h4 id="org4e1995a"><span class="section-number-4">7.1.4</span> ` _<sub>new</sub>__` work like a constructor, thus it returns the object it builds</h4>
</div>
<div id="outline-container-org33c4255" class="outline-4">
<h4 id="org33c4255"><span class="section-number-4">7.1.5</span> `_<sub>init</sub>__` is for initialization, and has no return</h4>
</div>
</div>
</div>
<div id="outline-container-orgde97a83" class="outline-2">
<h2 id="orgde97a83"><span class="section-number-2">8</span> What is a metaclass: the one that creates class (template for a class)</h2>
<div class="outline-text-2" id="text-8">
</div>
<div id="outline-container-orge3b72fa" class="outline-3">
<h3 id="orge3b72fa"><span class="section-number-3">8.1</span> it inherits from the `type`</h3>
</div>
<div id="outline-container-org9cfcc74" class="outline-3">
<h3 id="org9cfcc74"><span class="section-number-3">8.2</span> how to create class form a meta class</h3>
<div class="outline-text-3" id="text-8-2">
</div>
<div id="outline-container-org908923a" class="outline-4">
<h4 id="org908923a"><span class="section-number-4">8.2.1</span> class TestMetaClass(type):pass</h4>
</div>
<div id="outline-container-orgf893740" class="outline-4">
<h4 id="orgf893740"><span class="section-number-4">8.2.2</span> class TestClass():_<sub>metaclass</sub>__ = TestMetaClass (can be a function of how to defining the behavior)</h4>
</div>
<div id="outline-container-orgc6fce64" class="outline-4">
<h4 id="orgc6fce64"><span class="section-number-4">8.2.3</span> class TestClass(metaclass=TestMetaClass): pass</h4>
<div class="outline-text-4" id="text-8-2-3">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">TestMetaClass</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">type</span><span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__new__</span><span style="color: #4f97d7;">(</span>cls, *args, **kwargs<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"MetaClass.__new__"</span><span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7; font-weight: bold;">self</span> = <span style="color: #4f97d7;">super</span><span style="color: #4f97d7;">()</span>.__new__<span style="color: #4f97d7;">(</span>cls, *args, **kwargs<span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">self</span>


    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span>cls, what, bases=<span style="color: #a45bad;">None</span>, <span style="color: #4f97d7;">dict</span>=<span style="color: #a45bad;">None</span><span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"MetaClass.__init__"</span><span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7;">super</span><span style="color: #4f97d7;">()</span>.__init__<span style="color: #4f97d7;">(</span>what, bases, <span style="color: #4f97d7;">dict</span><span style="color: #4f97d7;">)</span>

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__call__</span><span style="color: #4f97d7;">(</span>cls, *args, **kwargs<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"MetaClass.__call__"</span><span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7; font-weight: bold;">self</span> = <span style="color: #4f97d7;">super</span><span style="color: #4f97d7;">(</span>TestMetaClass, cls<span style="color: #4f97d7;">)</span>.__call__<span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">self</span> 


<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">TestClass</span><span style="color: #4f97d7;">(</span>metaclass=TestMetaClass<span style="color: #4f97d7;">)</span>:

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, *args, **kwargs<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"Class.__init__"</span><span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7;">super</span><span style="color: #4f97d7;">()</span>.__init__<span style="color: #4f97d7;">()</span>

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__new__</span><span style="color: #4f97d7;">(</span>cls, *args, **kwargs<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"Class.__new__"</span><span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7; font-weight: bold;">self</span> = <span style="color: #4f97d7;">super</span><span style="color: #4f97d7;">()</span>.__new__<span style="color: #4f97d7;">(</span>cls, *args, **kwargs<span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">self</span>

<span style="color: #7590db;">a</span> = TestClass<span style="color: #4f97d7;">()</span> <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">x.__call__(1, 2) == x(1, 2)</span>


<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">another implementation</span>
<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">TestClass</span><span style="color: #4f97d7;">()</span>:
    <span style="color: #7590db;">__metaclass__</span> = TestMetaClass

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, *args, **kwargs<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"class init"</span><span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7;">super</span><span style="color: #4f97d7;">()</span>.__init__<span style="color: #4f97d7;">()</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">************************* function flow *****************</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">1. MetaClass.__new__: need to new TestClass, an object of TestMetaClass </span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">2. MetaClass.__init__</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">3. MetaClass.__call__: call an instance (TestClass is an instance of TestMetaClass) will invoke the __call__ of the type class (TestMetaClass)</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">4. Class.__new__</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">5. Class.__init__</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgc5694cf" class="outline-3">
<h3 id="orgc5694cf"><span class="section-number-3">8.3</span> C._<sub>class</sub>__: return the class that create instance C (can be a instance or a class)</h3>
</div>
<div id="outline-container-org1445d66" class="outline-3">
<h3 id="org1445d66"><span class="section-number-3">8.4</span> C._<sub>bases</sub>__: (C._<sub>bases</sub>__ return only one) return the parent class of class C.</h3>
<div class="outline-text-3" id="text-8-4">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Foo</span><span style="color: #4f97d7;">(</span>Bar<span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">pass</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#39318;&#20808;&#21028;&#26029; Foo &#20013;&#26159;&#21542;&#26377; __metaclass__ &#36825;&#20010;&#23646;&#24615;&#65311;&#22914;&#26524;&#26377;&#65292;Python &#20250;&#22312;&#20869;&#23384;&#20013;&#36890;&#36807; __metaclass__</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#21019;&#24314;&#19968;&#20010;&#21517;&#23383;&#20026; Foo &#30340;&#31867;&#23545;&#35937;&#65288;&#27880;&#24847;&#65292;&#36825;&#37324;&#26159;&#31867;&#23545;&#35937;&#65289;&#12290;&#22914;&#26524; Python &#27809;&#26377;&#25214;&#21040;__metaclass__ &#65292;&#23427;&#20250;&#32487;&#32493;&#22312;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Bar&#65288;&#29238;&#31867;&#65289;&#20013;&#23547;&#25214;__metaclass__ &#23646;&#24615;&#65292;&#24182;&#23581;&#35797;&#20570;&#21644;&#21069;&#38754;&#21516;&#26679;&#30340;&#25805;&#20316;&#12290;&#22914;&#26524; Python&#22312;&#20219;&#20309;&#29238;&#31867;&#20013;&#37117;&#25214;&#19981;&#21040;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">__metaclass__ &#65292;&#23427;&#23601;&#20250;&#22312;&#27169;&#22359;&#23618;&#27425;&#20013;&#21435;&#23547;&#25214; __metaclass__ &#65292;&#24182;&#23581;&#35797;&#20570;&#21516;&#26679;&#30340;&#25805;&#20316;&#12290;&#22914;&#26524;&#36824;&#26159;&#25214;&#19981;&#21040;` metaclass`,</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Python &#23601;&#20250;&#29992;&#20869;&#32622;&#30340; type &#26469;&#21019;&#24314;&#36825;&#20010;&#31867;&#23545;&#35937;&#12290;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#20854;&#23454; __metaclass__ &#23601;&#26159;&#23450;&#20041;&#20102; class &#30340;&#34892;&#20026;&#12290;&#31867;&#20284;&#20110; class &#23450;&#20041;&#20102; instance &#30340;&#34892;&#20026;&#65292;metaclass &#21017;&#23450;&#20041;&#20102;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">class &#30340;&#34892;&#20026;&#12290;&#21487;&#20197;&#35828;&#65292;class &#26159; metaclass &#30340; instance&#12290;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Pareent class --&gt; Module --&gt; type</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org9b0a231" class="outline-2">
<h2 id="org9b0a231"><span class="section-number-2">9</span> Important: when calling a instance, we invoke the `_<sub>call</sub>_<sub>()</sub>` of its class</h2>
</div>
<div id="outline-container-orgbd6a082" class="outline-2">
<h2 id="orgbd6a082"><span class="section-number-2">10</span> When calling a class, we invoke the `_<sub>call</sub>_<sub>()</sub>` of the metaclass that creates this class</h2>
<div class="outline-text-2" id="text-10">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">StanfordTeacher&#30340;&#20803;&#31867;&#20013;&#30340;__call__&#26041;&#27861;&#20063;&#24212;&#35813;&#20570;&#36825;&#19977;&#20214;&#20107;:</span>
<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Mymeta</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">type</span><span style="color: #4f97d7;">)</span>: <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#21482;&#26377;&#32487;&#25215;&#20102;type&#31867;&#25165;&#33021;&#31216;&#20043;&#20026;&#19968;&#20010;&#20803;&#31867;&#65292;&#21542;&#21017;&#23601;&#26159;&#19968;&#20010;&#26222;&#36890;&#30340;&#33258;&#23450;&#20041;&#31867;</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__call__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, *args, **kwargs<span style="color: #4f97d7;">)</span>: <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">self=&lt;class '__main__.StanfordTeacher'&gt;</span>
        <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">1&#12289;&#35843;&#29992;__new__&#20135;&#29983;&#19968;&#20010;&#31354;&#23545;&#35937;obj</span>
        <span style="color: #7590db;">obj</span>=<span style="color: #4f97d7; font-weight: bold;">self</span>.__new__<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span><span style="color: #4f97d7;">)</span> <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#27492;&#22788;&#30340;self&#26159;&#31867;StanfordTeacher&#65292;&#24517;&#39035;&#20256;&#21442;&#65292;&#20195;&#34920;&#21019;&#24314;&#19968;&#20010;StanfordTeacher&#30340;&#23545;&#35937;obj</span>

        <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">2&#12289;&#35843;&#29992;__init__&#21021;&#22987;&#21270;&#31354;&#23545;&#35937;obj</span>
        <span style="color: #4f97d7; font-weight: bold;">self</span>.__init__<span style="color: #4f97d7;">(</span>obj,*args,**kwargs<span style="color: #4f97d7;">)</span>

        <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">3&#12289;&#36820;&#22238;&#21021;&#22987;&#21270;&#22909;&#30340;&#23545;&#35937;obj</span>
        <span style="color: #4f97d7; font-weight: bold;">return</span> obj

<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">StanfordTeacher</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">object</span>,metaclass=Mymeta<span style="color: #4f97d7;">)</span>:
    <span style="color: #7590db;">school</span>=<span style="color: #2d9574;">'Stanford'</span>

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>,name,age<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">self</span>.name=name
        <span style="color: #4f97d7; font-weight: bold;">self</span>.age=age

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">say</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span><span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'%s says welcome to the Stanford to learn Python'</span> %<span style="color: #4f97d7; font-weight: bold;">self</span>.name<span style="color: #4f97d7;">)</span>

<span style="color: #7590db;">t1</span>=StanfordTeacher<span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'lili'</span>,<span style="color: #a45bad;">18</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>t1.<span style="color: #4f97d7;">__dict__</span><span style="color: #4f97d7;">)</span> <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">{'name': 'lili', 'age': 18}</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">1&#12289;&#20135;&#29983;&#19968;&#20010;&#31354;&#23545;&#35937;obj</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">2&#12289;&#35843;&#29992;__init__&#26041;&#27861;&#21021;&#22987;&#21270;&#23545;&#35937;obj</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">3&#12289;&#36820;&#22238;&#21021;&#22987;&#21270;&#22909;&#30340;obj</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Mymeta</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">type</span><span style="color: #4f97d7;">)</span>: <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#21482;&#26377;&#32487;&#25215;&#20102;type&#31867;&#25165;&#33021;&#31216;&#20043;&#20026;&#19968;&#20010;&#20803;&#31867;&#65292;&#21542;&#21017;&#23601;&#26159;&#19968;&#20010;&#26222;&#36890;&#30340;&#33258;&#23450;&#20041;&#31867;</span>
    <span style="color: #7590db;">n</span>=<span style="color: #a45bad;">444</span>

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__new__</span><span style="color: #4f97d7;">(</span>cls, *args, **kwargs<span style="color: #4f97d7;">)</span>:
        <span style="color: #7590db;">obj</span>=<span style="color: #4f97d7;">type</span>.__new__<span style="color: #4f97d7;">(</span>cls,*args,**kwargs<span style="color: #4f97d7;">)</span> <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#24517;&#39035;&#25353;&#29031;&#36825;&#31181;&#20256;&#20540;&#26041;&#24335;</span>
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>obj.<span style="color: #4f97d7;">__dict__</span><span style="color: #4f97d7;">)</span>
        <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">return obj # &#21482;&#26377;&#22312;&#36820;&#22238;&#20540;&#26159;type&#30340;&#23545;&#35937;&#26102;&#65292;&#25165;&#20250;&#35302;&#21457;&#19979;&#38754;&#30340;__init__</span>
        <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #a45bad;">123</span>

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>,class_name,class_bases,class_dic<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'run&#12290;&#12290;&#12290;'</span><span style="color: #4f97d7;">)</span>


<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">StanfordTeacher</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">object</span>,metaclass=Mymeta<span style="color: #4f97d7;">)</span>: <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">StanfordTeacher=Mymeta('StanfordTeacher',(object),{...})</span>
    <span style="color: #7590db;">n</span>=<span style="color: #a45bad;">111</span>

    <span style="color: #7590db;">school</span>=<span style="color: #2d9574;">'Stanford'</span>

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>,name,age<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">self</span>.name=name
        <span style="color: #4f97d7; font-weight: bold;">self</span>.age=age

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">say</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span><span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'%s says welcome to the Stanford to learn Python'</span> %<span style="color: #4f97d7; font-weight: bold;">self</span>.name<span style="color: #4f97d7;">)</span>

<span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">type</span><span style="color: #bc6ec5;">(</span>Mymeta<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span> <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&lt;class 'type'&gt;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#20135;&#29983;&#31867;StanfordTeacher&#30340;&#36807;&#31243;&#23601;&#26159;&#22312;&#35843;&#29992;Mymeta&#65292;&#32780;Mymeta&#20063;&#26159;type&#31867;&#30340;&#19968;&#20010;&#23545;&#35937;&#65292;&#37027;&#20040;Mymeta&#20043;&#25152;&#20197;&#21487;&#20197;&#35843;&#29992;&#65292;&#19968;&#23450;&#26159;&#22312;&#20803;&#31867;type&#20013;&#26377;&#19968;&#20010;__call__&#26041;&#27861;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#35813;&#26041;&#27861;&#20013;&#21516;&#26679;&#38656;&#35201;&#20570;&#33267;&#23569;&#19977;&#20214;&#20107;&#65306;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">class type:</span>
<span style="color: #2aa1ae; background-color: #292e34;">#     </span><span style="color: #2aa1ae; background-color: #292e34;">def __call__(self, *args, **kwargs): #self=&lt;class '__main__.Mymeta'&gt;</span>
<span style="color: #2aa1ae; background-color: #292e34;">#         </span><span style="color: #2aa1ae; background-color: #292e34;">obj=self.__new__(self,*args,**kwargs) # &#20135;&#29983;Mymeta&#30340;&#19968;&#20010;&#23545;&#35937;</span>
<span style="color: #2aa1ae; background-color: #292e34;">#         </span><span style="color: #2aa1ae; background-color: #292e34;">self.__init__(obj,*args,**kwargs)</span>
<span style="color: #2aa1ae; background-color: #292e34;">#         </span><span style="color: #2aa1ae; background-color: #292e34;">return obj</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org5b31326" class="outline-2">
<h2 id="org5b31326"><span class="section-number-2">11</span> 在Python当中，_<sub>call</sub>__,_<sub>new</sub>__,_<sub>init</sub>_<sub>三者之间的关系</sub></h2>
<div class="outline-text-2" id="text-11">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#22312;&#31867;&#23454;&#20363;&#21270;&#30340;&#36807;&#31243;&#24403;&#20013;&#65292;&#21738;&#20010;&#23545;&#35937;&#21152;()&#23601;&#23547;&#25214;&#20135;&#29983;&#36825;&#20010;&#23545;&#35937;&#30340;&#31867;&#30340;__call__&#26041;&#27861;&#65292;&#21482;&#35201;&#26159;__call__&#26041;&#27861;&#65292;&#19968;&#23450;&#20250;&#20570;&#19977;&#20214;&#20107;&#24773;&#65306;</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#31532;&#19968;&#65306;&#35843;&#29992;__new__&#26041;&#27861;&#65292;&#26500;&#36896;&#26032;&#30340;&#23545;&#35937;&#65292;&#30456;&#24403;&#20110;Java&#24403;&#20013;&#30340;&#26500;&#36896;&#20989;&#25968;.&#65288;&#23545;&#35937;&#33258;&#24049;&#30340;__new__&#65289;</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#31532;&#20108;&#65306;&#35843;&#29992;__init__&#26041;&#27861;,&#21435;&#21021;&#22987;&#21270;&#36825;&#20010;&#23545;&#35937;&#65288;&#23545;&#35937;&#33258;&#24049;&#30340;__init__&#65289;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#31532;&#19977;&#65306;&#36820;&#22238;&#36825;&#20010;&#23545;&#35937;.</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#27880;&#24847;:__new__&#26356;&#20687;&#26159;&#20854;&#20182;&#35821;&#35328;&#24403;&#20013;&#30340;&#26500;&#36896;&#20989;&#25968;&#65292;&#24517;&#39035;&#26377;&#36820;&#22238;&#20540;&#65292;&#36820;&#22238;&#20540;&#23454;&#20363;&#21270;&#30340;&#23545;&#35937;&#65292;__init__&#21482;&#26159;&#21021;&#22987;&#21270;&#26500;&#36896;&#20989;&#25968;&#65292;&#24517;&#39035;&#27809;&#26377;&#36820;&#22238;&#20540;&#65292;&#20165;&#20165;&#21482;&#26159;&#21021;&#22987;&#21270;&#21151;&#33021;&#65292;&#24182;&#19981;&#33021;new&#21019;&#24314;&#23545;&#35937;.</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#20063;&#23601;&#26159;&#35828;,&#19968;&#20010;&#31867;&#22312;&#23454;&#20363;&#21270;&#30340;&#26102;&#20505;&#23454;&#38469;&#19978;&#26159;&#20570;&#20102;&#19977;&#20214;&#20107;&#24773;&#65306;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#31532;&#19968;&#65306;&#35302;&#21457;&#20803;&#31867;&#20013;&#65288;&#36896;&#20986;&#36825;&#20010;&#31867;&#30340;&#31867;&#65289;&#30340;__call__&#26041;&#27861;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#31532;&#20108;&#65306;&#36890;&#36807;__new__&#20135;&#29983;&#19968;&#20010;&#31354;&#23545;&#35937;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#31532;&#19977;&#65306;&#36890;&#36807;__init__&#21021;&#22987;&#21270;&#36825;&#20010;&#23545;&#35937;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#31532;&#22235;&#65306;&#36820;&#22238;&#36825;&#20010;&#23545;&#35937;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#31867;&#22312;&#23454;&#20363;&#21270;&#23545;&#35937;&#30340;&#26102;&#20505;&#20989;&#25968;&#30340;&#35843;&#29992;&#39034;&#24207;&#20381;&#27425;&#26159;:</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Meta.__call__==&gt;__new__==&gt;__init__</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org3a59ee4" class="outline-2">
<h2 id="org3a59ee4"><span class="section-number-2">12</span> June 17, 2021</h2>
<div class="outline-text-2" id="text-12">
</div>
<div id="outline-container-orgf05cd36" class="outline-3">
<h3 id="orgf05cd36"><span class="section-number-3">12.1</span> class object</h3>
<div class="outline-text-3" id="text-12-1">
<div class="org-src-container">
<pre class="src src-python">      <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Dog</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">object</span><span style="color: #4f97d7;">)</span>:
          <span style="color: #7590db;">name</span>=<span style="color: #2d9574;">'cat'</span>
          <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>,name<span style="color: #4f97d7;">)</span>:
              <span style="color: #4f97d7; font-weight: bold;">self</span>.name = name
          @<span style="color: #4f97d7;">classmethod</span>
          <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">eat</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span><span style="color: #4f97d7;">)</span>:
              <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">"cat is eating"</span>
              <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"%s is eating"</span> % <span style="color: #4f97d7; font-weight: bold;">self</span>.name<span style="color: #4f97d7;">)</span>
           <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">if Dog has no attr name, then report error</span>
           <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">AttributeError: type object 'Dog' has no attribute 'name'</span>

      <span style="color: #7590db;">d</span> = Dog<span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"wangcai"</span><span style="color: #4f97d7;">)</span>
      d.eat<span style="color: #4f97d7;">()</span>


   <span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Dog</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">object</span><span style="color: #4f97d7;">)</span>:
       <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>,name<span style="color: #4f97d7;">)</span>:
           <span style="color: #4f97d7; font-weight: bold;">self</span>.name = name
       @<span style="color: #4f97d7;">staticmethod</span>  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#25226;eat&#26041;&#27861;&#21464;&#20026;&#38745;&#24577;&#26041;&#27861;</span>
       <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">eat</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span><span style="color: #4f97d7;">)</span>:
           <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"%s is eating"</span> %<span style="color: #4f97d7; font-weight: bold;">self</span>.name<span style="color: #4f97d7;">)</span>

   <span style="color: #7590db;">d</span> = Dog<span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"wangcai"</span><span style="color: #4f97d7;">)</span>
   d.eat<span style="color: #4f97d7;">()</span>
   <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">TypeError: eat() missing 1 required positional argument: 'self'</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#35828;&#26159;eat&#38656;&#35201;&#19968;&#20010;self&#21442;&#25968;&#65292;&#20294;&#35843;&#29992;&#26102;&#21364;&#27809;&#26377;&#20256;&#36882;&#65292;&#27809;&#38169;&#65292;&#24403;eat&#21464;&#25104;&#38745;&#24577;&#26041;&#27861;&#21518;&#65292;&#20877;&#36890;&#36807;&#23454;&#20363;&#35843;&#29992;&#26102;&#23601;&#19981;&#20250;&#33258;&#21160;&#25226;&#23454;&#20363;&#26412;&#36523;&#24403;&#20316;&#19968;&#20010;&#21442;&#25968;&#20256;&#32473;self&#20102;&#12290;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#24819;&#35753;&#19978;&#38754;&#30340;&#20195;&#30721;&#21487;&#20197;&#27491;&#24120;&#24037;&#20316;&#26377;&#20004;&#31181;&#21150;&#27861;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#35843;&#29992;&#26102;&#20027;&#21160;&#20256;&#36882;&#23454;&#20363;&#26412;&#36523;&#32473;eat&#26041;&#27861;&#65292;&#21363;d.eat(d)</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#22312;eat&#26041;&#27861;&#20013;&#21435;&#25481;self&#21442;&#25968;&#65292;&#20294;&#36825;&#20063;&#24847;&#21619;&#30528;&#65292;&#22312;eat&#20013;&#19981;&#33021;&#36890;&#36807;self.&#35843;&#29992;&#23454;&#20363;&#20013;&#30340;&#20854;&#23427;&#21464;&#37327;&#20102;</span>

<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Dog</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">object</span><span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>,name<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">self</span>.name = name
        <span style="color: #4f97d7; font-weight: bold;">self</span>.__food = <span style="color: #a45bad;">None</span>
    @<span style="color: #4f97d7;">property</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">eat</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span><span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"%s is eating %s"</span> %<span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>.name, <span style="color: #4f97d7; font-weight: bold;">self</span>.__food<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
    <span style="color: #ce537a; font-weight: bold;">@eat.setter</span>  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#36171;&#20540;&#35843;&#29992;&#23646;&#24615;&#65292;&#35843;&#36825;&#20010;&#26041;&#27861;</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">eat</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>,food<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"set to food:"</span>,food<span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7; font-weight: bold;">self</span>.__food = food

<span style="color: #7590db;">d</span> = Dog<span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"wangcai"</span><span style="color: #4f97d7;">)</span>
d.eat
<span style="color: #7590db;">d.eat</span> = <span style="color: #2d9574;">"baozi"</span>
d.eat
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">set to food: ('baozi_a', 'baozi_b')</span>
<span style="color: #7590db;">d.eat</span> = <span style="color: #2d9574;">"baozi_a"</span>, <span style="color: #2d9574;">"baozi_b"</span>

</pre>
</div>
</div>
</div>


<div id="outline-container-orgf0f1ff8" class="outline-3">
<h3 id="orgf0f1ff8"><span class="section-number-3">12.2</span> None and None type</h3>
<div class="outline-text-3" id="text-12-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">None&#26159;Python&#30340;&#29305;&#27530;&#31867;&#22411;&#65292;NoneType&#23545;&#35937;&#65292;&#23427;&#21482;&#26377;&#19968;&#20010;&#20540;None.</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#23427;&#19981;&#25903;&#25345;&#20219;&#20309;&#36816;&#31639;&#20063;&#27809;&#26377;&#20219;&#20309;&#20869;&#24314;&#26041;&#27861;&#12290;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">None&#21644;&#20219;&#20309;&#20854;&#20182;&#30340;&#25968;&#25454;&#31867;&#22411;&#27604;&#36739;&#27704;&#36828;&#36820;&#22238;False&#12290;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">None&#26377;&#33258;&#24049;&#30340;&#25968;&#25454;&#31867;&#22411;NoneType&#12290;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#20320;&#21487;&#20197;&#23558;None&#22797;&#21046;&#32473;&#20219;&#20309;&#21464;&#37327;&#65292;&#20294;&#26159;&#20320;&#19981;&#33021;&#21019;&#24314;&#20854;&#20182;NoneType&#23545;&#35937;&#12290;</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">python&#23545;&#21464;&#37327;&#26159;&#21542;&#20026;None&#30340;&#21028;&#26029;&#65292;&#26377;&#19977;&#31181;&#20027;&#35201;&#30340;&#20889;&#27861;&#65306;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#31532;&#19968;&#31181;&#26159;if x is None&#65307;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#31532;&#20108;&#31181;&#26159; if not x&#65306;&#65307;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#31532;&#19977;&#31181;&#26159;if not x is None&#65288;&#36825;&#21477;&#36825;&#26679;&#29702;&#35299;&#26356;&#28165;&#26224;if not (x is None)&#65289; &#12290;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#22312;Python&#20013; None, False, &#31354;&#23383;&#31526;&#20018;&#8221;&#8220;, 0, &#31354;&#21015;&#34920;[], &#31354;&#23383;&#20856;{}, &#31354;&#20803;&#32452;()&#37117;&#30456;&#24403;&#20110;False &#12290;</span>


<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Dog</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">object</span><span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>,name<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">self</span>.name = name
    @<span style="color: #4f97d7;">property</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">eat</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span><span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"%s is eating"</span> % <span style="color: #4f97d7; font-weight: bold;">self</span>.name<span style="color: #4f97d7;">)</span>

<span style="color: #7590db;">d</span> = Dog<span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"wangcai"</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">type</span><span style="color: #bc6ec5;">(</span>d.eat<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>d.eat<span style="color: #bc6ec5;">()</span><span style="color: #4f97d7;">)</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">TypeError: 'NoneType' object is not callable</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">since the d.eat return `None` instead of a function</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org1fc4eec" class="outline-2">
<h2 id="org1fc4eec"><span class="section-number-2">13</span> @classmethod 和@staticmethod</h2>
<div class="outline-text-2" id="text-13">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Car</span>:
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, model<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">self</span>.model = model

    <span style="color: #ce537a; font-weight: bold;">@logging</span> <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#35013;&#39280;&#23454;&#20363;&#26041;&#27861;&#65292;OK</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">run</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span><span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"%s is running!"</span> % <span style="color: #4f97d7; font-weight: bold;">self</span>.model<span style="color: #4f97d7;">)</span>

    <span style="color: #ce537a; font-weight: bold;">@logging</span> <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#35013;&#39280;&#38745;&#24577;&#26041;&#27861;&#65292;Failed</span>
    @<span style="color: #4f97d7;">staticmethod</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">check_model_for</span><span style="color: #4f97d7;">(</span>obj<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7;">isinstance</span><span style="color: #4f97d7;">(</span>obj, Car<span style="color: #4f97d7;">)</span>:
            <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"The model of your car is %s"</span> % obj.model<span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7; font-weight: bold;">else</span>:
            <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"%s is not a car!"</span> % obj<span style="color: #4f97d7;">)</span>

<span style="color: #2aa1ae; background-color: #292e34;">#  </span><span style="color: #2aa1ae; background-color: #292e34;">@staticmethod&#35013;&#39280;&#22120;&#36820;&#22238;&#30340;&#26159;&#19968;&#20010;staticmethod&#23545;&#35937;&#65292;&#32780;&#19981;&#26159;callable&#23545;&#35937;&#12290;&#36825;&#26159;&#19981;&#31526;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#21512;&#35013;&#39280;&#22120;&#35201;&#27714;&#30340;&#65288;&#22914; &#20256;&#20837;&#19968;&#20010;callable&#23545;&#35937;&#65289;&#65292;&#33258;&#28982;&#32780;&#28982;&#19981;&#21487;&#22312;&#20854;&#19978;&#26041;&#28155;&#21152;&#20854;&#20182;&#35013;&#39280;&#22120;&#12290;&#35299;&#20915;&#26041;&#26696;&#65306;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#23558;@staticmethod&#32622;&#21069;&#65292;&#22240;&#20026;&#35013;&#39280;&#36820;&#22238;&#19968;&#20010;&#27491;&#24120;&#30340;&#20989;&#25968;&#65292;&#28982;&#21518;&#20877;&#21152;&#19978;@staticmethod&#23601;&#27809;&#38382;&#39064;&#20102;</span>
<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Car</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">object</span><span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, model<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">self</span>.model = model

    @<span style="color: #4f97d7;">staticmethod</span>
    <span style="color: #ce537a; font-weight: bold;">@logging</span>  <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#22312;@staticmethod&#20043;&#21069;&#35013;&#39280;&#65292;OK</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">check_model_for</span><span style="color: #4f97d7;">(</span>obj<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">pass</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-orga3e1c15" class="outline-2">
<h2 id="orga3e1c15"><span class="section-number-2">14</span> 内置函数locals()、globals()返回一个字典。区别：前者只读、后者可写。</h2>
</div>

<div id="outline-container-org17e7a21" class="outline-2">
<h2 id="org17e7a21"><span class="section-number-2">15</span> Python if/else</h2>
<div class="outline-text-2" id="text-15">
<p>
  Python 里的分支代码
Python 支持最为常见的 if/else 条件分支语句，不过它缺少在其他编程语言中常见的 switch/case 语句。
</p>

<p>
除此之外，Python 还为 for/while 循环以及 try/except 语句提供了 else 分支，在一些特殊的场景下，它们可以大显身手。
</p>

<p>
下面我会从 最佳实践、常见技巧、常见陷阱 三个方面讲一下如果编写优秀的条件分支代码。
</p>

<p>
最佳实践
</p>
<ol class="org-ol">
<li>避免多层分支嵌套</li>
</ol>
<p>
如果这篇文章只能删减成一句话就结束，那么那句话一定是“要竭尽所能的避免分支嵌套”。
</p>

<p>
过深的分支嵌套是很多编程新手最容易犯的错误之一。假如有一位新手 JavaScript 程序员写了很多层分支嵌套，那么你可能会看到一层又一层的大括号：if { if { if { &#x2026; }}}。俗称“嵌套 if 地狱（Nested If Statement Hell）”。
</p>

<p>
但是因为 Python 使用了缩进来代替 {}，所以过深的嵌套分支会产生比其他语言下更为严重的后果。比如过多的缩进层次很容易就会让代码超过 PEP8 中规定的每行字数限制。让我们看看这段代码：
</p>

<p>
def buy<sub>fruit</sub>(nerd, store):
    """去水果店买苹果
</p>

<ul class="org-ul">
<li>先得看看店是不是在营业</li>
<li>如果有苹果的话，就买 1 个</li>
<li>如果钱不够，就回家取钱再来</li>
</ul>
<p>
"""
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">if</span> store.is_open<span style="color: #4f97d7;">()</span>:
        <span style="color: #4f97d7; font-weight: bold;">if</span> store.has_stocks<span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"apple"</span><span style="color: #4f97d7;">)</span>:
            <span style="color: #4f97d7; font-weight: bold;">if</span> nerd.can_afford<span style="color: #4f97d7;">(</span>store.price<span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"apple"</span>, amount=<span style="color: #a45bad;">1</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>:
                nerd.buy<span style="color: #4f97d7;">(</span>store, <span style="color: #2d9574;">"apple"</span>, amount=<span style="color: #a45bad;">1</span><span style="color: #4f97d7;">)</span>
                <span style="color: #4f97d7; font-weight: bold;">return</span>
            <span style="color: #4f97d7; font-weight: bold;">else</span>:
                nerd.go_home_and_get_money<span style="color: #4f97d7;">()</span>
                <span style="color: #4f97d7; font-weight: bold;">return</span> buy_fruit<span style="color: #4f97d7;">(</span>nerd, store<span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7; font-weight: bold;">else</span>:
            <span style="color: #4f97d7; font-weight: bold;">raise</span> MadAtNoFruit<span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"no apple in store!"</span><span style="color: #4f97d7;">)</span>
    <span style="color: #4f97d7; font-weight: bold;">else</span>:
        <span style="color: #4f97d7; font-weight: bold;">raise</span> MadAtNoFruit<span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"store is closed!"</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
<p>
上面这段代码最大的问题，就是过于直接翻译了原始的条件分支要求，导致短短十几行代码包含了有三层嵌套分支。
</p>

<p>
这样的代码可读性和维护性都很差。不过我们可以用一个很简单的技巧：“提前结束” 来优化这段代码：
</p>
<div class="org-src-container">
<pre class="src src-python">
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">buy_fruit</span><span style="color: #4f97d7;">(</span>nerd, store<span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7; font-weight: bold;">not</span> store.is_open<span style="color: #4f97d7;">()</span>:
        <span style="color: #4f97d7; font-weight: bold;">raise</span> MadAtNoFruit<span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"store is closed!"</span><span style="color: #4f97d7;">)</span>

    <span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7; font-weight: bold;">not</span> store.has_stocks<span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"apple"</span><span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">raise</span> MadAtNoFruit<span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"no apple in store!"</span><span style="color: #4f97d7;">)</span>

    <span style="color: #4f97d7; font-weight: bold;">if</span> nerd.can_afford<span style="color: #4f97d7;">(</span>store.price<span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"apple"</span>, amount=<span style="color: #a45bad;">1</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>:
        nerd.buy<span style="color: #4f97d7;">(</span>store, <span style="color: #2d9574;">"apple"</span>, amount=<span style="color: #a45bad;">1</span><span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7; font-weight: bold;">return</span>
    <span style="color: #4f97d7; font-weight: bold;">else</span>:
        nerd.go_home_and_get_money<span style="color: #4f97d7;">()</span>
        <span style="color: #4f97d7; font-weight: bold;">return</span> buy_fruit<span style="color: #4f97d7;">(</span>nerd, store<span style="color: #4f97d7;">)</span>
</pre>
</div>
<p>
“提前结束”指：在函数内使用 return 或 raise 等语句提前在分支内结束函数。比如，在新的 buy<sub>fruit</sub> 函数里，当分支条件不满足时，我们直接抛出异常，结束这段这代码分支。这样的代码没有嵌套分支，更直接也更易读。
</p>

<ol class="org-ol">
<li>封装那些过于复杂的逻辑判断</li>
</ol>
<p>
如果条件分支里的表达式过于复杂，出现了太多的 not/and/or，那么这段代码的可读性就会大打折扣，比如下面这段代码：
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">if</span> activity.is_active <span style="color: #4f97d7; font-weight: bold;">and</span> activity.remaining &gt; <span style="color: #a45bad;">10</span> <span style="color: #4f97d7; font-weight: bold;">and</span> \
        user.is_active <span style="color: #4f97d7; font-weight: bold;">and</span> <span style="color: #4f97d7;">(</span>user.sex == <span style="color: #2d9574;">'female'</span> <span style="color: #4f97d7; font-weight: bold;">or</span> user.level &gt; <span style="color: #a45bad;">3</span><span style="color: #4f97d7;">)</span>:
    user.add_coins<span style="color: #4f97d7;">(</span><span style="color: #a45bad;">10000</span><span style="color: #4f97d7;">)</span>
    <span style="color: #4f97d7; font-weight: bold;">return</span>
</pre>
</div>
<p>
对于这样的代码，我们可以考虑将具体的分支逻辑封装成函数或者方法，来达到简化代码的目的：
</p>
<div class="org-src-container">
<pre class="src src-python">
<span style="color: #4f97d7; font-weight: bold;">if</span> activity.allow_new_user<span style="color: #4f97d7;">()</span> <span style="color: #4f97d7; font-weight: bold;">and</span> user.match_activity_condition<span style="color: #4f97d7;">()</span>:
    user.add_coins<span style="color: #4f97d7;">(</span><span style="color: #a45bad;">10000</span><span style="color: #4f97d7;">)</span>
    <span style="color: #4f97d7; font-weight: bold;">return</span>
</pre>
</div>
<p>
事实上，将代码改写后，之前的注释文字其实也可以去掉了。因为后面这段代码已经达到了自说明的目的。至于具体的 什么样的用户满足活动条件？ 这种问题，就应由具体的 match<sub>activity</sub><sub>condition</sub>() 方法来回答了。
</p>

<p>
Hint: 恰当的封装不光直接改善了代码的可读性，事实上，如果上面的活动判断逻辑在代码中出现了不止一次的话，封装更是必须的。不然重复代码会极大的破坏这段逻辑的可维护性。
</p>

<ol class="org-ol">
<li>留意不同分支下的重复代码</li>
</ol>
<p>
重复代码是代码质量的天敌，而条件分支语句又非常容易成为重复代码的重灾区。所以，当我们编写条件分支语句时，需要特别留意，不要生产不必要的重复代码。
</p>

<p>
让我们看下这个例子：
</p>
<div class="org-src-container">
<pre class="src src-python">
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#23545;&#20110;&#26032;&#29992;&#25143;&#65292;&#21019;&#24314;&#26032;&#30340;&#29992;&#25143;&#36164;&#26009;&#65292;&#21542;&#21017;&#26356;&#26032;&#26087;&#36164;&#26009;</span>
<span style="color: #4f97d7; font-weight: bold;">if</span> user.no_profile_exists:
    create_user_profile<span style="color: #4f97d7;">(</span>
        username=user.username,
        email=user.email,
        age=user.age,
        address=user.address,
        <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#23545;&#20110;&#26032;&#24314;&#29992;&#25143;&#65292;&#23558;&#29992;&#25143;&#30340;&#31215;&#20998;&#32622;&#20026; 0</span>
        points=<span style="color: #a45bad;">0</span>,
        created=now<span style="color: #bc6ec5;">()</span>,
    <span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7; font-weight: bold;">else</span>:
    update_user_profile<span style="color: #4f97d7;">(</span>
        username=user.username,
        email=user.email,
        age=user.age,
        address=user.address,
        updated=now<span style="color: #bc6ec5;">()</span>,
    <span style="color: #4f97d7;">)</span>
</pre>
</div>
<p>
在上面的代码中，我们可以一眼看出，在不同的分支下，程序调用了不同的函数，做了不一样的事情。但是，因为那些重复代码的存在，我们却很难简单的区分出，二者的不同点到底在哪。
</p>

<p>
其实，得益于 Python 的动态特性，我们可以简单的改写一下上面的代码，让可读性可以得到显著的提升：
</p>
<div class="org-src-container">
<pre class="src src-python">
<span style="color: #4f97d7; font-weight: bold;">if</span> user.no_profile_exists:
    <span style="color: #7590db;">profile_func</span> = create_user_profile
    <span style="color: #7590db;">extra_args</span> = <span style="color: #4f97d7;">{</span><span style="color: #2d9574;">'points'</span>: <span style="color: #a45bad;">0</span>, <span style="color: #2d9574;">'created'</span>: now<span style="color: #bc6ec5;">()</span><span style="color: #4f97d7;">}</span>
<span style="color: #4f97d7; font-weight: bold;">else</span>:
    <span style="color: #7590db;">profile_func</span> = update_user_profile
    <span style="color: #7590db;">extra_args</span> = <span style="color: #4f97d7;">{</span><span style="color: #2d9574;">'updated'</span>: now<span style="color: #bc6ec5;">()</span><span style="color: #4f97d7;">}</span>

profile_func<span style="color: #4f97d7;">(</span>
    username=user.username,
    email=user.email,
    age=user.age,
    address=user.address,
    **extra_args
<span style="color: #4f97d7;">)</span>
</pre>
</div>
<p>
当你编写分支代码时，请额外关注由分支产生的重复代码块，如果可以简单的消灭它们，那就不要迟疑。
</p>

<ol class="org-ol">
<li>谨慎使用三元表达式</li>
</ol>
<p>
三元表达式是 Python 2.5 版本后才支持的语法。在那之前，Python 社区一度认为三元表达式没有必要，我们需要使用 x and a or b 的方式来模拟它。[注]
</p>

<p>
事实是，在很多情况下，使用普通的 if/else 语句的代码可读性确实更好。盲目追求三元表达式很容易诱惑你写出复杂、可读性差的代码。
</p>

<p>
所以，请记得只用三元表达式处理简单的逻辑分支。
</p>

<p>
language = "python" if you.favor("dynamic") else "golang"
对于绝大多数情况，还是使用普通的 if/else 语句吧。
</p>

<p>
常见技巧
</p>
<ol class="org-ol">
<li>使用“德摩根定律”</li>
</ol>
<p>
在做分支判断时，我们有时候会写成这样的代码：
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7; font-weight: bold;">not</span> user.has_logged_in <span style="color: #4f97d7; font-weight: bold;">or</span> <span style="color: #4f97d7; font-weight: bold;">not</span> user.is_from_chrome:
    <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #2d9574;">"our service is only available for chrome logged in user"</span>
</pre>
</div>
<p>
第一眼看到代码时，是不是需要思考一会才能理解它想干嘛？这是因为上面的逻辑表达式里面出现了 2 个 not 和 1 个 or。而我们人类恰好不擅长处理过多的“否定”以及“或”这种逻辑关系。
</p>

<p>
这个时候，就该 德摩根定律 出场了。通俗的说，德摩根定律就是 not A or not B 等价于 not (A and B)。通过这样的转换，上面的代码可以改写成这样：
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7; font-weight: bold;">not</span> <span style="color: #4f97d7;">(</span>user.has_logged_in <span style="color: #4f97d7; font-weight: bold;">and</span> user.is_from_chrome<span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #2d9574;">"our service is only open for chrome logged in user"</span>
</pre>
</div>
<p>
怎么样，代码是不是易读了很多？记住德摩根定律，很多时候它对于简化条件分支里的代码逻辑非常有用。
</p>

<ol class="org-ol">
<li>自定义对象的“布尔真假”</li>
</ol>
<p>
我们常说，在 Python 里，“万物皆对象”。其实，不光“万物皆对象”，我们还可以利用很多魔法方法（文档中称为：user-defined method），来自定义对象的各种行为。我们可以用很多在别的语言里面无法做到、有些魔法的方式来影响代码的执行。
</p>

<p>
比如，Python 的所有对象都有自己的“布尔真假”：
</p>

<p>
布尔值为假的对象：None, 0, False, [], (), {}, set(), frozenset(), &#x2026; &#x2026;
布尔值为真的对象：非 0 的数值、True，非空的序列、元组，普通的用户类实例，&#x2026; &#x2026;
通过内建函数 bool()，你可以很方便的查看某个对象的布尔真假。而 Python 进行条件分支判断时用到的也是这个值：
</p>

<p>
&gt;&gt;&gt; bool(object())
True
重点来了，虽然所有用户类实例的布尔值都是真。但是 Python 提供了改变这个行为的办法：自定义类的 <span class="underline"><span class="underline">bool</span></span> 魔法方法 （在 Python 2.X 版本中为 <span class="underline"><span class="underline">nonzero__）。当类定义了 _<sub>bool</sub></span></span> 方法后，它的返回值将会被当作类实例的布尔值。
</p>

<p>
另外，_<sub>bool</sub>__ 不是影响实例布尔真假的唯一方法。如果类没有定义 <span class="underline"><span class="underline">bool</span></span> 方法，Python 还会尝试调用 <span class="underline"><span class="underline">len</span></span> 方法（也就是对任何序列对象调用 len 函数），通过结果是否为 0 判断实例真假。
</p>

<p>
那么这个特性有什么用呢？看看下面这段代码：
</p>
<div class="org-src-container">
<pre class="src src-python">
<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">UserCollection</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">object</span><span style="color: #4f97d7;">)</span>:

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, users<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">self</span>._users = users


<span style="color: #7590db;">users</span> = UserCollection<span style="color: #4f97d7;">(</span><span style="color: #bc6ec5;">[</span>piglei, raymond<span style="color: #bc6ec5;">]</span><span style="color: #4f97d7;">)</span>

<span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7;">len</span><span style="color: #4f97d7;">(</span>users._users<span style="color: #4f97d7;">)</span> &gt; <span style="color: #a45bad;">0</span>:
    <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"There's some users in collection!"</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
<p>
上面的代码里，判断 UserCollection 是否有内容时用到了 users.<sub>users</sub> 的长度。其实，通过为 UserCollection 添加 <span class="underline"><span class="underline">len</span></span> 魔法方法，上面的分支可以变得更简单：
</p>
<div class="org-src-container">
<pre class="src src-python">
<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">UserCollection</span>:

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, users<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">self</span>._users = users

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__len__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span><span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7;">len</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>._users<span style="color: #4f97d7;">)</span>


<span style="color: #7590db;">users</span> = UserCollection<span style="color: #4f97d7;">(</span><span style="color: #bc6ec5;">[</span>piglei, raymond<span style="color: #bc6ec5;">]</span><span style="color: #4f97d7;">)</span>

</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">if</span> users:
    <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"There's some users in collection!"</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
<p>
通过定义魔法方法 <span class="underline"><span class="underline">len</span></span> 和 <span class="underline"><span class="underline">bool</span></span> ，我们可以让类自己控制想要表现出的布尔真假值，让代码变得更 pythonic。
</p>

<ol class="org-ol">
<li>在条件判断中使用 all() / any()</li>
</ol>
<p>
all() 和 any() 两个函数非常适合在条件判断中使用。这两个函数接受一个可迭代对象，返回一个布尔值，其中：
</p>

<p>
all(seq)：仅当 seq 中所有对象都为布尔真时返回 True，否则返回 False
any(seq)：只要 seq 中任何一个对象为布尔真就返回 True，否则返回 False
假如我们有下面这段代码：
</p>
<div class="org-src-container">
<pre class="src src-python">
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">all_numbers_gt_10</span><span style="color: #4f97d7;">(</span>numbers<span style="color: #4f97d7;">)</span>:
    <span style="color: #9f8766;">"""&#20165;&#24403;&#24207;&#21015;&#20013;&#25152;&#26377;&#25968;&#23383;&#22823;&#20110; 10 &#26102;&#65292;&#36820;&#22238; True</span>
<span style="color: #9f8766;">    """</span>
    <span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7; font-weight: bold;">not</span> numbers:
        <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #a45bad;">False</span>

    <span style="color: #4f97d7; font-weight: bold;">for</span> n <span style="color: #4f97d7; font-weight: bold;">in</span> numbers:
        <span style="color: #4f97d7; font-weight: bold;">if</span> n &lt;= <span style="color: #a45bad;">10</span>:
            <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #a45bad;">False</span>
    <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #a45bad;">True</span>
</pre>
</div>
<p>
如果使用 all() 内建函数，再配合一个简单的生成器表达式，上面的代码可以写成这样：
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">all_numbers_gt_10_2</span><span style="color: #4f97d7;">(</span>numbers<span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7;">bool</span><span style="color: #4f97d7;">(</span>numbers<span style="color: #4f97d7;">)</span> <span style="color: #4f97d7; font-weight: bold;">and</span> <span style="color: #4f97d7;">all</span><span style="color: #4f97d7;">(</span>n &gt; <span style="color: #a45bad;">10</span> <span style="color: #4f97d7; font-weight: bold;">for</span> n <span style="color: #4f97d7; font-weight: bold;">in</span> numbers<span style="color: #4f97d7;">)</span>    
</pre>
</div>
<p>
简单、高效，同时也没有损失可用性。
</p>

<ol class="org-ol">
<li>使用 try/while/for 中 else 分支</li>
</ol>
<p>
让我们看看这个函数
</p>
<div class="org-src-container">
<pre class="src src-python">&#65306;

<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">do_stuff</span><span style="color: #4f97d7;">()</span>:
    <span style="color: #7590db;">first_thing_successed</span> = <span style="color: #a45bad;">False</span>
    <span style="color: #4f97d7; font-weight: bold;">try</span>:
        do_the_first_thing<span style="color: #4f97d7;">()</span>
        <span style="color: #7590db;">first_thing_successed</span> = <span style="color: #a45bad;">True</span>
    <span style="color: #4f97d7; font-weight: bold;">except</span> <span style="color: #ce537a; font-weight: bold;">Exception</span> <span style="color: #4f97d7; font-weight: bold;">as</span> e:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"Error while calling do_some_thing"</span><span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7; font-weight: bold;">return</span>

    <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#20165;&#24403; first_thing &#25104;&#21151;&#23436;&#25104;&#26102;&#65292;&#20570;&#31532;&#20108;&#20214;&#20107;</span>
    <span style="color: #4f97d7; font-weight: bold;">if</span> first_thing_successed:
        <span style="color: #4f97d7; font-weight: bold;">return</span> do_the_second_thing<span style="color: #4f97d7;">()</span>
</pre>
</div>
<p>
在函数 do<sub>stuff</sub> 中，我们希望只有当 do<sub>the</sub><sub>first</sub><sub>thing</sub>() 成功调用后（也就是不抛出任何异常），才继续做第二个函数调用。为了做到这一点，我们需要定义一个额外的变量 first<sub>thing</sub><sub>successed</sub> 来作为标记。
</p>

<p>
其实，我们可以用更简单的方法达到同样的效果：
</p>
<div class="org-src-container">
<pre class="src src-python">
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">do_stuff</span><span style="color: #4f97d7;">()</span>:
    <span style="color: #4f97d7; font-weight: bold;">try</span>:
        do_the_first_thing<span style="color: #4f97d7;">()</span>
    <span style="color: #4f97d7; font-weight: bold;">except</span> <span style="color: #ce537a; font-weight: bold;">Exception</span> <span style="color: #4f97d7; font-weight: bold;">as</span> e:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"Error while calling do_some_thing"</span><span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7; font-weight: bold;">return</span>
    <span style="color: #4f97d7; font-weight: bold;">else</span>:
        <span style="color: #4f97d7; font-weight: bold;">return</span> do_the_second_thing<span style="color: #4f97d7;">()</span>
</pre>
</div>
<p>
在 try 语句块最后追加上 else 分支后，分支下的do<sub>the</sub><sub>second</sub><sub>thing</sub>() 便只会在 try 下面的所有语句正常执行（也就是没有异常，没有 return、break 等）完成后执行。
</p>

<p>
类似的，Python 里的 for/while 循环也支持添加 else 分支，它们表示：当循环使用的迭代对象被正常耗尽、或 while 循环使用的条件变量变为 False 后才执行 else 分支下的代码。
</p>

<p>
常见陷阱
</p>
<ol class="org-ol">
<li>与 None 值的比较</li>
</ol>
<p>
在 Python 中，有两种比较变量的方法：== 和 is，二者在含义上有着根本的区别：
</p>

<p>
==：表示二者所指向的的值是否一致
is：表示二者是否指向内存中的同一份内容，也就是 id(x) 是否等于 id(y)
None 在 Python 语言中是一个单例对象，如果你要判断某个变量是否为 None 时，记得使用 is 而不是 ==，因为只有 is 才能在严格意义上表示某个变量是否是 None。
</p>

<p>
否则，可能出现下面这样的情况：
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Foo</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">object</span><span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__eq__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, other<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #a45bad;">True</span>

<span style="color: #7590db;">foo</span> = Foo<span style="color: #4f97d7;">()</span>
foo == <span style="color: #a45bad;">None</span>
<span style="color: #a45bad;">True</span>
</pre>
</div>

<p>
在上面代码中，Foo 这个类通过自定义 <span class="underline"><span class="underline">eq</span></span> 魔法方法的方式，很容易就满足了 == None 这个条件。
</p>

<p>
所以，当你要判断某个变量是否为 None 时，请使用 is 而不是 ==。
</p>

<ol class="org-ol">
<li>留意 and 和 or 的运算优先级</li>
</ol>
<p>
看看下面这两个表达式，猜猜它们的值一样吗？
</p>
<div class="org-src-container">
<pre class="src src-python">&gt;&gt;&gt; <span style="color: #4f97d7;">(</span><span style="color: #a45bad;">True</span> <span style="color: #4f97d7; font-weight: bold;">or</span> <span style="color: #a45bad;">False</span><span style="color: #4f97d7;">)</span> <span style="color: #4f97d7; font-weight: bold;">and</span> <span style="color: #a45bad;">False</span>
&gt;&gt;&gt; <span style="color: #a45bad;">True</span> <span style="color: #4f97d7; font-weight: bold;">or</span> <span style="color: #a45bad;">False</span> <span style="color: #4f97d7; font-weight: bold;">and</span> <span style="color: #a45bad;">False</span>
</pre>
</div>
<p>
答案是：不一样，它们的值分别是 False 和 True，你猜对了吗？
</p>

<p>
问题的关键在于：and 运算符的优先级大于 or。因此上面的第二个表达式在 Python 看来实际上是 True or (False and False)。所以结果是 True 而不是 False。
</p>

<p>
在编写包含多个 and 和 or 的表达式时，请额外注意 and 和 or 的运算优先级。即使执行优先级正好是你需要的那样，你也可以加上额外的括号来让代码更清晰。
</p>
</div>
</div>

<div id="outline-container-org5e3cfab" class="outline-2">
<h2 id="org5e3cfab"><span class="section-number-2">16</span> June 22, 2021</h2>
<div class="outline-text-2" id="text-16">
</div>
<div id="outline-container-org5fef00f" class="outline-3">
<h3 id="org5fef00f"><span class="section-number-3">16.1</span> generator</h3>
<div class="outline-text-3" id="text-16-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Fab</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">object</span><span style="color: #4f97d7;">)</span>: 

   <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, <span style="color: #4f97d7;">max</span><span style="color: #4f97d7;">)</span>: 
       <span style="color: #4f97d7; font-weight: bold;">self</span>.<span style="color: #4f97d7;">max</span> = <span style="color: #4f97d7;">max</span> 
       <span style="color: #4f97d7; font-weight: bold;">self</span>.n, <span style="color: #4f97d7; font-weight: bold;">self</span>.a, <span style="color: #4f97d7; font-weight: bold;">self</span>.b = <span style="color: #a45bad;">0</span>, <span style="color: #a45bad;">0</span>, <span style="color: #a45bad;">1</span> 

   <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__iter__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span><span style="color: #4f97d7;">)</span>: 
       <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">self</span> 

   <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">next</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span><span style="color: #4f97d7;">)</span>: 
       <span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7; font-weight: bold;">self</span>.n &lt; <span style="color: #4f97d7; font-weight: bold;">self</span>.<span style="color: #4f97d7;">max</span>: 
           <span style="color: #7590db;">r</span> = <span style="color: #4f97d7; font-weight: bold;">self</span>.b 
           <span style="color: #4f97d7; font-weight: bold;">self</span>.a, <span style="color: #4f97d7; font-weight: bold;">self</span>.b = <span style="color: #4f97d7; font-weight: bold;">self</span>.b, <span style="color: #4f97d7; font-weight: bold;">self</span>.a + <span style="color: #4f97d7; font-weight: bold;">self</span>.b 
           <span style="color: #4f97d7; font-weight: bold;">self</span>.n = <span style="color: #4f97d7; font-weight: bold;">self</span>.n + <span style="color: #a45bad;">1</span> 
           <span style="color: #4f97d7; font-weight: bold;">return</span> r 
       <span style="color: #4f97d7; font-weight: bold;">raise</span> <span style="color: #ce537a; font-weight: bold;">StopIteration</span><span style="color: #4f97d7;">()</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">the previous one is equal to</span>
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">fab</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">max</span><span style="color: #4f97d7;">)</span>: 
    <span style="color: #7590db;">n</span>, <span style="color: #7590db;">a</span>, <span style="color: #7590db;">b</span> = <span style="color: #a45bad;">0</span>, <span style="color: #a45bad;">0</span>, <span style="color: #a45bad;">1</span> 
    <span style="color: #4f97d7; font-weight: bold;">while</span> n &lt; <span style="color: #4f97d7;">max</span>: 
        <span style="color: #4f97d7; font-weight: bold;">yield</span> b 
        <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">print b </span>
        <span style="color: #7590db;">a</span>, <span style="color: #7590db;">b</span> = b, a + b 
        <span style="color: #7590db;">n</span> = n + <span style="color: #a45bad;">1</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">yield &#30340;&#20316;&#29992;&#23601;&#26159;&#25226;&#19968;&#20010;&#20989;&#25968;&#21464;&#25104;&#19968;&#20010; generator&#65292;&#24102;&#26377; yield &#30340;&#20989;&#25968;&#19981;&#20877;&#26159;&#19968;&#20010;&#26222;&#36890;&#20989;&#25968;&#65292;Python &#35299;&#37322;&#22120;&#20250;&#23558;&#20854;&#35270;&#20026;&#19968;&#20010;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">generator&#65292;&#35843;&#29992; fab(5) &#19981;&#20250;&#25191;&#34892; fab &#20989;&#25968;&#65292;&#32780;&#26159;&#36820;&#22238;&#19968;&#20010; iterable &#23545;&#35937;&#65281;&#22312; for &#24490;&#29615;&#25191;&#34892;&#26102;&#65292;&#27599;&#27425;&#24490;&#29615;&#37117;&#20250;&#25191;&#34892; fab</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#20989;&#25968;&#20869;&#37096;&#30340;&#20195;&#30721;&#65292;&#25191;&#34892;&#21040; yield b &#26102;&#65292;fab &#20989;&#25968;&#23601;&#36820;&#22238;&#19968;&#20010;&#36845;&#20195;&#20540;&#65292;&#19979;&#27425;&#36845;&#20195;&#26102;&#65292;&#20195;&#30721;&#20174; yield b &#30340;&#19979;&#19968;&#26465;&#35821;&#21477;&#32487;&#32493;&#25191;&#34892;&#65292;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#32780;&#20989;&#25968;&#30340;&#26412;&#22320;&#21464;&#37327;&#30475;&#36215;&#26469;&#21644;&#19978;&#27425;&#20013;&#26029;&#25191;&#34892;&#21069;&#26159;&#23436;&#20840;&#19968;&#26679;&#30340;&#65292;&#20110;&#26159;&#20989;&#25968;&#32487;&#32493;&#25191;&#34892;&#65292;&#30452;&#21040;&#20877;&#27425;&#36935;&#21040; yield&#12290;</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#19968;&#20010;&#24102;&#26377; yield &#30340;&#20989;&#25968;&#23601;&#26159;&#19968;&#20010; generator&#65292;&#23427;&#21644;&#26222;&#36890;&#20989;&#25968;&#19981;&#21516;&#65292;&#29983;&#25104;&#19968;&#20010; generator &#30475;&#36215;&#26469;&#20687;&#20989;&#25968;&#35843;&#29992;&#65292;&#20294;&#19981;&#20250;&#25191;&#34892;&#20219;&#20309;&#20989;&#25968;&#20195;&#30721;&#65292;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#30452;&#21040;&#23545;&#20854;&#35843;&#29992; next()&#65288;&#22312; for &#24490;&#29615;&#20013;&#20250;&#33258;&#21160;&#35843;&#29992; next()&#65289;&#25165;&#24320;&#22987;&#25191;&#34892;&#12290;&#34429;&#28982;&#25191;&#34892;&#27969;&#31243;&#20173;&#25353;&#20989;&#25968;&#30340;&#27969;&#31243;&#25191;&#34892;&#65292;&#20294;&#27599;&#25191;&#34892;&#21040;&#19968;&#20010; yield</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#35821;&#21477;&#23601;&#20250;&#20013;&#26029;&#65292;&#24182;&#36820;&#22238;&#19968;&#20010;&#36845;&#20195;&#20540;&#65292;&#19979;&#27425;&#25191;&#34892;&#26102;&#20174; yield &#30340;&#19979;&#19968;&#20010;&#35821;&#21477;&#32487;&#32493;&#25191;&#34892;&#12290;&#30475;&#36215;&#26469;&#23601;&#22909;&#20687;&#19968;&#20010;&#20989;&#25968;&#22312;&#27491;&#24120;&#25191;&#34892;&#30340;&#36807;&#31243;&#20013;&#34987; yield</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#20013;&#26029;&#20102;&#25968;&#27425;&#65292;&#27599;&#27425;&#20013;&#26029;&#37117;&#20250;&#36890;&#36807; yield &#36820;&#22238;&#24403;&#21069;&#30340;&#36845;&#20195;&#20540;&#12290;</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">return &#30340;&#20316;&#29992;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#22312;&#19968;&#20010; generator function &#20013;&#65292;&#22914;&#26524;&#27809;&#26377; return&#65292;&#21017;&#40664;&#35748;&#25191;&#34892;&#33267;&#20989;&#25968;&#23436;&#27605;&#65292;&#22914;&#26524;&#22312;&#25191;&#34892;&#36807;&#31243;&#20013; return&#65292;&#21017;&#30452;&#25509;&#25243;&#20986; StopIteration &#32456;&#27490;&#36845;&#20195;&#12290;</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-org243e19e" class="outline-3">
<h3 id="org243e19e"><span class="section-number-3">16.2</span> 包导入</h3>
<div class="outline-text-3" id="text-16-2">
</div>
<div id="outline-container-org2670e65" class="outline-4">
<h4 id="org2670e65"><span class="section-number-4">16.2.1</span> 模块内置属性</h4>
<div class="outline-text-4" id="text-16-2-1">
</div>
<ol class="org-ol">
<li><a id="orgeb0c7b8"></a>   name   直接运行本模块，   name   值为   main   ；import module，   name   值为模块名字。<br /></li>
<li><a id="org7fa3ced"></a>   file   当前 module的绝对路径<br /></li>
<li><a id="orgf4fb5b8"></a>   dict   <br /></li>
<li><a id="org6ca7619"></a>   doc   <br /></li>
<li><a id="org08626ca"></a>   package   <br /></li>
<li><a id="org94a4c6c"></a>   path   <br /></li>
</ol>
</div>
<div id="outline-container-orgda5495d" class="outline-4">
<h4 id="orgda5495d"><span class="section-number-4">16.2.2</span> 绝对导入：所有的模块import都从“根节点”开始。根节点的位置由sys.path中的路径决定，项目的根目录一般自动在sys.path中。如果希望程序能处处执行，需手动修改sys.</h4>
<div class="outline-text-4" id="text-16-2-2">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">import</span> sys,os
<span style="color: #7590db;">BASE_DIR</span> = os.path.dirname<span style="color: #4f97d7;">(</span>os.path.abspath<span style="color: #bc6ec5;">(</span>__file__<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span><span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#23384;&#25918;c.py&#25152;&#22312;&#30340;&#32477;&#23545;&#36335;&#24452;</span>
sys.path.append<span style="color: #4f97d7;">(</span>BASE_DIR<span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7; font-weight: bold;">from</span> B.B1 <span style="color: #4f97d7; font-weight: bold;">import</span> b1<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#23548;&#20837;B&#21253;&#20013;&#23376;&#21253;B1&#20013;&#30340;&#27169;&#22359;b1</span>

</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org5309f93" class="outline-2">
<h2 id="org5309f93"><span class="section-number-2">17</span> python learning material url</h2>
<div class="outline-text-2" id="text-17">
</div>
<div id="outline-container-org7e37166" class="outline-3">
<h3 id="org7e37166"><span class="section-number-3">17.1</span> <span class="todo TODO">TODO</span> <a href="https://www.zlovezl.cn/articles/write-solid-python-codes-part-1/">https://www.zlovezl.cn/articles/write-solid-python-codes-part-1/</a></h3>
</div>
<div id="outline-container-org794cdde" class="outline-3">
<h3 id="org794cdde"><span class="section-number-3">17.2</span> <span class="todo TODO">TODO</span> <a href="https://blog.csdn.net/liuchunming033/category_1348374.html">https://blog.csdn.net/liuchunming033/category_1348374.html</a></h3>
</div>
<div id="outline-container-org2b82804" class="outline-3">
<h3 id="org2b82804"><span class="section-number-3">17.3</span> <span class="todo TODO">TODO</span> <a href="https://develop.spacemacs.org/">https://develop.spacemacs.org/</a></h3>
</div>
</div>



<div id="outline-container-org5f0ae26" class="outline-2">
<h2 id="org5f0ae26"><span class="section-number-2">18</span> Descriptor</h2>
<div class="outline-text-2" id="text-18">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Animal</span>:
    <span style="color: #7590db;">name</span> = <span style="color: #2d9574;">'&#32769;&#34382;'</span>
    <span style="color: #7590db;">unique</span> = <span style="color: #a45bad;">0</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, name=<span style="color: #2d9574;">'&#32769;&#34382;'</span>, age=<span style="color: #a45bad;">5</span><span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">self</span>.name = name
        <span style="color: #4f97d7; font-weight: bold;">self</span>.age = age
        <span style="color: #4f97d7; font-weight: bold;">self</span>.weight = <span style="color: #a45bad;">200</span>

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">eat</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span><span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">self</span>.height = <span style="color: #a45bad;">100</span>
        <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #2d9574;">'&#25105;&#38656;&#35201;&#21507;&#19996;&#35199;&#65281;'</span>

    @<span style="color: #4f97d7;">classmethod</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">sleep</span><span style="color: #4f97d7;">(</span>cls<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #2d9574;">'&#25105;&#38656;&#35201;&#30561;&#35273;'</span>

<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Dog</span><span style="color: #4f97d7;">(</span>Animal<span style="color: #4f97d7;">)</span>:

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, age<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">self</span>.age = age

<span style="color: #7590db;">a</span> = Animal<span style="color: #4f97d7;">()</span>
<span style="color: #7590db;">d</span> = Dog<span style="color: #4f97d7;">(</span><span style="color: #a45bad;">8</span><span style="color: #4f97d7;">)</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">dict_keys(['__module__', 'name', 'unique', '__init__', 'eat', 'sleep', '__dict__', '__weakref__', '__doc__'])</span>
<span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>Animal.<span style="color: #4f97d7;">__dict__</span>.keys<span style="color: #bc6ec5;">()</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>a.<span style="color: #4f97d7;">__dict__</span>.keys<span style="color: #bc6ec5;">()</span><span style="color: #4f97d7;">)</span>     <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">dict_keys(['name', 'age', 'weight']), it does not include the 'unique' attribute</span>
<span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>Dog.<span style="color: #4f97d7;">__dict__</span>.keys<span style="color: #bc6ec5;">()</span><span style="color: #4f97d7;">)</span>   <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">dict_keys(['__module__', '__init__', '__doc__'])</span>
<span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>d.<span style="color: #4f97d7;">__dict__</span>.keys<span style="color: #bc6ec5;">()</span><span style="color: #4f97d7;">)</span>     <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">dict_keys(['age'])</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#23454;&#20363;&#26159;&#21487;&#20197;&#35775;&#38382;&#31867;&#30340;&#25104;&#21592;&#30340;&#65292;&#20294;&#26159;&#31867;&#19981;&#33021;&#35775;&#38382;&#23454;&#20363;&#25104;&#21592;; &#23376;&#31867;&#32487;&#25215;&#29238;&#31867;&#30340;&#31867;&#25104;&#21592;&#21644;&#23454;&#20363;&#25104;&#21592;&#12290;</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#24635;&#32467;&#65306;&#23545;&#35937;&#23646;&#24615;&#30340;&#35775;&#38382;&#20248;&#20808;&#32423;&#39034;&#24207;&#20026;&#65306;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#9312;.&#23454;&#20363;&#23646;&#24615;, d.age access the obj attribute</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#9313;.&#31867;&#23646;&#24615;, a.unique</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#9314;.&#29238;&#31867;&#30340;&#31867;&#23646;&#24615;, a.unique</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#9315;.__getattr__()&#26041;&#27861;</span>
</pre>
</div>
</div>
<div id="outline-container-org44ac86e" class="outline-3">
<h3 id="org44ac86e"><span class="section-number-3">18.1</span> `_<sub>getattribute</sub>__、_<sub>getattr</sub>__、_<sub>setattr</sub>__、_<sub>delattr</sub>__</h3>
<div class="outline-text-3" id="text-18-1">
</div>
<div id="outline-container-org099f14d" class="outline-4">
<h4 id="org099f14d"><span class="section-number-4">18.1.1</span> _<sub>getsttribute</sub>_<sub>方法</sub>：当一个属性被访问的时候发生的行为，称之为“属性拦截器”</h4>
</div>
<div id="outline-container-orgaa4598a" class="outline-4">
<h4 id="orgaa4598a"><span class="section-number-4">18.1.2</span> Python中只要定义了继承object的类，就默认存在属性拦截器，只不过是拦截后没有进行任何操作，而是直接返回。_<sub>getattribute</sub>_<sub>允许我们在访问对象属性时自定义访问行为</sub>，但是使用它特别要小心无限递归的问题。</h4>
</div>
<div id="outline-container-org522afe5" class="outline-4">
<h4 id="org522afe5"><span class="section-number-4">18.1.3</span> 重写_<sub>getattribute</sub>__。需要注意的是重写的方法中不能, 使用对象的点运算符访问属性，会再次调用_<sub>getattribute</sub>__。可以使用super()方法避免这个问题。return super(Dog, self)._<sub>getattribute</sub>_<sub>(key)</sub></h4>
<div class="outline-text-4" id="text-18-1-3">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__getattribute__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, key<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">if</span> key==<span style="color: #2d9574;">'sound'</span>:
            <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'sound&#26041;&#27861;&#34987;&#35843;&#29992;&#20102;'</span><span style="color: #4f97d7;">)</span>
            <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">self</span>.sound<span style="color: #4f97d7;">()</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">self.sound will call `__getattribute__ again and it calls `__getattribute__ infinitely.</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org548ded8" class="outline-4">
<h4 id="org548ded8"><span class="section-number-4">18.1.4</span> 一定要在每一个需要访问的属性里面设置返回值，否则会返回None，一般有两种做法，即返回父类的_<sub>getattribute</sub>_<sub>方法</sub>。</h4>
<div class="outline-text-4" id="text-18-1-4">
</div>
<ol class="org-ol">
<li><a id="org36f6e1f"></a>return super(Dog, self)._<sub>getattribute</sub>_<sub>(key)</sub>这种形式<br /></li>
<li><a id="org6cbf43e"></a>return object._<sub>getattribute</sub>_<sub>(self,key)</sub><br /></li>
</ol>
</div>
</div>
<div id="outline-container-orgbda9ad1" class="outline-3">
<h3 id="orgbda9ad1"><span class="section-number-3">18.2</span> 不要再在_<sub>getattribute</sub>_<sub>方法的定义内部显示使用self.成员</sub>, 否则引发死循环</h3>
</div>
<div id="outline-container-orgd9b34e9" class="outline-3">
<h3 id="orgd9b34e9"><span class="section-number-3">18.3</span> `_<sub>getattr</sub>__, `_<sub>setattr</sub>___, `_<sub>delattr</sub>__</h3>
<div class="outline-text-3" id="text-18-3">
</div>
<div id="outline-container-orgc091720" class="outline-4">
<h4 id="orgc091720"><span class="section-number-4">18.3.1</span> _<sub>getattr</sub>_<sub>可以用来在当用户试图访问一个根本不存在</sub>（或者暂时不存在）的属性时，来定义类的行为. Automatically return None if not defined</h4>
</div>
<div id="outline-container-org6cec782" class="outline-4">
<h4 id="org6cec782"><span class="section-number-4">18.3.2</span> 而_<sub>getattr</sub>_<sub>仅仅针对的是属性</sub>，不针对方法，即访问未存在的方法的时候依然还是会报错。</h4>
</div>
<div id="outline-container-org975c62b" class="outline-4">
<h4 id="org975c62b"><span class="section-number-4">18.3.3</span> _<sub>getattribute</sub>_<sub>针对的是访问已经存在的</sub>（属性和方法）；_<sub>getattr</sub>_<sub>针对的是访问未存在的</sub>（属性）。</h4>
</div>
<div id="outline-container-orgb875af5" class="outline-4">
<h4 id="orgb875af5"><span class="section-number-4">18.3.4</span> _<sub>getattribute</sub>_<sub>和</sub>_<sub>getattr</sub>_<sub>虽然针对每一个访问的key</sub>，一定要有对应的返回值（参见前文），但是返回的东西却不是一样的，即_<sub>getattribute</sub>_<sub>返回父类的</sub>_<sub>getattribute</sub>_<sub>函数</sub>，而_<sub>getattr</sub>_<sub>返回我希望为未知属性设置的那个值或者是异常信息</sub>。</h4>
</div>
</div>
<div id="outline-container-org9fc6648" class="outline-3">
<h3 id="org9fc6648"><span class="section-number-3">18.4</span> _<sub>setattr</sub>_<sub>(self, name, value)</sub></h3>
<div class="outline-text-3" id="text-18-4">
</div>
<div id="outline-container-org71ef234" class="outline-4">
<h4 id="org71ef234"><span class="section-number-4">18.4.1</span> _<sub>setattr</sub>_<sub>方法允许定义为某个属性赋值的时候所发生行为</sub>，不管这个属性存在与否，都可以对任意属性的任何变化都定义自己的规则。</h4>
</div>
<div id="outline-container-org68ed80d" class="outline-4">
<h4 id="org68ed80d"><span class="section-number-4">18.4.2</span> 即使在_<sub>init</sub>_<sub>()</sub>内的属性赋值也会调用_<sub>setattr</sub>_<sub>方法</sub></h4>
</div>
<div id="outline-container-orgf33721e" class="outline-4">
<h4 id="orgf33721e"><span class="section-number-4">18.4.3</span> 只要是属性被修改或者是赋值，不管这个属性是实例属性、类属性、父类的类属性；亦或者是已经存在的属性、不存在的属性，只要是修改和赋值，都会调用到_<sub>steattr</sub>_<sub>方法</sub>。</h4>
</div>
<div id="outline-container-org6d4294b" class="outline-4">
<h4 id="org6d4294b"><span class="section-number-4">18.4.4</span> 关于_<sub>setattr</sub>_<sub>有一点需要说明</sub>，不能写成类似self.name = “张三”这样的形式，这样的赋值语句会调用_<sub>setattr</sub>_<sub>方法</sub>，这样会让其陷入无限递归，参见前文的_<sub>getattribute</sub>_<sub>方法出现无限递归</sub></h4>
</div>
</div>
<div id="outline-container-org3c32032" class="outline-3">
<h3 id="org3c32032"><span class="section-number-3">18.5</span> _<sub>delattr</sub>_<sub>(self, name)</sub></h3>
<div class="outline-text-3" id="text-18-5">
</div>
<div id="outline-container-org88d6047" class="outline-4">
<h4 id="org88d6047"><span class="section-number-4">18.5.1</span> _<sub>delattr</sub>_<sub>用于处理删除属性时的行为</sub>。和_<sub>setattr</sub>_<sub>方法要注意无限递归的问题</sub>，重写该方法时不要有类似del self.name的写法。</h4>
<div class="outline-text-4" id="text-18-5-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Animal</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">object</span><span style="color: #4f97d7;">)</span>:
    <span style="color: #7590db;">run</span> = <span style="color: #2d9574;">'&#25105;&#20250;&#36305;'</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">die</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span><span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #2d9574;">'&#25105;&#20250;&#27515;'</span>
<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Dog</span><span style="color: #4f97d7;">(</span>Animal<span style="color: #4f97d7;">)</span>:
    <span style="color: #7590db;">color</span>=<span style="color: #2d9574;">'Blue'</span>
   <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, name,age<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">self</span>.name=name
        <span style="color: #4f97d7; font-weight: bold;">self</span>.age = age
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__delattr__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, key<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'&#25105;&#34987;&#21024;&#38500;&#21862;&#65281;'</span><span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7;">super</span><span style="color: #4f97d7;">(</span>Dog,<span style="color: #4f97d7; font-weight: bold;">self</span><span style="color: #4f97d7;">)</span>.__delattr__<span style="color: #4f97d7;">(</span>key<span style="color: #4f97d7;">)</span>

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">sound</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span><span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #2d9574;">"&#27754;&#27754;&#27754;"</span>

<span style="color: #7590db;">dog</span>=Dog<span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'&#27888;&#36842;'</span>,<span style="color: #a45bad;">4</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7; font-weight: bold;">del</span> dog.age
</pre>
</div>
</div>
</div>
<div id="outline-container-orgbc0d7a3" class="outline-4">
<h4 id="orgbc0d7a3"><span class="section-number-4">18.5.2</span> _<sub>delattr</sub>_<sub>只能够删除</sub> 已经存在的、实例属性，对于不存在的属性和类属性(因为它是属于类的)是不能够删除的。</h4>
</div>
</div>
</div>
<div id="outline-container-orge515ed8" class="outline-2">
<h2 id="orge515ed8"><span class="section-number-2">19</span> Descriptor</h2>
<div class="outline-text-2" id="text-19">
</div>
<div id="outline-container-orgfac91e8" class="outline-3">
<h3 id="orgfac91e8"><span class="section-number-3">19.1</span> 描述符：某个类，只要是内部定义了方法 `_<sub>get</sub>_<sub>,并定义了</sub> <span class="underline">`_<sub>set</sub>__</span>, <span class="underline">`_<sub>delete</sub>__</span> 中的一个或多个</h3>
</div>
<div id="outline-container-org32431a5" class="outline-3">
<h3 id="org32431a5"><span class="section-number-3">19.2</span> 非数据描述器: 仅定义了 _<sub>get</sub>_<sub>()</sub> 的描述器称为非数据描述器</h3>
<div class="outline-text-3" id="text-19-2">
</div>
<div id="outline-container-orgd3e728f" class="outline-4">
<h4 id="orgd3e728f"><span class="section-number-4">19.2.1</span> 非描述器常用于类的方法，如常见的 staticmethod 和 classmethod，都是其应用</h4>
</div>
<div id="outline-container-org39fa1b8" class="outline-4">
<h4 id="org39fa1b8"><span class="section-number-4">19.2.2</span> 函数定义了`_<sub>get</sub>__'方法，所以也是非数据描述符</h4>
</div>
</div>
<div id="outline-container-orge7bb229" class="outline-3">
<h3 id="orge7bb229"><span class="section-number-3">19.3</span> 数据描述器: 如果一个对象定义了 _<sub>set</sub>_<sub>()</sub> 或 _<sub>delete</sub>_<sub>()</sub>，则它会被视为数据描述器</h3>
</div>
<div id="outline-container-orga755243" class="outline-3">
<h3 id="orga755243"><span class="section-number-3">19.4</span> 描述符对象：描述符（即一个类，因为描述符的本质是类）的一个对象，一般是作为其他类对象的属性而存在</h3>
<div class="outline-text-3" id="text-19-4">
</div>
<div id="outline-container-orge3f0604" class="outline-4">
<h4 id="orge3f0604"><span class="section-number-4">19.4.1</span> 绑定行为：所谓的绑定行为，是指在属性的访问、赋值、删除时还绑定发生了其他的事情，正如前面属性控制三剑客所完成的事情一样；</h4>
</div>
<div id="outline-container-orgbbe4986" class="outline-4">
<h4 id="orgbbe4986"><span class="section-number-4">19.4.2</span> 托管属性：python描述符是一种创建“托管属性”的方法，即通过描述符（类）去托管另一个类的相关属性，也可以说是类的属性的一个代理。所谓的描述符（描述类）就是专门再创建一个类，让这个类去描述本身那个类的相关属性.</h4>
</div>
</div>
<div id="outline-container-orgb393b2b" class="outline-3">
<h3 id="orgb393b2b"><span class="section-number-3">19.5</span> 描述符三个函数的定义形式：</h3>
<div class="outline-text-3" id="text-19-5">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">def __get__(self, instance, owner)</span>
<span style="color: #2aa1ae; background-color: #292e34;">#      </span><span style="color: #2aa1ae; background-color: #292e34;">self: &#25351;&#30340;&#26159;&#25551;&#36848;&#31526;&#31867;&#30340;&#23454;&#20363;</span>
<span style="color: #2aa1ae; background-color: #292e34;">#      </span><span style="color: #2aa1ae; background-color: #292e34;">instance&#65306;&#25351;&#30340;&#26159;&#20351;&#29992;&#25551;&#36848;&#31526;&#30340;&#37027;&#20010;&#31867;&#30340;&#23454;&#20363;&#65292;&#22914;student&#12290;&#19979;&#38754;&#30340;instance&#19968;&#26679;&#30340;&#24847;&#24605;&#12290;</span>
<span style="color: #2aa1ae; background-color: #292e34;">#      </span><span style="color: #2aa1ae; background-color: #292e34;">owner&#65306;&#25351;&#30340;&#26159;&#20351;&#29992;&#25551;&#36848;&#31526;&#30340;&#37027;&#20010;&#31867;&#65292;&#22914;Student</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">def __set__(self, instance, value)</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">def __delete__(self, instance)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgffff9c2" class="outline-3">
<h3 id="orgffff9c2"><span class="section-number-3">19.6</span> 描述符是一个类属性，必须定义在类的层次上, 而不能单纯的定义为对象属性。</h3>
</div>
<div id="outline-container-org0bfddff" class="outline-3">
<h3 id="org0bfddff"><span class="section-number-3">19.7</span> 属性的优先访问级别总结:</h3>
<div class="outline-text-3" id="text-19-7">
</div>
<div id="outline-container-org332bd7b" class="outline-4">
<h4 id="org332bd7b"><span class="section-number-4">19.7.1</span> (1) _<sub>getattribute</sub>_<sub>()</sub>， 无条件调用，任何时候都先调用</h4>
</div>
<div id="outline-container-org3b35035" class="outline-4">
<h4 id="org3b35035"><span class="section-number-4">19.7.2</span> (2) 实例属性</h4>
</div>
<div id="outline-container-org66264d7" class="outline-4">
<h4 id="org66264d7"><span class="section-number-4">19.7.3</span> (3) 类属性</h4>
</div>
<div id="outline-container-org0b38881" class="outline-4">
<h4 id="org0b38881"><span class="section-number-4">19.7.4</span> (4) 父类属性</h4>
</div>
<div id="outline-container-org91599d2" class="outline-4">
<h4 id="org91599d2"><span class="section-number-4">19.7.5</span> (5) _<sub>getattr</sub>_<sub>()</sub> 方法  #如果所有的属性都没有搜索到，则才会调用该函数</h4>
</div>
</div>
<div id="outline-container-org603b3d2" class="outline-3">
<h3 id="org603b3d2"><span class="section-number-3">19.8</span> 实例属性查询优先级：</h3>
<div class="outline-text-3" id="text-19-8">
</div>
<div id="outline-container-org22845ab" class="outline-4">
<h4 id="org22845ab"><span class="section-number-4">19.8.1</span> (1).obj._<sub>getattribute</sub>_<sub>()</sub></h4>
</div>
<div id="outline-container-org63e9a83" class="outline-4">
<h4 id="org63e9a83"><span class="section-number-4">19.8.2</span> (2).数据描述符</h4>
</div>
<div id="outline-container-org8484e22" class="outline-4">
<h4 id="org8484e22"><span class="section-number-4">19.8.3</span> (3).实例的字典</h4>
</div>
<div id="outline-container-org0c8c75f" class="outline-4">
<h4 id="org0c8c75f"><span class="section-number-4">19.8.4</span> (4).类的字典（4，5排序并不准确，当两者同名且同为类属性时，后声明赋的值，会覆盖前面的赋值，譬如a=4;a=5;执行完成是5，因为程序是从上往下按顺序执行的）</h4>
</div>
<div id="outline-container-org19372d6" class="outline-4">
<h4 id="org19372d6"><span class="section-number-4">19.8.5</span> (5).非数据描述符</h4>
</div>
<div id="outline-container-orgf168276" class="outline-4">
<h4 id="orgf168276"><span class="section-number-4">19.8.6</span> (6).父类的字典</h4>
</div>
<div id="outline-container-org3a8f8c0" class="outline-4">
<h4 id="org3a8f8c0"><span class="section-number-4">19.8.7</span> (7).`_<sub>getattr</sub>__'</h4>
<div class="outline-text-4" id="text-19-8-7">

<div id="orgae89508" class="figure">
<p><img src="file:///Users/zhou/Documents/github/notes/python/object-attribute-lookup-v3.png" alt="object-attribute-lookup-v3.png" />
</p>
</div>

<p>
#+begin<sub>src</sub> python
</p>
</div>
</div>
<div id="outline-container-orgaa34cef" class="outline-4">
<h4 id="orgaa34cef"><span class="section-number-4">19.8.8</span> Assuming Class is the class and instance is an instance of Class, evaluating instance.foobar roughly equates to this:</h4>
</div>
<div id="outline-container-orgb22c60f" class="outline-4">
<h4 id="orgb22c60f"><span class="section-number-4">19.8.9</span> (1).Call the type slot for Class._<sub>getattribute</sub>__ (tp<sub>getattro</sub>). The default does this: [10]</h4>
</div>
<div id="outline-container-orgdaa7814" class="outline-4">
<h4 id="orgdaa7814"><span class="section-number-4">19.8.10</span> (2).Does Class._<sub>dict</sub>__ have a foobar item that has a <span class="underline"><span class="underline">get</span></span> method and is a data descriptor [8]?</h4>
</div>
<div id="outline-container-org4b0a25f" class="outline-4">
<h4 id="org4b0a25f"><span class="section-number-4">19.8.11</span> (3).If yes, return the result of Class._<sub>dict</sub>__['foobar']._<sub>get</sub>_<sub>(instance, Class)</sub>. [6]</h4>
</div>
<div id="outline-container-org61d3d1f" class="outline-4">
<h4 id="org61d3d1f"><span class="section-number-4">19.8.12</span> (4).Does instance._<sub>dict</sub>__ have a foobar item in it?</h4>
</div>
<div id="outline-container-orga258094" class="outline-4">
<h4 id="orga258094"><span class="section-number-4">19.8.13</span> (5).If yes, return instance._<sub>dict</sub>__['foobar'].</h4>
</div>
<div id="outline-container-orga8b0adb" class="outline-4">
<h4 id="orga8b0adb"><span class="section-number-4">19.8.14</span> (6).Does Class._<sub>dict</sub>__ have a foobar item that has a <span class="underline"><span class="underline">get</span></span> method and is not a data descriptor [9]?</h4>
</div>
<div id="outline-container-orgb9af527" class="outline-4">
<h4 id="orgb9af527"><span class="section-number-4">19.8.15</span> (7).If yes, return the result of Class._<sub>dict</sub>__['foobar']._<sub>get</sub>_<sub>(instance, Class)</sub>. [6]</h4>
</div>
<div id="outline-container-org4e39b5a" class="outline-4">
<h4 id="org4e39b5a"><span class="section-number-4">19.8.16</span> (8).Does Class._<sub>dict</sub>__ have a foobar item?</h4>
</div>
<div id="outline-container-org05121fc" class="outline-4">
<h4 id="org05121fc"><span class="section-number-4">19.8.17</span> (9).If yes, return the result of Class._<sub>dict</sub>__['foobar'].</h4>
</div>
<div id="outline-container-org0bef149" class="outline-4">
<h4 id="org0bef149"><span class="section-number-4">19.8.18</span> (10).If the attribute still wasn't found, and there's a Class._<sub>getattr</sub>__, call Class._<sub>getattr</sub>_<sub>('foobar')</sub>.</h4>
</div>
</div>
<div id="outline-container-orga258efb" class="outline-3">
<h3 id="orga258efb"><span class="section-number-3">19.9</span> Class attribute lookup:</h3>
<div class="outline-text-3" id="text-19-9">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Because classes needs to be able support the classmethod and staticmethod properties [6] when you evaluate some# thing like Class.</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">foobar the lookup is slightly different than what would happen when you evaluate instance.foobar.</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Assuming Class is an instance of Metaclass, evaluating Class.foobar roughly equates to this:</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Call the type slot for Metaclass.__getattribute__ (tp_getattro). The default does this: [11]</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Does Metaclass.__dict__ have a foobar item that has a __get__ method and is a data descriptor [8]?</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">If yes, return the result of Metaclass.__dict__['foobar'].__get__(Class, Metaclass). [6]</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Does Class.__dict__ have a foobar item that is a descriptor (of any kind)?</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">If yes, return the result of Class.__dict__['foobar'].__get__(None, Class). [6]</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Does Class.__dict__ have a foobar item in it?</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">If yes, return Class.__dict__['foobar'].</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Does Metaclass.__dict__ have a foobar item that is not a data descriptor [9]?</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">If yes, return the result of Metaclass.__dict__['foobar'].__get__(Class, Metaclass). [6]</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Does Metaclass.__dict__ have any foobar item?</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">If yes, return Metaclass.__dict__['foobar'].</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">If the attribute still wasn't found, and there's a Metaclass.__getattr__, call Metaclass.__getattr__('foobar').</span>
</pre>
</div>
</div>
<div id="outline-container-org6d09a93" class="outline-4">
<h4 id="org6d09a93"><span class="section-number-4">19.9.1</span> </h4>
<div class="outline-text-4" id="text-19-9-1">
<p>
#+end<sub>src</sub>
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-orgcafc7de" class="outline-2">
<h2 id="orgcafc7de"><span class="section-number-2">20</span> 实现底层@classmethod</h2>
<div class="outline-text-2" id="text-20">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">NewDefine_classmethod</span>:
    <span style="color: #9f8766;">"""</span>
<span style="color: #9f8766;">    &#20351;&#29992;&#8220;&#25551;&#36848;&#31526;&#8221;&#21644;&#8220;&#35013;&#39280;&#22120;&#8221;&#32467;&#21512;&#36215;&#26469;&#65292;&#27169;&#25311;@classmethod</span>
<span style="color: #9f8766;">    """</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, function<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">self</span>.function = function

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__get__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, instance, owner<span style="color: #4f97d7;">)</span>:
        <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#23545;&#20256;&#36827;&#20989;&#25968;&#36827;&#34892;&#21152;&#24037;,&#26368;&#21518;&#36820;&#22238;&#35813;&#20989;&#25968;</span>
        <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">wrapper</span><span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span>:   <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#20351;&#29992;&#19981;&#23450;&#21442;&#25968;&#26159;&#20026;&#20102;&#21305;&#37197;&#38656;&#35201;&#20462;&#39280;&#30340;&#20989;&#25968;&#21442;&#25968;</span>
            <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"&#32473;&#20989;&#25968;&#28155;&#21152;&#39069;&#22806;&#21151;&#33021;"</span><span style="color: #4f97d7;">)</span>
            <span style="color: #4f97d7; font-weight: bold;">self</span>.function<span style="color: #4f97d7;">(</span>owner, *args, **kwargs<span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7; font-weight: bold;">return</span> wrapper

<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Person</span>:
    <span style="color: #7590db;">name</span>=<span style="color: #2d9574;">'&#25105;&#26377;&#22995;&#21517;'</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span><span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">pass</span>
    <span style="color: #ce537a; font-weight: bold;">@NewDefine_classmethod</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">study_1</span><span style="color: #4f97d7;">(</span>cls<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>f<span style="color: #2d9574;">'&#25105;&#30340;&#21517;&#23383;&#26159;&#65306;{cls.name},&#25105;&#20250;&#25630;&#23398;&#20064;&#65281;'</span><span style="color: #4f97d7;">)</span>
    <span style="color: #ce537a; font-weight: bold;">@NewDefine_classmethod</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">study_2</span><span style="color: #4f97d7;">(</span>cls,score<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>f<span style="color: #2d9574;">'&#25105;&#30340;&#21517;&#23383;&#26159;&#65306;{cls.name},&#25105;&#20250;&#25630;&#23398;&#20064;&#65281;,&#32780;&#19988;&#36825;&#27425;&#32771;&#35797;&#32771;&#20102; {score} &#20998;'</span><span style="color: #4f97d7;">)</span>

<span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>Person.study_1<span style="color: #bc6ec5;">()</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>Person.study_2<span style="color: #bc6ec5;">(</span><span style="color: #a45bad;">99</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#31532;&#19968;&#27493;&#65306;@NewDefine_classmethod&#26412;&#36136;&#19978;&#26159;&#19968;&#20010;&#8220;&#31867;&#35013;&#39280;&#22120;&#8221;&#65292;&#20174;&#23427;&#30340;&#23450;&#20041;&#21487;&#30693;&#65292;&#23427;&#30340;&#23450;&#20041;&#20026;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">class NewDefine_classmethod(function).&#25105;&#20204;&#21457;&#29616;&#65292;python&#31995;&#32479;&#23450;&#20041;&#30340;@classmethod&#20854;&#23454;&#23427;&#30340;&#23450;&#20041;&#20063;&#26159;&#19968;&#26679;&#30340;&#65292;&#22914;&#19979;&#65292;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">class classmethod(function) .&#24590;&#20040;&#26679;&#65311;&#23427;&#20204;&#20108;&#32773;&#30340;&#23450;&#20041;&#26159;&#19981;&#26159;&#19968;&#26679;&#65311;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#31532;&#20108;&#27493;&#65306;NewDefine_classmethod&#26412;&#36136;&#19978;&#21448;&#26159;&#19968;&#20010;&#25551;&#36848;&#31526;&#65292;&#22240;&#20026;&#22312;&#23427;&#30340;&#20869;&#37096;&#23454;&#29616;&#20102;__get__&#21327;&#35758;&#65292;&#30001;&#27492;&#21487;&#35265;&#65292;NewDefine_classmethod&#26159;&#8220;&#38598;&#35013;&#39280;&#22120;-&#25551;&#36848;&#31526;&#8221;&#20110;&#19968;&#36523;&#30340;&#12290;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#31532;&#19977;&#27493;&#65306;&#36816;&#34892;&#36807;&#31243;&#20998;&#26512;&#65292;&#22240;&#20026;study_1=NewDefine_classmethod&#65288;study_1&#65289;,&#25152;&#20197;&#65292;study_1&#26412;&#36136;&#19978;&#26159;&#19968;&#20010;NewDefine_classmethod&#30340;&#23545;&#35937;&#65292;&#21448;&#22240;&#20026;NewDefine_classmethod&#26412;&#36136;&#19978;&#26159;&#23454;&#29616;&#20102;&#25551;&#36848;&#31526;&#30340;&#65292;&#25152;&#20197;&#65292;study_1&#26412;&#36136;&#19978;&#26159;&#19968;&#20010;&#23450;&#20041;&#22312;&#31867;&#20013;&#30340;&#25551;&#36848;&#31526;&#23646;&#24615;&#12290;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#31532;&#22235;&#27493;&#65306;&#22240;&#20026;study_1&#26412;&#36136;&#19978;&#26159;&#19968;&#20010;&#23450;&#20041;&#22312;&#31867;&#20013;&#30340;&#25551;&#36848;&#31526;&#23646;&#24615;&#12290;&#25152;&#20197;&#22312;&#25191;&#34892;Person.study_1&#30340;&#26102;&#20505;&#65292;&#30456;&#24403;&#20110;&#26159;&#35775;&#38382;&#31867;&#30340;&#25551;&#36848;&#31526;&#23646;&#24615;&#65292;&#25152;&#20197;&#20250;&#36827;&#20837;&#21040;&#25551;&#36848;&#31526;&#30340;__get__&#26041;&#27861;&#12290;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#27880;&#24847;&#65306;&#22914;&#26524;&#20462;&#39280;&#30340;&#20989;&#25968;&#26412;&#36523;&#26159;&#20855;&#26377;&#36820;&#22238;&#20540;&#30340;&#65292;&#22312;__get__&#37324;&#38754;&#25152;&#23450;&#20041;&#30340;wrapper&#37324;&#38754;&#19968;&#23450;&#35201;&#36820;&#22238;&#65292;&#21363;return self.function(owner, *args, **kwargs)&#12290;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgc6b7689" class="outline-2">
<h2 id="orgc6b7689"><span class="section-number-2">21</span> 实现底层 @staticmethod</h2>
<div class="outline-text-2" id="text-21">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">NewDefine_staticmethod</span>:
    <span style="color: #9f8766;">"""</span>
<span style="color: #9f8766;">    &#20351;&#29992;&#8220;&#25551;&#36848;&#31526;&#8221;&#21644;&#8220;&#35013;&#39280;&#22120;&#8221;&#32467;&#21512;&#36215;&#26469;&#65292;&#27169;&#25311;@classmethod</span>
<span style="color: #9f8766;">    """</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, function<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">self</span>.function = function

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__get__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, instance, owner<span style="color: #4f97d7;">)</span>:
        <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#23545;&#20256;&#36827;&#20989;&#25968;&#36827;&#34892;&#21152;&#24037;,&#26368;&#21518;&#36820;&#22238;&#35813;&#20989;&#25968;</span>
        <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">wrapper</span><span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span>:   <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#20351;&#29992;&#19981;&#23450;&#21442;&#25968;&#26159;&#20026;&#20102;&#21305;&#37197;&#38656;&#35201;&#20462;&#39280;&#30340;&#20989;&#25968;&#21442;&#25968;</span>
            <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"&#32473;&#20989;&#25968;&#28155;&#21152;&#39069;&#22806;&#21151;&#33021;"</span><span style="color: #4f97d7;">)</span>
            <span style="color: #4f97d7; font-weight: bold;">self</span>.function<span style="color: #4f97d7;">(</span>*args, **kwargs<span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7; font-weight: bold;">return</span> wrapper

<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Person</span>:
    <span style="color: #7590db;">name</span>=<span style="color: #2d9574;">'&#25105;&#26377;&#22995;&#21517;'</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span><span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">pass</span>

    <span style="color: #ce537a; font-weight: bold;">@NewDefine_staticmethod</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">study_1</span><span style="color: #4f97d7;">(</span>math,english<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>f<span style="color: #2d9574;">'&#25105;&#25968;&#23398;&#32771;&#20102; {math} &#20998;,&#33521;&#35821;&#32771;&#20102; {english} &#20998;,&#25105;&#20250;&#25630;&#23398;&#20064;&#65281;'</span><span style="color: #4f97d7;">)</span>

    <span style="color: #ce537a; font-weight: bold;">@NewDefine_staticmethod</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">study_2</span><span style="color: #4f97d7;">(</span>history,science<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>f<span style="color: #2d9574;">'&#25105;&#21382;&#21490;&#32771;&#20102; {history} &#20998;,&#31185;&#23398;&#32771;&#20102; {science} &#20998;,&#25105;&#20250;&#25630;&#23398;&#20064;&#65281;'</span><span style="color: #4f97d7;">)</span>

<span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>Person.study_1<span style="color: #bc6ec5;">(</span><span style="color: #a45bad;">99</span>,<span style="color: #a45bad;">98</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>Person.study_2<span style="color: #bc6ec5;">(</span><span style="color: #a45bad;">88</span>,<span style="color: #a45bad;">89</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgecd347f" class="outline-2">
<h2 id="orgecd347f"><span class="section-number-2">22</span> 实现底层 @property</h2>
<div class="outline-text-2" id="text-22">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">NewDefine_property</span>:
    <span style="color: #9f8766;">"""</span>
<span style="color: #9f8766;">    &#20351;&#29992;&#8220;&#25551;&#36848;&#31526;&#8221;&#21644;&#8220;&#35013;&#39280;&#22120;&#8221;&#32467;&#21512;&#36215;&#26469;&#65292;&#27169;&#25311;@classmethod</span>
<span style="color: #9f8766;">    """</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, function<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">self</span>.function = function

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__get__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, instance, owner<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"&#32473;&#20989;&#25968;&#28155;&#21152;&#39069;&#22806;&#21151;&#33021;"</span><span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">self</span>.function<span style="color: #4f97d7;">(</span>instance<span style="color: #4f97d7;">)</span>

<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Person</span>:
    <span style="color: #7590db;">name</span>=<span style="color: #2d9574;">'&#25105;&#26377;&#22995;&#21517;'</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span><span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">self</span>.__study=<span style="color: #a45bad;">100</span>

    <span style="color: #ce537a; font-weight: bold;">@NewDefine_property</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">study_1</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span><span style="color: #4f97d7;">)</span>:  <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#20351;&#29992;property&#35013;&#39280;&#30340;&#20989;&#25968;&#19968;&#33324;&#19981;&#35201;&#29992;&#8220;&#21442;&#25968;&#8221;&#65292;&#22240;&#20026;&#23427;&#30340;&#20027;&#35201;&#21151;&#33021;&#26159;&#23545;&#23646;&#24615;&#30340;&#23553;&#35013;</span>
        <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7; font-weight: bold;">self</span>.__study

<span style="color: #7590db;">p</span>=Person<span style="color: #4f97d7;">()</span>
<span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>p.study_1<span style="color: #4f97d7;">)</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#22522;&#26412;&#24605;&#24819;&#21644;&#21069;&#38754;&#20998;&#26512;&#30340;&#36824;&#26159;&#19968;&#26679;&#30340;&#65292;&#20294;&#26159;&#26377;&#20960;&#20010;&#22320;&#26041;&#26377;&#25152;&#21306;&#21035;&#65292;&#38656;&#35201;&#27880;&#24847;&#65306;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#31532;&#19968;&#65306;@property&#30340;&#30446;&#30340;&#26159;&#23553;&#35013;&#19968;&#20010;&#26041;&#27861;&#65292;&#26159;&#36825;&#20010;&#26041;&#27861;&#21487;&#20197;&#34987;&#24403;&#20570;&#23646;&#24615;&#35775;&#38382;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#31532;&#20108;&#65306;&#35843;&#29992;&#30340;&#26041;&#24335;&#19982;&#21069;&#38754;&#26377;&#25152;&#19981;&#21516;&#65292;__get__&#37324;&#38754;&#19981;&#33021;&#20877;&#23450;&#20041;wrapper&#20102;&#65292;&#21542;&#21017;&#19981;&#20250;&#35843;&#29992;wrapper&#12290;&#24471;&#19981;&#21040;&#24819;&#35201;&#30340;&#32467;&#26524;&#65292;&#20026;&#20160;&#20040;&#21602;&#65311;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#22240;&#20026;&#35843;&#29992;&#30340;&#26041;&#24335;&#19981;&#19968;&#26679;&#65292;&#26681;&#25454;&#21069;&#38754;&#30340;&#20998;&#26512;&#65292;study_1&#30340;&#26412;&#36136;&#26159;&#25551;&#36848;&#31526;&#23646;&#24615;&#65292;&#20294;&#26159;&#21069;&#38754;&#30340;&#35843;&#29992;&#22343;&#26159;&#20351;&#29992;&#30340;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Person.study_1()&#25110;&#32773;&#26159;p.study_1()&#30340;&#24418;&#24335;&#65292;&#36824;&#26159;&#24403;&#25104;&#26041;&#27861;&#21435;&#20351;&#29992;&#30340;&#12290;&#20294;&#26159;&#27492;&#22788;&#19981;&#19968;&#26679;&#20102;&#65292;&#30452;&#25509;&#23601;&#26159;&#24403;&#25104;&#23646;&#24615;&#21435;&#20351;&#29992;&#65292;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">p.study_1 &#65292;&#19981;&#20877;&#26159;&#26041;&#27861;&#35843;&#29992;&#65292;&#22240;&#27492;wrapper&#20989;&#25968;&#24471;&#19981;&#21040;&#35843;&#29992;&#12290;&#25152;&#20197;__get__&#26041;&#27861;&#24471;&#21040;&#20102;&#36827;&#19968;&#27493;&#31616;&#21270;&#12290;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org5b79be7" class="outline-2">
<h2 id="org5b79be7"><span class="section-number-2">23</span> 描述器和装饰器的区别</h2>
<div class="outline-text-2" id="text-23">
</div>
<div id="outline-container-org60a03f4" class="outline-3">
<h3 id="org60a03f4"><span class="section-number-3">23.1</span> 同：描述器类和不带参数的装饰器类一样，都传入函数对象作为参数，并返回一个类实例</h3>
</div>
<div id="outline-container-orgb87eb6b" class="outline-3">
<h3 id="orgb87eb6b"><span class="section-number-3">23.2</span> 异：装饰器类返回 callable 的实例，描述器则返回描述器实例</h3>
</div>
</div>
<div id="outline-container-orgc8af110" class="outline-2">
<h2 id="orgc8af110"><span class="section-number-2">24</span> 属性调用</h2>
<div class="outline-text-2" id="text-24">
</div>
<div id="outline-container-org85ef8ea" class="outline-3">
<h3 id="org85ef8ea"><span class="section-number-3">24.1</span> 整个描述符的核心是`_<sub>getattribute</sub>__`, 因为对每个属性实例的调用都会用到这个函数。这个方法被用来查找类属性，同时也是属性代理，调用该方法可以进行属性访问</h3>
<div class="outline-text-3" id="text-24-1">
</div>
<div id="outline-container-orgc125fbc" class="outline-4">
<h4 id="orgc125fbc"><span class="section-number-4">24.1.1</span> 给定类X和实例x, x.foo由`_<sub>getattribute</sub>__`转化为：type(x)._<sub>dict</sub>['foo']._<sub>get</sub>_<sub>(x, type(x))</sub>,描述符是类属性，要用类调用</h4>
<div class="outline-text-4" id="text-24-1-1">
</div>
<ol class="org-ol">
<li><a id="org37093ec"></a>对比定义：def `_<sub>get</sub>_<sub>(self, instance, typ=None)</sub>-&gt;value可知：self = type(x)._<sub>dict</sub>__['foo'], instance=x, typ=type(x)<br /></li>
</ol>
</div>
<div id="outline-container-org2025324" class="outline-4">
<h4 id="org2025324"><span class="section-number-4">24.1.2</span> 如果是类调用了`_<sub>get</sub>__`方法，那么将None作为对象传入：X._<sub>dict</sub>['foo']._<sub>get</sub>_<sub>(None, X)</sub></h4>
<div class="outline-text-4" id="text-24-1-2">
</div>
<ol class="org-ol">
<li><a id="org8a3c373"></a>type._<sub>getattribute</sub>_<sub>()</sub> 把 C.x 转化为 C._<sub>dict</sub>__['x']._<sub>get</sub>_<sub>(None, C)</sub>。<br /></li>
</ol>
</div>
<div id="outline-container-orgc017057" class="outline-4">
<h4 id="orgc017057"><span class="section-number-4">24.1.3</span> 非数据描述符的目的只是当实例属性值不存在时，提供一个值。当一个实例的`_<sub>dict</sub>__`中找不到某个属性时，才去调用`_<sub>getattr</sub>__`,如果没有找到非数据描述符，那么`_<sub>getattribute</sub>__`会抛出异常，然后调用`_<sub>getattr</sub>__`</h4>
</div>
</div>
<div id="outline-container-org1e337ff" class="outline-3">
<h3 id="org1e337ff"><span class="section-number-3">24.2</span> `_<sub>getattribute</sub>__`调用顺序</h3>
<div class="outline-text-3" id="text-24-2">
</div>
<div id="outline-container-org1c4c1e9" class="outline-4">
<h4 id="org1c4c1e9"><span class="section-number-4">24.2.1</span> 类属性 &gt; 数据描述符 &gt; 实例属性(`_<sub>dict</sub>__['foo']`) &gt; 非数据描述符 &gt; `_<sub>getattr</sub>__`</h4>
</div>
<div id="outline-container-org3757182" class="outline-4">
<h4 id="org3757182"><span class="section-number-4">24.2.2</span> 获取属性的三种方法：(a).instance.attr, (2).instance._<sub>dict</sub>__['attr'], (3).getattr(instance, 'attr')</h4>
</div>
<div id="outline-container-orgb123357" class="outline-4">
<h4 id="orgb123357"><span class="section-number-4">24.2.3</span> 点操作符的查找逻辑位于 object._<sub>getattribute</sub>_<sub>()</sub> 方法中</h4>
</div>
<div id="outline-container-orgd3022b4" class="outline-4">
<h4 id="orgd3022b4"><span class="section-number-4">24.2.4</span> 一般情况下， 当调用instance.attr(点属性符）访问属性时，实际是使用instance._<sub>dict</sub>__['attr']</h4>
</div>
<div id="outline-container-org5316fa5" class="outline-4">
<h4 id="org5316fa5"><span class="section-number-4">24.2.5</span> `_<sub>setitem</sub>_<sub>()</sub>、`_<sub>getitem</sub>_<sub>()</sub>、`_<sub>delitem</sub>_<sub>()</sub>:`_<sub>xxxitem</sub>__:使用 [''] 的方式操作属性时被调用</h4>
<div class="outline-text-4" id="text-24-2-5">
</div>
<ol class="org-ol">
<li><a id="orgcee70f7"></a>`_<sub>setitem</sub>__:每当属性被赋值的时候都会调用该方法，因此不能再该方法内赋值 self.name = value 会死循环<br /></li>
<li><a id="org724e2c9"></a>`_<sub>getitem</sub>__:当访问不存在的属性时会调用该方法<br /></li>
<li><a id="org6ed6d73"></a><span class="underline">`<sub>delitem</sub>_</span>:当删除属性时调用该方法<br /></li>
</ol>
</div>
</div>
<div id="outline-container-org3286f88" class="outline-3">
<h3 id="org3286f88"><span class="section-number-3">24.3</span> 类的方法实际就是一个仅实现了 _<sub>get</sub>_<sub>()</sub> 的非资料描述器，所以如果实例 c 中同时定义了名为 foo 的方法和属性，那么 c.foo 访问的是属性而非方法。</h3>
<div class="outline-text-3" id="text-24-3">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Descriptor</span>:
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, var1<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>f<span style="color: #2d9574;">"descriptor init: {var1}"</span><span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7; font-weight: bold;">self</span>.var1 = var1

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__set__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, instance, value<span style="color: #4f97d7;">)</span>:
        <span style="color: #9f8766;">""""""</span>
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>f<span style="color: #2d9574;">"Assigning {value}"</span><span style="color: #4f97d7;">)</span>

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__get__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, instance, owner=<span style="color: #a45bad;">None</span><span style="color: #4f97d7;">)</span>:
        <span style="color: #9f8766;">""""""</span>
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'Getting value'</span><span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #2d9574;">"descriptor returned value"</span>


<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Person</span>:

    <span style="color: #7590db;">foo</span> = Descriptor<span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"init"</span><span style="color: #4f97d7;">)</span>
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, value<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">self</span>.foo = value

<span style="color: #7590db;">person</span> = Person<span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'instance'</span><span style="color: #4f97d7;">)</span> <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">descriptor init: init, Assigning instance</span>
<span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"2"</span>, person.foo<span style="color: #4f97d7;">)</span>      <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Getting value, 2 descriptor returned value</span>
<span style="color: #7590db;">person.foo</span> =<span style="color: #2d9574;">'test'</span>          <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Assigning test</span>
<span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"3"</span>, person.foo<span style="color: #4f97d7;">)</span>      <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Getting value</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#32473;&#23454;&#20363;&#23646;&#24615;&#36171;&#20540;&#26102;&#65292;&#30001;&#20110;&#25968;&#25454;&#25551;&#36848;&#31526;&#27604;&#23454;&#20363;&#23646;&#24615;&#20248;&#20808;&#32423;&#39640;&#65292;&#25152;&#20197;&#36171;&#20540;&#34987;&#38544;&#34255;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org97d49cb" class="outline-3">
<h3 id="org97d49cb"><span class="section-number-3">24.4</span> 有几点需要牢记的：</h3>
<div class="outline-text-3" id="text-24-4">
</div>
<div id="outline-container-org595a269" class="outline-4">
<h4 id="org595a269"><span class="section-number-4">24.4.1</span> 描述器被 _<sub>getattribute</sub>_<sub>()</sub> 方法调用,因而，重载 _<sub>getattribute</sub>_<sub>()</sub> 可能会妨碍描述器被自动调用</h4>
</div>
<div id="outline-container-orga99d4ea" class="outline-4">
<h4 id="orga99d4ea"><span class="section-number-4">24.4.2</span> _<sub>getattribute</sub>_<sub>()</sub> 仅存在于继承自 object 的新式类之中</h4>
</div>
<div id="outline-container-orgf23eaeb" class="outline-4">
<h4 id="orgf23eaeb"><span class="section-number-4">24.4.3</span> object._<sub>getattribute</sub>_<sub>()</sub> 和 type._<sub>getattribute</sub>_<sub>()</sub> 对 _<sub>get</sub>_<sub>()</sub> 的调用不一样</h4>
</div>
<div id="outline-container-org20f0271" class="outline-4">
<h4 id="org20f0271"><span class="section-number-4">24.4.4</span> 资料描述器总会覆盖实例字典，即资料描述器具有最高优先级</h4>
</div>
<div id="outline-container-orgde39caf" class="outline-4">
<h4 id="orgde39caf"><span class="section-number-4">24.4.5</span> 非资料描述器可能会被实例字典覆盖，即非资料描述器具有最低优先级</h4>
</div>
</div>

<div id="outline-container-org32705bc" class="outline-3">
<h3 id="org32705bc"><span class="section-number-3">24.5</span> property()是在它所在的类被创建时被调用的，所以传入property的参数是非绑定的函数（不是方法，因为实例没有创建）</h3>
</div>
</div>

<div id="outline-container-org0d10396" class="outline-2">
<h2 id="org0d10396"><span class="section-number-2">25</span> yield from</h2>
<div class="outline-text-2" id="text-25">
</div>
<div id="outline-container-org1ccf105" class="outline-3">
<h3 id="org1ccf105"><span class="section-number-3">25.1</span> yield from 后面可以跟的可以是“ 生成器 、元组、 列表、range（）函数产生的序列等可迭代对象”</h3>
</div>
<div id="outline-container-org0f1a72f" class="outline-3">
<h3 id="org0f1a72f"><span class="section-number-3">25.2</span> yield from  generator, 实际上就是返回另外一个生成器. 而yield只是返回一个元素</h3>
</div>
<div id="outline-container-org6942070" class="outline-3">
<h3 id="org6942070"><span class="section-number-3">25.3</span> yield from iterable本质上等于 for item in iterable: yield item</h3>
<div class="outline-text-3" id="text-25-3">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">foo</span><span style="color: #4f97d7;">()</span>:
    <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"starting..."</span><span style="color: #4f97d7;">)</span>
    <span style="color: #4f97d7; font-weight: bold;">while</span> <span style="color: #a45bad;">True</span>:
        <span style="color: #7590db;">res</span> = <span style="color: #4f97d7; font-weight: bold;">yield</span> <span style="color: #a45bad;">4</span>
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"res:"</span>,res<span style="color: #4f97d7;">)</span>
<span style="color: #7590db;">g</span> = foo<span style="color: #4f97d7;">()</span>
<span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">next</span><span style="color: #bc6ec5;">(</span>g<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"*"</span>*<span style="color: #a45bad;">20</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">next</span><span style="color: #bc6ec5;">(</span>g<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">starting...  </span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">4      </span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">********************</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">res: None     &#19979;&#27425;&#35843;&#29992;generator&#20174;&#21069;&#38754;yield&#30340;&#19979;&#19968;&#21477;&#24320;&#22987;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">4</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">1.&#31243;&#24207;&#24320;&#22987;&#25191;&#34892;&#20197;&#21518;&#65292;&#22240;&#20026;foo&#20989;&#25968;&#20013;&#26377;yield&#20851;&#38190;&#23383;&#65292;&#25152;&#20197;foo&#20989;&#25968;&#24182;&#19981;&#20250;&#30495;&#30340;&#25191;&#34892;&#65292;&#32780;&#26159;&#20808;&#24471;&#21040;&#19968;&#20010;&#29983;&#25104;&#22120;g(&#30456;&#24403;&#20110;&#19968;&#20010;&#23545;&#35937;)</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">2.&#30452;&#21040;&#35843;&#29992;next&#26041;&#27861;&#65292;foo&#20989;&#25968;&#27491;&#24335;&#24320;&#22987;&#25191;&#34892;&#65292;&#20808;&#25191;&#34892;foo&#20989;&#25968;&#20013;&#30340;print&#26041;&#27861;&#65292;&#28982;&#21518;&#36827;&#20837;while&#24490;&#29615;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">3.&#31243;&#24207;&#36935;&#21040;yield&#20851;&#38190;&#23383;&#65292;&#28982;&#21518;&#25226;yield&#24819;&#24819;&#25104;return,return&#20102;&#19968;&#20010;4&#20043;&#21518;&#65292;&#31243;&#24207;&#20572;&#27490;&#65292;&#24182;&#27809;&#26377;&#25191;&#34892;&#36171;&#20540;&#32473;res&#25805;&#20316;&#65292;&#27492;&#26102;next(g)&#35821;&#21477;&#25191;&#34892;&#23436;&#25104;&#65292;&#25152;&#20197;&#36755;&#20986;&#30340;&#21069;&#20004;&#34892;&#65288;&#31532;&#19968;&#20010;&#26159;while&#19978;&#38754;&#30340;print&#30340;&#32467;&#26524;,&#31532;&#20108;&#20010;&#26159;return&#20986;&#30340;&#32467;&#26524;&#65289;&#26159;&#25191;&#34892;print(next(g))&#30340;&#32467;&#26524;&#65292;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">4.&#31243;&#24207;&#25191;&#34892;print("*"*20)&#65292;&#36755;&#20986;20&#20010;*</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">5.&#21448;&#24320;&#22987;&#25191;&#34892;&#19979;&#38754;&#30340;print(next(g)),&#36825;&#20010;&#26102;&#20505;&#21644;&#19978;&#38754;&#37027;&#20010;&#24046;&#19981;&#22810;&#65292;&#19981;&#36807;&#19981;&#21516;&#30340;&#26159;&#65292;&#36825;&#20010;&#26102;&#20505;&#26159;&#20174;&#21018;&#25165;&#37027;&#20010;next&#31243;&#24207;&#20572;&#27490;&#30340;&#22320;&#26041;&#24320;&#22987;&#25191;&#34892;&#30340;&#65292;&#20063;&#23601;&#26159;&#35201;&#25191;&#34892;res&#30340;&#36171;&#20540;&#25805;&#20316;&#65292;&#36825;&#26102;&#20505;&#35201;&#27880;&#24847;&#65292;&#36825;&#20010;&#26102;&#20505;&#36171;&#20540;&#25805;&#20316;&#30340;&#21491;&#36793;&#26159;&#27809;&#26377;&#20540;&#30340;</span>
<span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#65288;&#22240;&#20026;&#21018;&#25165;&#37027;&#20010;&#26159;return&#20986;&#21435;&#20102;&#65292;&#24182;&#27809;&#26377;&#32473;&#36171;&#20540;&#25805;&#20316;&#30340;&#24038;&#36793;&#20256;&#21442;&#25968;&#65289;&#65292;&#25152;&#20197;&#36825;&#20010;&#26102;&#20505;res&#36171;&#20540;&#26159;None,&#25152;&#20197;&#25509;&#30528;&#19979;&#38754;&#30340;&#36755;&#20986;&#23601;&#26159;res:None,</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">6.&#31243;&#24207;&#20250;&#32487;&#32493;&#22312;while&#37324;&#25191;&#34892;&#65292;&#21448;&#19968;&#27425;&#30896;&#21040;yield,&#36825;&#20010;&#26102;&#20505;&#21516;&#26679;return &#20986;4&#65292;&#28982;&#21518;&#31243;&#24207;&#20572;&#27490;&#65292;print&#20989;&#25968;&#36755;&#20986;&#30340;4&#23601;&#26159;&#36825;&#27425;return&#20986;&#30340;4.</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#21040;&#36825;&#37324;&#20320;&#21487;&#33021;&#23601;&#26126;&#30333;yield&#21644;return&#30340;&#20851;&#31995;&#21644;&#21306;&#21035;&#20102;&#65292;&#24102;yield&#30340;&#20989;&#25968;&#26159;&#19968;&#20010;&#29983;&#25104;&#22120;&#65292;&#32780;&#19981;&#26159;&#19968;&#20010;&#20989;&#25968;&#20102;&#65292;&#36825;&#20010;&#29983;&#25104;&#22120;&#26377;&#19968;&#20010;&#20989;&#25968;&#23601;&#26159;next&#20989;&#25968;&#65292;next&#23601;&#30456;&#24403;&#20110;&#8220;&#19979;&#19968;&#27493;&#8221;&#29983;&#25104;&#21738;&#20010;&#25968;&#65292;&#36825;&#19968;&#27425;&#30340;next&#24320;&#22987;&#30340;&#22320;&#26041;&#26159;&#25509;&#30528;&#19978;&#19968;&#27425;&#30340;next&#20572;&#27490;&#30340;&#22320;&#26041;&#25191;&#34892;&#30340;&#65292;&#25152;&#20197;&#35843;&#29992;next&#30340;&#26102;&#20505;&#65292;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#29983;&#25104;&#22120;&#24182;&#19981;&#20250;&#20174;foo&#20989;&#25968;&#30340;&#24320;&#22987;&#25191;&#34892;&#65292;&#21482;&#26159;&#25509;&#30528;&#19978;&#19968;&#27493;&#20572;&#27490;&#30340;&#22320;&#26041;&#24320;&#22987;&#65292;&#28982;&#21518;&#36935;&#21040;yield&#21518;&#65292;return&#20986;&#35201;&#29983;&#25104;&#30340;&#25968;&#65292;&#27492;&#27493;&#23601;&#32467;&#26463;&#12290;</span>

</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">foo</span><span style="color: #4f97d7;">()</span>:
    <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"starting..."</span><span style="color: #4f97d7;">)</span>
    <span style="color: #4f97d7; font-weight: bold;">while</span> <span style="color: #a45bad;">True</span>:
        <span style="color: #7590db;">res</span> = <span style="color: #4f97d7; font-weight: bold;">yield</span> <span style="color: #a45bad;">4</span> <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#19979;&#19968;&#21477;&#26159;&#36171;&#20540;</span>
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"res:"</span>,res<span style="color: #4f97d7;">)</span>
<span style="color: #7590db;">g</span> = foo<span style="color: #4f97d7;">()</span>
<span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">next</span><span style="color: #bc6ec5;">(</span>g<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"*"</span>*<span style="color: #a45bad;">20</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>g.send<span style="color: #bc6ec5;">(</span><span style="color: #a45bad;">7</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span> 

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">starting...</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">4</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">********************</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">res: 7</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">4</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">send&#26159;&#21457;&#36865;&#19968;&#20010;&#21442;&#25968;&#32473;res&#30340;&#65292;&#22240;&#20026;&#19978;&#38754;&#35762;&#21040;&#65292;return&#30340;&#26102;&#20505;&#65292;&#24182;&#27809;&#26377;&#25226;4&#36171;&#20540;&#32473;res&#65292;&#19979;&#27425;&#25191;&#34892;&#30340;&#26102;&#20505;&#21482;&#22909;&#32487;&#32493;&#25191;&#34892;&#36171;&#20540;&#25805;&#20316;&#65292;&#21482;&#22909;&#36171;&#20540;&#20026;None&#20102;&#65292;&#32780;&#22914;&#26524;&#29992;send&#30340;&#35805;&#65292;&#24320;&#22987;&#25191;&#34892;&#30340;&#26102;&#20505;&#65292;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#20808;&#25509;&#30528;&#19978;&#19968;&#27425;&#65288;return 4&#20043;&#21518;&#65289;&#25191;&#34892;&#65292;&#20808;&#25226;7&#36171;&#20540;&#32473;&#20102;res,&#28982;&#21518;&#25191;&#34892;next&#30340;&#20316;&#29992;&#65292;&#36935;&#35265;&#19979;&#19968;&#22238;&#30340;yield&#65292;return&#20986;&#32467;&#26524;&#21518;&#32467;&#26463;&#12290;</span>

</pre>
</div>
</div>
</div>
<div id="outline-container-org9512ce9" class="outline-3">
<h3 id="org9512ce9"><span class="section-number-3">25.4</span> yield from 替代内层for循环</h3>
<div class="outline-text-3" id="text-25-4">
</div>
<div id="outline-container-org2df6c74" class="outline-4">
<h4 id="org2df6c74"><span class="section-number-4">25.4.1</span> 如果生成器函数需要产出另一个生成器生成的值，传统的解决方法是使用嵌套的for循环</h4>
<div class="outline-text-4" id="text-25-4-1">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">chain</span><span style="color: #4f97d7;">(</span>*iterables<span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">for</span> it <span style="color: #4f97d7; font-weight: bold;">in</span> iterables:
        <span style="color: #4f97d7; font-weight: bold;">for</span> i <span style="color: #4f97d7; font-weight: bold;">in</span> it:
            <span style="color: #4f97d7; font-weight: bold;">yield</span> i

<span style="color: #7590db;">s</span> = <span style="color: #2d9574;">'ABC'</span>
<span style="color: #7590db;">t</span> = <span style="color: #4f97d7;">tuple</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7;">range</span><span style="color: #bc6ec5;">(</span><span style="color: #a45bad;">3</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">chain &#29983;&#25104;&#22120;&#20989;&#25968;&#25226;&#25805;&#20316;&#20381;&#27425;&#20132;&#32473;&#25509;&#25910;&#21040;&#30340;&#21508;&#20010;&#21487;&#36845;&#20195;&#23545;&#35937;&#22788;&#29702;&#12290;</span>
<span style="color: #4f97d7;">list</span><span style="color: #4f97d7;">(</span>chain<span style="color: #bc6ec5;">(</span>s, t<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">chain</span><span style="color: #4f97d7;">(</span>*iterables<span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">for</span> i <span style="color: #4f97d7; font-weight: bold;">in</span> iterables:
        <span style="color: #4f97d7; font-weight: bold;">yield</span> <span style="color: #4f97d7; font-weight: bold;">from</span> i
<span style="color: #4f97d7;">list</span><span style="color: #4f97d7;">(</span>chain<span style="color: #bc6ec5;">(</span>s, t<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">yield from &#23436;&#20840;&#20195;&#26367;&#20102;&#20869;&#23618;&#30340; for &#24490;&#29615;&#12290;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">yield from x &#34920;&#36798;&#24335;&#23545; x &#23545;&#35937;&#25152;&#20570;&#30340;&#31532;&#19968;&#20214;&#20107;&#26159;&#65292;&#35843;&#29992; iter(x)&#65292;&#20174;&#20013;&#33719;&#21462;&#36845;&#20195;&#22120;&#12290;&#22240;&#27492;&#65292;x &#21487;&#20197;&#26159;&#20219;&#20309;&#21487;&#36845;&#20195;&#30340;&#23545;&#35937;&#12290;</span>

</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#25105;&#20204;&#26377;&#19968;&#20010;&#23884;&#22871;&#22411;&#30340;&#24207;&#21015;&#65292;&#24819;&#23558;&#23427;&#25153;&#24179;&#21270;&#22788;&#29702;&#20026;&#19968;&#21015;&#21333;&#29420;&#30340;&#20540;</span>
<span style="color: #4f97d7; font-weight: bold;">from</span> collections <span style="color: #4f97d7; font-weight: bold;">import</span> Iterable

<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">flatten</span><span style="color: #4f97d7;">(</span>items, ignore_types=<span style="color: #bc6ec5;">(</span><span style="color: #4f97d7;">str</span>, <span style="color: #4f97d7;">bytes</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">for</span> x <span style="color: #4f97d7; font-weight: bold;">in</span> items:
        <span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7;">isinstance</span><span style="color: #4f97d7;">(</span>x, Iterable<span style="color: #4f97d7;">)</span> <span style="color: #4f97d7; font-weight: bold;">and</span> <span style="color: #4f97d7; font-weight: bold;">not</span> <span style="color: #4f97d7;">isinstance</span><span style="color: #4f97d7;">(</span>x, ignore_types<span style="color: #4f97d7;">)</span>:
            <span style="color: #4f97d7; font-weight: bold;">yield</span> <span style="color: #4f97d7; font-weight: bold;">from</span> flatten<span style="color: #4f97d7;">(</span>x<span style="color: #4f97d7;">)</span>
        <span style="color: #4f97d7; font-weight: bold;">else</span>:
            <span style="color: #4f97d7; font-weight: bold;">yield</span> x

<span style="color: #7590db;">items</span> = <span style="color: #4f97d7;">[</span><span style="color: #a45bad;">1</span>, <span style="color: #a45bad;">2</span>, <span style="color: #bc6ec5;">[</span><span style="color: #a45bad;">3</span>, <span style="color: #a45bad;">4</span>, <span style="color: #2d9574;">[</span><span style="color: #a45bad;">5</span>, <span style="color: #a45bad;">6</span><span style="color: #2d9574;">]</span>, <span style="color: #a45bad;">7</span><span style="color: #bc6ec5;">]</span>, <span style="color: #a45bad;">8</span><span style="color: #4f97d7;">]</span>
<span style="color: #4f97d7; font-weight: bold;">for</span> x <span style="color: #4f97d7; font-weight: bold;">in</span> flatten<span style="color: #4f97d7;">(</span>items<span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>x<span style="color: #4f97d7;">)</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">collections.Iterable&#26159;&#19968;&#20010;&#25277;&#35937;&#22522;&#31867;&#65292;&#25105;&#20204;&#29992;isinstance(x, Iterable)&#26816;&#26597;&#26576;&#20010;&#20803;&#32032;&#26159;&#21542;&#26159;&#21487;&#36845;&#20195;&#30340;.&#22914;&#26524;&#26159;&#30340;&#35805;,&#37027;&#20040;&#23601;&#29992;yield from&#23558;&#36825;&#20010;&#21487;&#36845;&#20195;&#23545;&#35937;&#20316;&#20026;&#19968;&#31181;&#23376;&#20363;&#31243;&#36827;&#34892;&#36882;&#24402;&#12290;&#26368;&#32456;&#36820;&#22238;&#32467;&#26524;&#23601;&#26159;&#19968;&#20010;&#27809;&#26377;&#23884;&#22871;&#30340;&#21333;&#20540;&#24207;&#21015;&#20102;&#12290;    </span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#21033;&#29992;&#19968;&#20010;Node&#31867;&#26469;&#34920;&#31034;&#26641;&#32467;&#26500;</span>
<span style="color: #4f97d7; font-weight: bold;">class</span> <span style="color: #ce537a; font-weight: bold;">Node</span>:
    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__init__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, value<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">self</span>._value = value
        <span style="color: #4f97d7; font-weight: bold;">self</span>._children = <span style="color: #4f97d7;">[]</span>

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__repr__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span><span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #2d9574;">'Node({!r})'</span>.<span style="color: #4f97d7;">format</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>._value<span style="color: #4f97d7;">)</span>

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">add_child</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>, node<span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">self</span>._children.append<span style="color: #4f97d7;">(</span>node<span style="color: #4f97d7;">)</span>

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">__iter__</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span><span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #4f97d7;">iter</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span>._children<span style="color: #4f97d7;">)</span>

    <span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">depth_first</span><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">self</span><span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">yield</span> <span style="color: #4f97d7; font-weight: bold;">self</span>
        <span style="color: #4f97d7; font-weight: bold;">for</span> c <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7; font-weight: bold;">self</span>:
            <span style="color: #4f97d7; font-weight: bold;">yield</span> <span style="color: #4f97d7; font-weight: bold;">from</span> c.depth_first<span style="color: #4f97d7;">()</span>

<span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #4f97d7;">__name__</span> == <span style="color: #2d9574;">'__main__'</span>:
    <span style="color: #7590db;">root</span> = Node<span style="color: #4f97d7;">(</span><span style="color: #a45bad;">0</span><span style="color: #4f97d7;">)</span>
    <span style="color: #7590db;">child1</span> = Node<span style="color: #4f97d7;">(</span><span style="color: #a45bad;">1</span><span style="color: #4f97d7;">)</span>
    <span style="color: #7590db;">child2</span> = Node<span style="color: #4f97d7;">(</span><span style="color: #a45bad;">2</span><span style="color: #4f97d7;">)</span>
    root.add_child<span style="color: #4f97d7;">(</span>child1<span style="color: #4f97d7;">)</span>
    root.add_child<span style="color: #4f97d7;">(</span>child2<span style="color: #4f97d7;">)</span>
    child1.add_child<span style="color: #4f97d7;">(</span>Node<span style="color: #bc6ec5;">(</span><span style="color: #a45bad;">3</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
    child1.add_child<span style="color: #4f97d7;">(</span>Node<span style="color: #bc6ec5;">(</span><span style="color: #a45bad;">4</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
    child2.add_child<span style="color: #4f97d7;">(</span>Node<span style="color: #bc6ec5;">(</span><span style="color: #a45bad;">5</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
    <span style="color: #4f97d7; font-weight: bold;">for</span> ch <span style="color: #4f97d7; font-weight: bold;">in</span> root.depth_first<span style="color: #4f97d7;">()</span>:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>ch<span style="color: #4f97d7;">)</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">__iter__&#20195;&#34920;&#19968;&#20010;Pyton&#30340;&#36845;&#20195;&#21327;&#35758;&#65292;&#36820;&#22238;&#19968;&#20010;&#36845;&#20195;&#22120;&#23545;&#35937;,&#23601;&#33021;&#36845;&#20195;&#20102;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">depth_frist&#36820;&#22238;&#19968;&#20010;&#29983;&#25104;&#22120;&#65292;&#20180;&#32454;&#20307;&#20250;&#20854;&#20013;&#30340;yield&#19982; yield from&#29992;&#27861;        </span>
</pre>
</div>


<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#25105;&#20204;&#37117;&#30693;&#36947;&#65292;&#22312;&#20351;&#29992;yield&#29983;&#25104;&#22120;&#30340;&#26102;&#20505;&#65292;&#22914;&#26524;&#20351;&#29992;for&#35821;&#21477;&#21435;&#36845;&#20195;&#29983;&#25104;&#22120;&#65292;&#21017;&#19981;&#20250;&#26174;&#24335;&#30340;&#20986;&#21457;StopIteration&#24322;&#24120;&#65292;&#32780;&#26159;&#33258;&#21160;&#25429;&#33719;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">StopIteration&#24322;&#24120;&#65292;&#25152;&#20197;&#22914;&#26524;&#36935;&#21040;return&#65292;&#21482;&#26159;&#20250;&#32456;&#27490;&#36845;&#20195;&#65292;&#32780;&#19981;&#20250;&#35302;&#21457;&#24322;&#24120;&#65292;&#25925;&#32780;&#20063;&#23601;&#27809;&#21150;&#27861;&#33719;&#21462;return&#30340;&#20540;&#12290;</span>
<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">my_generator</span><span style="color: #4f97d7;">()</span>:
    <span style="color: #4f97d7; font-weight: bold;">for</span> i <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">range</span><span style="color: #4f97d7;">(</span><span style="color: #a45bad;">5</span><span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">if</span> i==<span style="color: #a45bad;">2</span>:
            <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #2d9574;">'&#25105;&#34987;&#36843;&#20013;&#26029;&#20102;'</span>
        <span style="color: #4f97d7; font-weight: bold;">else</span>:
            <span style="color: #4f97d7; font-weight: bold;">yield</span> i

<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">main</span><span style="color: #4f97d7;">(</span>generator<span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">try</span>:
        <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#36845;&#20195;&#21040;2&#30340;&#26102;&#20505;&#36935;&#21040;return&#35821;&#21477;&#65292;&#38544;&#24335;&#30340;&#35302;&#21457;&#20102;StopIteration&#24322;&#24120;&#65292;&#23601;&#32456;&#27490;&#36845;&#20195;&#20102;&#65292;&#20294;&#26159;&#22312;&#31243;&#24207;&#20013;&#19981;&#20250;&#26174;&#31034;&#20986;&#26469;&#12290;</span>
        <span style="color: #4f97d7; font-weight: bold;">for</span> i <span style="color: #4f97d7; font-weight: bold;">in</span> generator:  <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#19981;&#20250;&#26174;&#24335;&#35302;&#21457;&#24322;&#24120;&#65292;&#25925;&#32780;&#26080;&#27861;&#33719;&#21462;&#21040;return&#30340;&#20540;</span>
            <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>i<span style="color: #4f97d7;">)</span>
    <span style="color: #4f97d7; font-weight: bold;">except</span> <span style="color: #ce537a; font-weight: bold;">StopIteration</span> <span style="color: #4f97d7; font-weight: bold;">as</span> exc:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>exc.value<span style="color: #4f97d7;">)</span>

<span style="color: #7590db;">g</span>=my_generator<span style="color: #4f97d7;">()</span>  <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#35843;&#29992;</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">my_generator</span><span style="color: #4f97d7;">()</span>:
    <span style="color: #4f97d7; font-weight: bold;">for</span> i <span style="color: #4f97d7; font-weight: bold;">in</span> <span style="color: #4f97d7;">range</span><span style="color: #4f97d7;">(</span><span style="color: #a45bad;">5</span><span style="color: #4f97d7;">)</span>:
        <span style="color: #4f97d7; font-weight: bold;">if</span> i==<span style="color: #a45bad;">2</span>:
            <span style="color: #4f97d7; font-weight: bold;">return</span> <span style="color: #2d9574;">'&#25105;&#34987;&#36843;&#20013;&#26029;&#20102;'</span>
        <span style="color: #4f97d7; font-weight: bold;">else</span>:
            <span style="color: #4f97d7; font-weight: bold;">yield</span> i

<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">wrap_my_generator</span><span style="color: #4f97d7;">(</span>generator<span style="color: #4f97d7;">)</span>:  <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#23450;&#20041;&#19968;&#20010;&#21253;&#35013;&#8220;&#29983;&#25104;&#22120;&#8221;&#30340;&#29983;&#25104;&#22120;&#65292;&#23427;&#30340;&#26412;&#36136;&#36824;&#26159;&#29983;&#25104;&#22120;</span>
    <span style="color: #7590db;">result</span>=<span style="color: #4f97d7; font-weight: bold;">yield</span> <span style="color: #4f97d7; font-weight: bold;">from</span> generator    <span style="color: #2aa1ae; background-color: #292e34;">#</span><span style="color: #2aa1ae; background-color: #292e34;">&#33258;&#21160;&#35302;&#21457;StopIteration&#24322;&#24120;&#65292;&#24182;&#19988;&#23558;return&#30340;&#36820;&#22238;&#20540;&#36171;&#20540;&#32473;yield from&#34920;&#36798;&#24335;&#30340;&#32467;&#26524;&#65292;&#21363;result</span>
    <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>result<span style="color: #4f97d7;">)</span>

<span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #bc6ec5; font-weight: bold;">main</span><span style="color: #4f97d7;">(</span>generator<span style="color: #4f97d7;">)</span>:
    <span style="color: #4f97d7; font-weight: bold;">for</span> j <span style="color: #4f97d7; font-weight: bold;">in</span> generator:
        <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>j<span style="color: #4f97d7;">)</span>

<span style="color: #7590db;">g</span>=my_generator<span style="color: #4f97d7;">()</span>
<span style="color: #7590db;">wrap_g</span>=wrap_my_generator<span style="color: #4f97d7;">(</span>g<span style="color: #4f97d7;">)</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#20174;&#19978;&#38754;&#30340;&#27604;&#36739;&#21487;&#20197;&#30475;&#20986;&#65292;yield from&#20855;&#26377;&#20197;&#19979;&#20960;&#20010;&#29305;&#28857;&#65306;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#65288;1&#65289;&#19978;&#38754;&#30340;my_generator&#26159;&#21407;&#22987;&#30340;&#29983;&#25104;&#22120;&#65292;main&#26159;&#35843;&#29992;&#26041;&#65292;&#20351;&#29992;yield&#30340;&#26102;&#20505;&#65292;&#21482;&#28041;&#21450;&#21040;&#36825;&#20004;&#20010;&#20989;&#25968;&#65292;&#21363;&#8220;&#35843;&#29992;&#26041;&#8221;&#19982;&#8220;&#29983;&#25104;&#22120;&#65288;&#21327;&#31243;&#20989;&#25968;&#65289;&#8221;&#26159;&#30452;&#25509;&#36827;&#34892;&#20132;&#20114;&#30340;&#65292;&#19981;&#28041;&#21450;&#20854;&#20182;&#26041;&#27861;&#65292;&#21363;&#8220;&#35843;&#29992;&#26041;&#8212;&#8212;&gt;&#29983;&#25104;&#22120;&#20989;&#25968;(&#21327;&#31243;&#20989;&#25968;)&#8221;&#65307;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#65288;2&#65289;&#22312;&#20351;&#29992;yield from&#30340;&#26102;&#20505;&#65292;&#22810;&#20102;&#19968;&#20010;&#23545;&#21407;&#22987;my_generator&#30340;&#21253;&#35013;&#20989;&#25968;&#65292;&#28982;&#21518;&#35843;&#29992;&#26041;&#26159;&#36890;&#36807;&#36825;&#20010;&#21253;&#35013;&#20989;&#25968;&#65288;&#21518;&#38754;&#20250;&#35762;&#21040;&#23427;&#19987;&#26377;&#30340;&#21517;&#35789;&#65289;&#26469;&#19982;&#29983;&#25104;&#22120;&#36827;&#34892;&#20132;&#20114;&#30340;&#65292;&#21363;&#8220;&#35843;&#29992;&#26041;&#8212;&#8212;&gt;&#29983;&#25104;&#22120;&#21253;&#35013;&#20989;&#25968;&#8212;&#8212;&gt;&#29983;&#25104;&#22120;&#20989;&#25968;(&#21327;&#31243;&#20989;&#25968;)&#8221;&#65307;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#65288;3&#65289;yield from iteration&#32467;&#26500;&#20250;&#22312;&#20869;&#37096;&#33258;&#21160;&#25429;&#33719; iteration&#29983;&#25104;&#22120;&#30340;StopIteration &#24322;&#24120;&#12290;&#36825;&#31181;&#22788;&#29702;&#26041;&#24335;&#19982; for &#24490;&#29615;&#22788;&#29702; StopIteration &#24322;&#24120;&#30340;&#26041;&#24335;&#19968;&#26679;&#12290;&#32780;&#19988;&#23545; yield from &#32467;&#26500;&#26469;&#35828;&#65292;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#35299;&#37322;&#22120;&#19981;&#20165;&#20250;&#25429;&#33719; StopIteration &#24322;&#24120;&#65292;&#36824;&#20250;&#25226;return&#36820;&#22238;&#30340;&#20540;&#25110;&#32773;&#26159;StopIteration&#30340;value &#23646;&#24615;&#30340;&#20540;&#21464;&#25104; yield from &#34920;&#36798;&#24335;&#30340;&#20540;&#65292;&#21363;&#19978;&#38754;&#30340;result&#12290;</span>
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-org1236638" class="outline-2">
<h2 id="org1236638"><span class="section-number-2">26</span> magic method</h2>
<div class="outline-text-2" id="text-26">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">__missing__(self, i): what to do when dict key i is missing</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">__contains__(self, i): Behaviour for in and not in operators, value in self, value not in self</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">__iter__(self): returns the iterator object itself, obj with __iter__ is iterable</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">__next__(self): either return the next item or must raise StopIteration. Notes, iterator has both __iter__ and __next__ methods</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">__index__(self): Called by x[self], &#24403;&#23545;&#35937;&#26159;&#34987;&#24212;&#29992;&#22312;&#20999;&#29255;&#34920;&#36798;&#24335;&#20013;&#26102;&#65292;&#23454;&#29616;&#25972;&#24418;&#24378;&#21046;&#36716;&#25442;, return an int</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">__setattr__(self, name, val): called by self.name = val</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">__getattribute__(self, name):  Called by self.name</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">__getattr__(self, name): called when self.name does not exist</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">__delattr__(self, name):  Called by del self.name</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">__getitem__(self,key): Called by self[key], it is important to slicing</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">__setitem__(self, key, val): Called by self[key] = val</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">__delitem__(self, key): called by del self.key</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">__concat__(self, value):      self + other    &#36830;&#25509;&#20004;&#20010;&#23545;&#35937;&#26102;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">__call__(self [,...]):        self(args)      &#8220;&#35843;&#29992;&#8221;&#23545;&#35937;&#26102;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">__enter__(self):      with self as x: with &#35821;&#21477;&#29615;&#22659;&#31649;&#29702;</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">__exit__(self, exc, val, trace):      with self as x: with &#35821;&#21477;&#29615;&#22659;&#31649;&#29702;</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">Note:</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">1. An object can be iterated over with "for" if it implements __iter__() or __getitem__().</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">2. An object can function as an iterator if it implements next().</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orge0c4822" class="outline-2">
<h2 id="orge0c4822"><span class="section-number-2">27</span> exceptional flow control</h2>
<div class="outline-text-2" id="text-27">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #4f97d7; font-weight: bold;">try</span>:
    statements
<span style="color: #4f97d7; font-weight: bold;">except</span> <span style="color: #4f97d7;">(</span>tuple_of_errors<span style="color: #4f97d7;">)</span>: <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">can have multiple</span>
    statements
<span style="color: #4f97d7; font-weight: bold;">else</span>: <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">optional no exceptions</span>
    statements
<span style="color: #4f97d7; font-weight: bold;">finally</span>: <span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">optional all circumstances</span>
    statements
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">common exceptions</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">AsserionError: Assert statement failed</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">AttributeError: Class attribute assignment or reference failed</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">IOErro: Failed I/O operation Failed module import Subscript out of range Dictionary key not found Ran out of memory</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">ImportError: Failed module import</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">IndexError: Subscript out of range</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">KeyError: Dictionary key not found</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">MemoryError: Ran out of memory</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">NameError: Name not found</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">TypeError: Value of the wrong type</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">ValueError: Right type but wrong value</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org5d2ea6e" class="outline-2">
<h2 id="org5d2ea6e"><span class="section-number-2">28</span> July 13, 2021</h2>
<div class="outline-text-2" id="text-28">
</div>
<div id="outline-container-orgbb22438" class="outline-3">
<h3 id="orgbb22438"><span class="section-number-3">28.1</span> jupyter-lab cannot find my env</h3>
</div>

<div id="outline-container-orge3ba4ab" class="outline-3">
<h3 id="orge3ba4ab"><span class="section-number-3">28.2</span> solutions</h3>
<div class="outline-text-3" id="text-28-2">
<ul class="org-ul">
<li>Assuming your conda-env is named cenv, it is as simple as :</li>
<li>conda activate cenv</li>
<li>(cenv)$ conda install ipykernel</li>
<li>(cenv)$ ipython kernel install &#x2013;user &#x2013;name=&lt;any<sub>name</sub><sub>for</sub><sub>kernel</sub>&gt;</li>
<li>(cenv($ conda deactivate</li>
<li>If you restart your jupyter notebook/lab you will be able to see the new kernel available.</li>
<li>PS: If you are using virtualenv etc. the above steps hold good.</li>
</ul>

<p>
links: <a href="https://jupyter.org/install">https://jupyter.org/install</a>
</p>
</div>
</div>


<div id="outline-container-org85f4228" class="outline-3">
<h3 id="org85f4228"><span class="section-number-3">28.3</span> Machine learning course links</h3>
<div class="outline-text-3" id="text-28-3">
</div>
<div id="outline-container-orgb09009d" class="outline-4">
<h4 id="orgb09009d"><span class="section-number-4">28.3.1</span> <span class="todo TODO">TODO</span> <a href="https://speech.ee.ntu.edu.tw/~hylee/mlds/2018-spring.html">https://speech.ee.ntu.edu.tw/~hylee/mlds/2018-spring.html</a></h4>
</div>
<div id="outline-container-orgcb09fef" class="outline-4">
<h4 id="orgcb09fef"><span class="section-number-4">28.3.2</span> <span class="todo TODO">TODO</span> statistics review: <a href="https://zhuanlan.zhihu.com/p/70034585">https://zhuanlan.zhihu.com/p/70034585</a></h4>
</div>
<div id="outline-container-org15ef9b6" class="outline-4">
<h4 id="org15ef9b6"><span class="section-number-4">28.3.3</span> python tutorials</h4>
<div class="outline-text-4" id="text-28-3-3">
</div>
<ol class="org-ol">
<li><a id="orge3df0a3"></a><span class="todo TODO">TODO</span> <a href="https://blog.csdn.net/liuchunming033/category_1348374.html">https://blog.csdn.net/liuchunming033/category_1348374.html</a><br /></li>
<li><a id="org419798f"></a><span class="todo TODO">TODO</span> vis training and loss: <a href="https://machinelearningmastery.com/learning-curves-for-diagnosing-machine-learning-model-performance/">https://machinelearningmastery.com/learning-curves-for-diagnosing-machine-learning-model-performance/</a>, <a href="https://blog.csdn.net/bbbeoy/article/details/113503988">https://blog.csdn.net/bbbeoy/article/details/113503988</a>, <a href="https://oldpan.me/archives/how-to-use-tricks-to-train-network">https://oldpan.me/archives/how-to-use-tricks-to-train-network</a><br /></li>
</ol>
</div>
<div id="outline-container-org1017584" class="outline-4">
<h4 id="org1017584"><span class="section-number-4">28.3.4</span> pytorch tutorials:</h4>
<div class="outline-text-4" id="text-28-3-4">
</div>
<ol class="org-ol">
<li><a id="orgd40b88d"></a><a href="https://blog.csdn.net/u012436149/category_9268433.html?spm=1001.2014.3001.5482">https://blog.csdn.net/u012436149/category_9268433.html?spm=1001.2014.3001.5482</a><br /></li>
<li><a id="org20dbab5"></a><a href="https://blog.csdn.net/qq_27825451/article/details/96837905">https://blog.csdn.net/qq_27825451/article/details/96837905</a><br /></li>
<li><a id="orgb8c5a39"></a><a href="https://pytorch.org/tutorials/beginner/basics/quickstart_tutorial.html">https://pytorch.org/tutorials/beginner/basics/quickstart_tutorial.html</a><br /></li>
</ol>
</div>
<div id="outline-container-org44063a1" class="outline-4">
<h4 id="org44063a1"><span class="section-number-4">28.3.5</span> Design patterns tutorials:</h4>
<div class="outline-text-4" id="text-28-3-5">
</div>
<ol class="org-ol">
<li><a id="orgf17eb2e"></a><a href="https://python-web-guide.readthedocs.io/zh/latest/design/design.html#the-fctory-pattern">https://python-web-guide.readthedocs.io/zh/latest/design/design.html#the-fctory-pattern</a><br /></li>
<li><a id="orga4697f2"></a><a href="https://refactoringguru.cn/design-patterns/abstract-factory">https://refactoringguru.cn/design-patterns/abstract-factory</a><br /></li>
</ol>
</div>
<div id="outline-container-orgd968dc8" class="outline-4">
<h4 id="orgd968dc8"><span class="section-number-4">28.3.6</span> tensorflow tutorials</h4>
<div class="outline-text-4" id="text-28-3-6">
</div>
<ol class="org-ol">
<li><a id="org7cd7ab7"></a><a href="https://blog.csdn.net/u012436149/category_9267152_2.html">https://blog.csdn.net/u012436149/category_9267152_2.html</a><br /></li>
</ol>
</div>
<div id="outline-container-org959f6ce" class="outline-4">
<h4 id="org959f6ce"><span class="section-number-4">28.3.7</span> XAI vis</h4>
<div class="outline-text-4" id="text-28-3-7">
</div>
<ol class="org-ol">
<li><a id="org1c12682"></a><a href="https://github.com/interpretml/interpret">https://github.com/interpretml/interpret</a><br /></li>
</ol>
</div>
</div>
</div>
<div id="outline-container-org14cfac4" class="outline-2">
<h2 id="org14cfac4"><span class="section-number-2">29</span> python attribute lookup order</h2>
<div class="outline-text-2" id="text-29">
</div>
<div id="outline-container-org8c2c0db" class="outline-3">
<h3 id="org8c2c0db"><span class="section-number-3">29.1</span> <a href="https://blog.ionelmc.ro/2015/02/09/understanding-python-metaclasses/#object-attribute-lookup">https://blog.ionelmc.ro/2015/02/09/understanding-python-metaclasses/#object-attribute-lookup</a></h3>
</div>
<div id="outline-container-orga91aae0" class="outline-3">
<h3 id="orga91aae0"><span class="section-number-3">29.2</span> </h3>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: zhou yang</p>
<p class="date">Created: 2022-02-01 Tue 10:50</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
